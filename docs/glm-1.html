<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 GLM 1 | Detecting Hexadirectional Signals in the Human Brain using R and FSL</title>
  <meta name="description" content="3 GLM 1 | Detecting Hexadirectional Signals in the Human Brain using R and FSL" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="3 GLM 1 | Detecting Hexadirectional Signals in the Human Brain using R and FSL" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 GLM 1 | Detecting Hexadirectional Signals in the Human Brain using R and FSL" />
  
  
  

<meta name="author" content="Dr.Â Jacob L. S. Bellmund" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="example-data.html"/>
<link rel="next" href="estimate-orientation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#requirements"><i class="fa fa-check"></i><b>1.1</b> Requirements</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#workflow"><i class="fa fa-check"></i><b>1.2</b> Workflow</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#cbs-imac-or-macbook"><i class="fa fa-check"></i><b>1.2.1</b> CBS iMac or Macbook</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#remote-linux"><i class="fa fa-check"></i><b>1.2.2</b> Remote Linux</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#running-the-analysis"><i class="fa fa-check"></i><b>1.2.3</b> Running the analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#required-packages"><i class="fa fa-check"></i><b>1.3</b> Required packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-data.html"><a href="example-data.html"><i class="fa fa-check"></i><b>2</b> Example Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="example-data.html"><a href="example-data.html#download-example-data"><i class="fa fa-check"></i><b>2.1</b> Download Example Data</a></li>
<li class="chapter" data-level="2.2" data-path="example-data.html"><a href="example-data.html#rearrange-data"><i class="fa fa-check"></i><b>2.2</b> Rearrange data</a></li>
<li class="chapter" data-level="2.3" data-path="example-data.html"><a href="example-data.html#event-tables"><i class="fa fa-check"></i><b>2.3</b> Event Tables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="example-data.html"><a href="example-data.html#trajectory-duration"><i class="fa fa-check"></i><b>2.3.1</b> Trajectory duration</a></li>
<li class="chapter" data-level="2.3.2" data-path="example-data.html"><a href="example-data.html#angular-sampling"><i class="fa fa-check"></i><b>2.3.2</b> Angular Sampling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="example-data.html"><a href="example-data.html#fmri"><i class="fa fa-check"></i><b>2.4</b> fMRI</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="example-data.html"><a href="example-data.html#merge-images-of-each-run"><i class="fa fa-check"></i><b>2.4.1</b> Merge images of each run</a></li>
<li class="chapter" data-level="2.4.2" data-path="example-data.html"><a href="example-data.html#calculate-tsnr"><i class="fa fa-check"></i><b>2.4.2</b> Calculate tSNR</a></li>
<li class="chapter" data-level="2.4.3" data-path="example-data.html"><a href="example-data.html#create-quick-brain-mask"><i class="fa fa-check"></i><b>2.4.3</b> Create quick brain mask</a></li>
<li class="chapter" data-level="2.4.4" data-path="example-data.html"><a href="example-data.html#mask-4d-functionals"><i class="fa fa-check"></i><b>2.4.4</b> Mask 4D functionals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="glm-1.html"><a href="glm-1.html"><i class="fa fa-check"></i><b>3</b> GLM 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="glm-1.html"><a href="glm-1.html#ev-files-for-feat"><i class="fa fa-check"></i><b>3.1</b> EV files for FEAT</a></li>
<li class="chapter" data-level="3.2" data-path="glm-1.html"><a href="glm-1.html#set-up-the-glm-using-fsl-feat"><i class="fa fa-check"></i><b>3.2</b> Set up the GLM using FSL FEAT</a></li>
<li class="chapter" data-level="3.3" data-path="glm-1.html"><a href="glm-1.html#run-glm1"><i class="fa fa-check"></i><b>3.3</b> Run GLM1</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="glm-1.html"><a href="glm-1.html#feat"><i class="fa fa-check"></i><b>3.3.1</b> FEAT</a></li>
<li class="chapter" data-level="3.3.2" data-path="glm-1.html"><a href="glm-1.html#film_gls"><i class="fa fa-check"></i><b>3.3.2</b> FILM_GLS</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="glm-1.html"><a href="glm-1.html#results-glm-1"><i class="fa fa-check"></i><b>3.4</b> Results GLM 1</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="glm-1.html"><a href="glm-1.html#compare-results-from-feat-and-film"><i class="fa fa-check"></i><b>3.4.1</b> Compare results from FEAT and FILM</a></li>
<li class="chapter" data-level="3.4.2" data-path="glm-1.html"><a href="glm-1.html#f-test-results"><i class="fa fa-check"></i><b>3.4.2</b> F-Test results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estimate-orientation.html"><a href="estimate-orientation.html"><i class="fa fa-check"></i><b>4</b> Estimate orientation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="estimate-orientation.html"><a href="estimate-orientation.html#load-pes-of-parametric-modulators"><i class="fa fa-check"></i><b>4.1</b> Load PEs of parametric modulators</a></li>
<li class="chapter" data-level="4.2" data-path="estimate-orientation.html"><a href="estimate-orientation.html#compute-voxelwise-orientation"><i class="fa fa-check"></i><b>4.2</b> Compute Voxelwise Orientation</a></li>
<li class="chapter" data-level="4.3" data-path="estimate-orientation.html"><a href="estimate-orientation.html#average-grid-orientations"><i class="fa fa-check"></i><b>4.3</b> Average grid orientations</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="estimate-orientation.html"><a href="estimate-orientation.html#wholebrain-average-orientation"><i class="fa fa-check"></i><b>4.3.1</b> Wholebrain average orientation</a></li>
<li class="chapter" data-level="4.3.2" data-path="estimate-orientation.html"><a href="estimate-orientation.html#entorhinal-cortex-average-orientation"><i class="fa fa-check"></i><b>4.3.2</b> Entorhinal Cortex average orientation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="estimate-orientation.html"><a href="estimate-orientation.html#brain-plot-of-estimated-orientations"><i class="fa fa-check"></i><b>4.4</b> Brain plot of estimated orientations</a></li>
<li class="chapter" data-level="4.5" data-path="estimate-orientation.html"><a href="estimate-orientation.html#store-estimated-grid-orientation"><i class="fa fa-check"></i><b>4.5</b> Store estimated grid orientation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="glm-2.html"><a href="glm-2.html"><i class="fa fa-check"></i><b>5</b> GLM 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="glm-2.html"><a href="glm-2.html#parametric-modulation-with-cosine-regressor"><i class="fa fa-check"></i><b>5.1</b> Parametric modulation with cosine regressor</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="glm-2.html"><a href="glm-2.html#ev-files-for-feat-1"><i class="fa fa-check"></i><b>5.1.1</b> EV files for FEAT</a></li>
<li class="chapter" data-level="5.1.2" data-path="glm-2.html"><a href="glm-2.html#set-up-the-glm-using-fsl-feat-1"><i class="fa fa-check"></i><b>5.1.2</b> Set up the GLM using FSL FEAT</a></li>
<li class="chapter" data-level="5.1.3" data-path="glm-2.html"><a href="glm-2.html#run-glm2"><i class="fa fa-check"></i><b>5.1.3</b> Run GLM2</a></li>
<li class="chapter" data-level="5.1.4" data-path="glm-2.html"><a href="glm-2.html#glm-2-results"><i class="fa fa-check"></i><b>5.1.4</b> GLM 2 results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="credit.html"><a href="credit.html"><i class="fa fa-check"></i><b>6</b> Credit</a>
<ul>
<li class="chapter" data-level="6.1" data-path="credit.html"><a href="credit.html#gridcat"><i class="fa fa-check"></i><b>6.1</b> GridCAT</a></li>
<li class="chapter" data-level="6.2" data-path="credit.html"><a href="credit.html#publishing-on-github-pages"><i class="fa fa-check"></i><b>6.2</b> Publishing on GitHub Pages</a></li>
<li class="chapter" data-level="6.3" data-path="credit.html"><a href="credit.html#list-of-r-packages"><i class="fa fa-check"></i><b>6.3</b> List of R packages</a></li>
<li class="chapter" data-level="6.4" data-path="credit.html"><a href="credit.html#session-info"><i class="fa fa-check"></i><b>6.4</b> Session Info</a></li>
<li class="chapter" data-level="6.5" data-path="credit.html"><a href="credit.html#bibliography"><i class="fa fa-check"></i><b>6.5</b> Bibliography</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Detecting Hexadirectional Signals in the Human Brain using R and FSL</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="glm-1" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> GLM 1<a href="glm-1.html#glm-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For the estimation set, a GLM (letâs call it GLM1) is implemented that includes two parametric modulators (see figure below): the sine and the cosine of the movement direction through space (<span class="math inline">\(sin(6\theta(t)\)</span> and <span class="math inline">\(cos(6\theta(t)\)</span>, where <span class="math inline">\(\theta(t)\)</span> is the direction of trajectory t), e.g.Â the virtual environment. The angles are multiplied by six because we are interested in six-fold symmetric signals. This value needs to be varied for control symmetries.</p>
<p>From <a href="https://www.science.org/doi/10.1126/science.aac8128">Kunz et al.Â (Science, 2015)</a>:</p>
<blockquote>
<p>âMultiplying by six transforms the movement directions into 60Â° space to account for the six-fold rotational symmetry of potential grid-cell-like representations. In other words, the factor 6 means that these regressors are sensitive to activation showing a six-fold rotational symmetry in running direction (i.e., activation with six evenly spaced peaks as a function of running direction will produce parameter estimates <span class="math inline">\(\beta1\)</span> and <span class="math inline">\(\beta2\)</span> for the two regressors with large amplitude <span class="math inline">\(\sqrt{\beta1Â² + \beta2Â²)}\)</span>.â</p>
</blockquote>
<p>Note that <span class="math inline">\(\beta1\)</span> and <span class="math inline">\(\beta2\)</span> correspond to the parameter estimates for the cosine and sine regressor, respectively.</p>
<div class="figure">
<img src="static/hexadirectional_analysis_logic_glm1.png" alt="" />
<p class="caption">Illustration of parametric modulators included in GLM1</p>
</div>
<p>In keeping with the GridCAT manual, letâs split each run in a first and a second half based on the number of navigation periods.</p>
<div id="ev-files-for-feat" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> EV files for FEAT<a href="glm-1.html#ev-files-for-feat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For each regressor, FSL FEAT expects an EV (EV = explanatory variable, i.e.Â regressor) file with 3-column format for each regressor. Letâs load the modified event file and write out the regressors we will want to use. These are:</p>
<ul>
<li>navigation EV for all timepoints of translational movement in the entire run</li>
<li>sine for movement direction for navigation EV to be used as parametric modulator for first half of onsets of navigation EV</li>
<li>cosine for movement direction for navigation EV to be used as parametric modulator for first half of onsets of navigation EV</li>
<li>feedback EV modeling time points when participants received feedback (entire run)</li>
</ul>
<p>To look at an n-fold periodic signal, the trajectory angle is multiplied by the desired periodicity (e.g.Â 6 for hexadirectional analysis) before calculating the (co)sine. Thus, there is a pair of parametric modulators for each periodicity you want to check.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="glm-1.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we want to look for six-fold signals, other periodicities are controls</span></span>
<span id="cb49-2"><a href="glm-1.html#cb49-2" aria-hidden="true" tabindex="-1"></a>periodicities <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>)</span>
<span id="cb49-3"><a href="glm-1.html#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="glm-1.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb49-5"><a href="glm-1.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){</span>
<span id="cb49-6"><a href="glm-1.html#cb49-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb49-7"><a href="glm-1.html#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create directory for EV files</span></span>
<span id="cb49-8"><a href="glm-1.html#cb49-8" aria-hidden="true" tabindex="-1"></a>    ev_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_ev&quot;</span>, i_sub, i_run)</span>
<span id="cb49-9"><a href="glm-1.html#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(ev_dir)){<span class="fu">dir.create</span>(ev_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb49-10"><a href="glm-1.html#cb49-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-11"><a href="glm-1.html#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># read the event table file</span></span>
<span id="cb49-12"><a href="glm-1.html#cb49-12" aria-hidden="true" tabindex="-1"></a>    fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;EventTables&quot;</span>, i_sub, <span class="fu">paste0</span>(<span class="st">&quot;eventTable_&quot;</span>, i_run, <span class="st">&quot;_jb.txt&quot;</span>))</span>
<span id="cb49-13"><a href="glm-1.html#cb49-13" aria-hidden="true" tabindex="-1"></a>    event_table <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;fddd&quot;</span>))</span>
<span id="cb49-14"><a href="glm-1.html#cb49-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-15"><a href="glm-1.html#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># write the navigation (translation) regressor to file in 3-column format for FSL</span></span>
<span id="cb49-16"><a href="glm-1.html#cb49-16" aria-hidden="true" tabindex="-1"></a>    fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ev_dir, <span class="st">&quot;translation.txt&quot;</span>)</span>
<span id="cb49-17"><a href="glm-1.html#cb49-17" aria-hidden="true" tabindex="-1"></a>    event_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">&quot;translation&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-18"><a href="glm-1.html#cb49-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">c</span>(onset, duration)) <span class="sc">%&gt;%</span></span>
<span id="cb49-19"><a href="glm-1.html#cb49-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">weight=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-20"><a href="glm-1.html#cb49-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">write_delim</span>(<span class="at">file =</span> fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-21"><a href="glm-1.html#cb49-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-22"><a href="glm-1.html#cb49-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># write the feedback regressor to file in 3-column format for FSL</span></span>
<span id="cb49-23"><a href="glm-1.html#cb49-23" aria-hidden="true" tabindex="-1"></a>    fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ev_dir, <span class="st">&quot;feedback.txt&quot;</span>)</span>
<span id="cb49-24"><a href="glm-1.html#cb49-24" aria-hidden="true" tabindex="-1"></a>    event_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">&quot;feedback&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-25"><a href="glm-1.html#cb49-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">c</span>(onset, duration)) <span class="sc">%&gt;%</span></span>
<span id="cb49-26"><a href="glm-1.html#cb49-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">weight=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-27"><a href="glm-1.html#cb49-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">write_delim</span>(<span class="at">file =</span> fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-28"><a href="glm-1.html#cb49-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-29"><a href="glm-1.html#cb49-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb49-30"><a href="glm-1.html#cb49-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-31"><a href="glm-1.html#cb49-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add sine and cosine of running angle</span></span>
<span id="cb49-32"><a href="glm-1.html#cb49-32" aria-hidden="true" tabindex="-1"></a>      event_table <span class="ot">&lt;-</span> event_table <span class="sc">%&gt;%</span></span>
<span id="cb49-33"><a href="glm-1.html#cb49-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CAVE: transform angles to radians before calculating (co)sine!</span></span>
<span id="cb49-34"><a href="glm-1.html#cb49-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">sine =</span> <span class="fu">sin</span>((i_period <span class="sc">*</span> angle)<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>), </span>
<span id="cb49-35"><a href="glm-1.html#cb49-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">cosine =</span> <span class="fu">cos</span>((i_period <span class="sc">*</span> angle)<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>))</span>
<span id="cb49-36"><a href="glm-1.html#cb49-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">head</span>(event_table, <span class="at">n=</span><span class="dv">10</span>)</span>
<span id="cb49-37"><a href="glm-1.html#cb49-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-38"><a href="glm-1.html#cb49-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># write the sine of translation angle regressor to file in 3-column format for FSL for first half of trials</span></span>
<span id="cb49-39"><a href="glm-1.html#cb49-39" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ev_dir, <span class="fu">paste0</span>(<span class="st">&quot;translation_sine_&quot;</span>, i_period, <span class="st">&quot;fold_half1.txt&quot;</span>))</span>
<span id="cb49-40"><a href="glm-1.html#cb49-40" aria-hidden="true" tabindex="-1"></a>      event_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">&quot;translation&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-41"><a href="glm-1.html#cb49-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">slice_head</span>(<span class="at">n=</span><span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co"># first half</span></span>
<span id="cb49-42"><a href="glm-1.html#cb49-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">c</span>(onset, duration, sine)) <span class="sc">%&gt;%</span></span>
<span id="cb49-43"><a href="glm-1.html#cb49-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_delim</span>(<span class="at">file =</span> fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-44"><a href="glm-1.html#cb49-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb49-45"><a href="glm-1.html#cb49-45" aria-hidden="true" tabindex="-1"></a>      <span class="co"># write the cosine of translation angle regressor to file in 3-column format for FSL for first half of trials</span></span>
<span id="cb49-46"><a href="glm-1.html#cb49-46" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ev_dir, <span class="fu">paste0</span>(<span class="st">&quot;translation_cosine_&quot;</span>, i_period, <span class="st">&quot;fold_half1.txt&quot;</span>))</span>
<span id="cb49-47"><a href="glm-1.html#cb49-47" aria-hidden="true" tabindex="-1"></a>      event_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">&quot;translation&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-48"><a href="glm-1.html#cb49-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">slice_head</span>(<span class="at">n=</span><span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="co"># first half</span></span>
<span id="cb49-49"><a href="glm-1.html#cb49-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">c</span>(onset, duration, cosine)) <span class="sc">%&gt;%</span></span>
<span id="cb49-50"><a href="glm-1.html#cb49-50" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_delim</span>(<span class="at">file =</span> fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-51"><a href="glm-1.html#cb49-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-52"><a href="glm-1.html#cb49-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-53"><a href="glm-1.html#cb49-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="set-up-the-glm-using-fsl-feat" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Set up the GLM using FSL FEAT<a href="glm-1.html#set-up-the-glm-using-fsl-feat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The text below is based on clicking through the FEAT GUI for one run and copying the content of the resulting fsf-file to the chunk below. In this text, we replace lines/variables that need to be altered for each subject with a placeholder. These can then easily be filled in for each run of each subject. The chunk below could be shortened by removing the lines that are irrelevant for GLM 1, e.g.Â preprocessing, which is not carried out here.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="glm-1.html#cb50-1" aria-hidden="true" tabindex="-1"></a>dsgn <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb50-2"><a href="glm-1.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="st"># FEAT version number</span></span>
<span id="cb50-3"><a href="glm-1.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(version) 6.00</span></span>
<span id="cb50-4"><a href="glm-1.html#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="glm-1.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="st"># Are we in MELODIC?</span></span>
<span id="cb50-6"><a href="glm-1.html#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(inmelodic) 0</span></span>
<span id="cb50-7"><a href="glm-1.html#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="glm-1.html#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="st"># Analysis level</span></span>
<span id="cb50-9"><a href="glm-1.html#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : First-level analysis</span></span>
<span id="cb50-10"><a href="glm-1.html#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Higher-level analysis</span></span>
<span id="cb50-11"><a href="glm-1.html#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(level) 1</span></span>
<span id="cb50-12"><a href="glm-1.html#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="glm-1.html#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="st"># Which stages to run</span></span>
<span id="cb50-14"><a href="glm-1.html#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : No first-level analysis (registration and/or group stats only)</span></span>
<span id="cb50-15"><a href="glm-1.html#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="st"># 7 : Full first-level analysis</span></span>
<span id="cb50-16"><a href="glm-1.html#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Pre-processing</span></span>
<span id="cb50-17"><a href="glm-1.html#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Statistics</span></span>
<span id="cb50-18"><a href="glm-1.html#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(analysis) 2</span></span>
<span id="cb50-19"><a href="glm-1.html#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="glm-1.html#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="st"># Use relative filenames</span></span>
<span id="cb50-21"><a href="glm-1.html#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(relative_yn) 0</span></span>
<span id="cb50-22"><a href="glm-1.html#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="glm-1.html#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="st"># Balloon help</span></span>
<span id="cb50-24"><a href="glm-1.html#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(help_yn) 1</span></span>
<span id="cb50-25"><a href="glm-1.html#cb50-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-26"><a href="glm-1.html#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="st"># Run Featwatcher</span></span>
<span id="cb50-27"><a href="glm-1.html#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(featwatcher_yn) 1</span></span>
<span id="cb50-28"><a href="glm-1.html#cb50-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-29"><a href="glm-1.html#cb50-29" aria-hidden="true" tabindex="-1"></a><span class="st"># Cleanup first-level standard-space images</span></span>
<span id="cb50-30"><a href="glm-1.html#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(sscleanup_yn) 0</span></span>
<span id="cb50-31"><a href="glm-1.html#cb50-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-32"><a href="glm-1.html#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="st"># Output directory</span></span>
<span id="cb50-33"><a href="glm-1.html#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(outputdir) &quot;@out_dir@&quot;</span></span>
<span id="cb50-34"><a href="glm-1.html#cb50-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-35"><a href="glm-1.html#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="st"># TR(s)</span></span>
<span id="cb50-36"><a href="glm-1.html#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tr) @tr@ </span></span>
<span id="cb50-37"><a href="glm-1.html#cb50-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-38"><a href="glm-1.html#cb50-38" aria-hidden="true" tabindex="-1"></a><span class="st"># Total volumes</span></span>
<span id="cb50-39"><a href="glm-1.html#cb50-39" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(npts) @n_vols@</span></span>
<span id="cb50-40"><a href="glm-1.html#cb50-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-41"><a href="glm-1.html#cb50-41" aria-hidden="true" tabindex="-1"></a><span class="st"># Delete volumes</span></span>
<span id="cb50-42"><a href="glm-1.html#cb50-42" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ndelete) 0</span></span>
<span id="cb50-43"><a href="glm-1.html#cb50-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-44"><a href="glm-1.html#cb50-44" aria-hidden="true" tabindex="-1"></a><span class="st"># Perfusion tag/control order</span></span>
<span id="cb50-45"><a href="glm-1.html#cb50-45" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tagfirst) 1</span></span>
<span id="cb50-46"><a href="glm-1.html#cb50-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-47"><a href="glm-1.html#cb50-47" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of first-level analyses</span></span>
<span id="cb50-48"><a href="glm-1.html#cb50-48" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(multiple) 1</span></span>
<span id="cb50-49"><a href="glm-1.html#cb50-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-50"><a href="glm-1.html#cb50-50" aria-hidden="true" tabindex="-1"></a><span class="st"># Higher-level input type</span></span>
<span id="cb50-51"><a href="glm-1.html#cb50-51" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Inputs are lower-level FEAT directories</span></span>
<span id="cb50-52"><a href="glm-1.html#cb50-52" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Inputs are cope images from FEAT directories</span></span>
<span id="cb50-53"><a href="glm-1.html#cb50-53" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(inputtype) 2</span></span>
<span id="cb50-54"><a href="glm-1.html#cb50-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-55"><a href="glm-1.html#cb50-55" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out pre-stats processing?</span></span>
<span id="cb50-56"><a href="glm-1.html#cb50-56" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(filtering_yn) 0</span></span>
<span id="cb50-57"><a href="glm-1.html#cb50-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-58"><a href="glm-1.html#cb50-58" aria-hidden="true" tabindex="-1"></a><span class="st"># Brain/background threshold, %</span></span>
<span id="cb50-59"><a href="glm-1.html#cb50-59" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(brain_thresh) 10</span></span>
<span id="cb50-60"><a href="glm-1.html#cb50-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-61"><a href="glm-1.html#cb50-61" aria-hidden="true" tabindex="-1"></a><span class="st"># Critical z for design efficiency calculation</span></span>
<span id="cb50-62"><a href="glm-1.html#cb50-62" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(critical_z) 5.3</span></span>
<span id="cb50-63"><a href="glm-1.html#cb50-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-64"><a href="glm-1.html#cb50-64" aria-hidden="true" tabindex="-1"></a><span class="st"># Noise level</span></span>
<span id="cb50-65"><a href="glm-1.html#cb50-65" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(noise) 0.66</span></span>
<span id="cb50-66"><a href="glm-1.html#cb50-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-67"><a href="glm-1.html#cb50-67" aria-hidden="true" tabindex="-1"></a><span class="st"># Noise AR(1)</span></span>
<span id="cb50-68"><a href="glm-1.html#cb50-68" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(noisear) 0.34</span></span>
<span id="cb50-69"><a href="glm-1.html#cb50-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-70"><a href="glm-1.html#cb50-70" aria-hidden="true" tabindex="-1"></a><span class="st"># Motion correction</span></span>
<span id="cb50-71"><a href="glm-1.html#cb50-71" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb50-72"><a href="glm-1.html#cb50-72" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : MCFLIRT</span></span>
<span id="cb50-73"><a href="glm-1.html#cb50-73" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(mc) 1</span></span>
<span id="cb50-74"><a href="glm-1.html#cb50-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-75"><a href="glm-1.html#cb50-75" aria-hidden="true" tabindex="-1"></a><span class="st"># Spin-history (currently obsolete)</span></span>
<span id="cb50-76"><a href="glm-1.html#cb50-76" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(sh_yn) 0</span></span>
<span id="cb50-77"><a href="glm-1.html#cb50-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-78"><a href="glm-1.html#cb50-78" aria-hidden="true" tabindex="-1"></a><span class="st"># B0 fieldmap unwarping?</span></span>
<span id="cb50-79"><a href="glm-1.html#cb50-79" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regunwarp_yn) 0</span></span>
<span id="cb50-80"><a href="glm-1.html#cb50-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-81"><a href="glm-1.html#cb50-81" aria-hidden="true" tabindex="-1"></a><span class="st"># GDC Test</span></span>
<span id="cb50-82"><a href="glm-1.html#cb50-82" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gdc) &quot;&quot;</span></span>
<span id="cb50-83"><a href="glm-1.html#cb50-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-84"><a href="glm-1.html#cb50-84" aria-hidden="true" tabindex="-1"></a><span class="st"># EPI dwell time (ms)</span></span>
<span id="cb50-85"><a href="glm-1.html#cb50-85" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(dwell) 0.7</span></span>
<span id="cb50-86"><a href="glm-1.html#cb50-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-87"><a href="glm-1.html#cb50-87" aria-hidden="true" tabindex="-1"></a><span class="st"># EPI TE (ms)</span></span>
<span id="cb50-88"><a href="glm-1.html#cb50-88" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(te) 35</span></span>
<span id="cb50-89"><a href="glm-1.html#cb50-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-90"><a href="glm-1.html#cb50-90" aria-hidden="true" tabindex="-1"></a><span class="st"># % Signal loss threshold</span></span>
<span id="cb50-91"><a href="glm-1.html#cb50-91" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(signallossthresh) 10</span></span>
<span id="cb50-92"><a href="glm-1.html#cb50-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-93"><a href="glm-1.html#cb50-93" aria-hidden="true" tabindex="-1"></a><span class="st"># Unwarp direction</span></span>
<span id="cb50-94"><a href="glm-1.html#cb50-94" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(unwarp_dir) y-</span></span>
<span id="cb50-95"><a href="glm-1.html#cb50-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-96"><a href="glm-1.html#cb50-96" aria-hidden="true" tabindex="-1"></a><span class="st"># Slice timing correction</span></span>
<span id="cb50-97"><a href="glm-1.html#cb50-97" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb50-98"><a href="glm-1.html#cb50-98" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Regular up (0, 1, 2, 3, ...)</span></span>
<span id="cb50-99"><a href="glm-1.html#cb50-99" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Regular down</span></span>
<span id="cb50-100"><a href="glm-1.html#cb50-100" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Use slice order file</span></span>
<span id="cb50-101"><a href="glm-1.html#cb50-101" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Use slice timings file</span></span>
<span id="cb50-102"><a href="glm-1.html#cb50-102" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Interleaved (0, 2, 4 ... 1, 3, 5 ... )</span></span>
<span id="cb50-103"><a href="glm-1.html#cb50-103" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(st) 0</span></span>
<span id="cb50-104"><a href="glm-1.html#cb50-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-105"><a href="glm-1.html#cb50-105" aria-hidden="true" tabindex="-1"></a><span class="st"># Slice timings file</span></span>
<span id="cb50-106"><a href="glm-1.html#cb50-106" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(st_file) &quot;&quot;</span></span>
<span id="cb50-107"><a href="glm-1.html#cb50-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-108"><a href="glm-1.html#cb50-108" aria-hidden="true" tabindex="-1"></a><span class="st"># BET brain extraction</span></span>
<span id="cb50-109"><a href="glm-1.html#cb50-109" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(bet_yn) 1</span></span>
<span id="cb50-110"><a href="glm-1.html#cb50-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-111"><a href="glm-1.html#cb50-111" aria-hidden="true" tabindex="-1"></a><span class="st"># Spatial smoothing FWHM (mm)</span></span>
<span id="cb50-112"><a href="glm-1.html#cb50-112" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(smooth) 5</span></span>
<span id="cb50-113"><a href="glm-1.html#cb50-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-114"><a href="glm-1.html#cb50-114" aria-hidden="true" tabindex="-1"></a><span class="st"># Intensity normalization</span></span>
<span id="cb50-115"><a href="glm-1.html#cb50-115" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(norm_yn) 0</span></span>
<span id="cb50-116"><a href="glm-1.html#cb50-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-117"><a href="glm-1.html#cb50-117" aria-hidden="true" tabindex="-1"></a><span class="st"># Perfusion subtraction</span></span>
<span id="cb50-118"><a href="glm-1.html#cb50-118" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(perfsub_yn) 0</span></span>
<span id="cb50-119"><a href="glm-1.html#cb50-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-120"><a href="glm-1.html#cb50-120" aria-hidden="true" tabindex="-1"></a><span class="st"># Highpass temporal filtering</span></span>
<span id="cb50-121"><a href="glm-1.html#cb50-121" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(temphp_yn) 1</span></span>
<span id="cb50-122"><a href="glm-1.html#cb50-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-123"><a href="glm-1.html#cb50-123" aria-hidden="true" tabindex="-1"></a><span class="st"># Lowpass temporal filtering</span></span>
<span id="cb50-124"><a href="glm-1.html#cb50-124" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(templp_yn) 0</span></span>
<span id="cb50-125"><a href="glm-1.html#cb50-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-126"><a href="glm-1.html#cb50-126" aria-hidden="true" tabindex="-1"></a><span class="st"># MELODIC ICA data exploration</span></span>
<span id="cb50-127"><a href="glm-1.html#cb50-127" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(melodic_yn) 0</span></span>
<span id="cb50-128"><a href="glm-1.html#cb50-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-129"><a href="glm-1.html#cb50-129" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out main stats?</span></span>
<span id="cb50-130"><a href="glm-1.html#cb50-130" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(stats_yn) 1</span></span>
<span id="cb50-131"><a href="glm-1.html#cb50-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-132"><a href="glm-1.html#cb50-132" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out prewhitening?</span></span>
<span id="cb50-133"><a href="glm-1.html#cb50-133" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(prewhiten_yn) 1</span></span>
<span id="cb50-134"><a href="glm-1.html#cb50-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-135"><a href="glm-1.html#cb50-135" aria-hidden="true" tabindex="-1"></a><span class="st"># Add motion parameters to model</span></span>
<span id="cb50-136"><a href="glm-1.html#cb50-136" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : No</span></span>
<span id="cb50-137"><a href="glm-1.html#cb50-137" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Yes</span></span>
<span id="cb50-138"><a href="glm-1.html#cb50-138" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(motionevs) 0</span></span>
<span id="cb50-139"><a href="glm-1.html#cb50-139" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(motionevsbeta) &quot;&quot;</span></span>
<span id="cb50-140"><a href="glm-1.html#cb50-140" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(scriptevsbeta) &quot;&quot;</span></span>
<span id="cb50-141"><a href="glm-1.html#cb50-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-142"><a href="glm-1.html#cb50-142" aria-hidden="true" tabindex="-1"></a><span class="st"># Robust outlier detection in FLAME?</span></span>
<span id="cb50-143"><a href="glm-1.html#cb50-143" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(robust_yn) 0</span></span>
<span id="cb50-144"><a href="glm-1.html#cb50-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-145"><a href="glm-1.html#cb50-145" aria-hidden="true" tabindex="-1"></a><span class="st"># Higher-level modelling</span></span>
<span id="cb50-146"><a href="glm-1.html#cb50-146" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Fixed effects</span></span>
<span id="cb50-147"><a href="glm-1.html#cb50-147" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Mixed Effects: Simple OLS</span></span>
<span id="cb50-148"><a href="glm-1.html#cb50-148" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Mixed Effects: FLAME 1</span></span>
<span id="cb50-149"><a href="glm-1.html#cb50-149" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Mixed Effects: FLAME 1+2</span></span>
<span id="cb50-150"><a href="glm-1.html#cb50-150" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(mixed_yn) 2</span></span>
<span id="cb50-151"><a href="glm-1.html#cb50-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-152"><a href="glm-1.html#cb50-152" aria-hidden="true" tabindex="-1"></a><span class="st"># Higher-level permutations</span></span>
<span id="cb50-153"><a href="glm-1.html#cb50-153" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(randomisePermutations) 5000</span></span>
<span id="cb50-154"><a href="glm-1.html#cb50-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-155"><a href="glm-1.html#cb50-155" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of EVs</span></span>
<span id="cb50-156"><a href="glm-1.html#cb50-156" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evs_orig) 4</span></span>
<span id="cb50-157"><a href="glm-1.html#cb50-157" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evs_real) 8</span></span>
<span id="cb50-158"><a href="glm-1.html#cb50-158" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evs_vox) 0</span></span>
<span id="cb50-159"><a href="glm-1.html#cb50-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-160"><a href="glm-1.html#cb50-160" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of contrasts</span></span>
<span id="cb50-161"><a href="glm-1.html#cb50-161" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ncon_orig) 3</span></span>
<span id="cb50-162"><a href="glm-1.html#cb50-162" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ncon_real) 3</span></span>
<span id="cb50-163"><a href="glm-1.html#cb50-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-164"><a href="glm-1.html#cb50-164" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of F-tests</span></span>
<span id="cb50-165"><a href="glm-1.html#cb50-165" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(nftests_orig) 1</span></span>
<span id="cb50-166"><a href="glm-1.html#cb50-166" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(nftests_real) 1</span></span>
<span id="cb50-167"><a href="glm-1.html#cb50-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-168"><a href="glm-1.html#cb50-168" aria-hidden="true" tabindex="-1"></a><span class="st"># Add constant column to design matrix? (obsolete)</span></span>
<span id="cb50-169"><a href="glm-1.html#cb50-169" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(constcol) 0</span></span>
<span id="cb50-170"><a href="glm-1.html#cb50-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-171"><a href="glm-1.html#cb50-171" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out post-stats steps?</span></span>
<span id="cb50-172"><a href="glm-1.html#cb50-172" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(poststats_yn) 0</span></span>
<span id="cb50-173"><a href="glm-1.html#cb50-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-174"><a href="glm-1.html#cb50-174" aria-hidden="true" tabindex="-1"></a><span class="st"># Pre-threshold masking?</span></span>
<span id="cb50-175"><a href="glm-1.html#cb50-175" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(threshmask) &quot;&quot;</span></span>
<span id="cb50-176"><a href="glm-1.html#cb50-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-177"><a href="glm-1.html#cb50-177" aria-hidden="true" tabindex="-1"></a><span class="st"># Thresholding</span></span>
<span id="cb50-178"><a href="glm-1.html#cb50-178" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb50-179"><a href="glm-1.html#cb50-179" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Uncorrected</span></span>
<span id="cb50-180"><a href="glm-1.html#cb50-180" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Voxel</span></span>
<span id="cb50-181"><a href="glm-1.html#cb50-181" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Cluster</span></span>
<span id="cb50-182"><a href="glm-1.html#cb50-182" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(thresh) 3</span></span>
<span id="cb50-183"><a href="glm-1.html#cb50-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-184"><a href="glm-1.html#cb50-184" aria-hidden="true" tabindex="-1"></a><span class="st"># P threshold</span></span>
<span id="cb50-185"><a href="glm-1.html#cb50-185" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(prob_thresh) 0.05</span></span>
<span id="cb50-186"><a href="glm-1.html#cb50-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-187"><a href="glm-1.html#cb50-187" aria-hidden="true" tabindex="-1"></a><span class="st"># Z threshold</span></span>
<span id="cb50-188"><a href="glm-1.html#cb50-188" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(z_thresh) 3.1</span></span>
<span id="cb50-189"><a href="glm-1.html#cb50-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-190"><a href="glm-1.html#cb50-190" aria-hidden="true" tabindex="-1"></a><span class="st"># Z min/max for colour rendering</span></span>
<span id="cb50-191"><a href="glm-1.html#cb50-191" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Use actual Z min/max</span></span>
<span id="cb50-192"><a href="glm-1.html#cb50-192" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Use preset Z min/max</span></span>
<span id="cb50-193"><a href="glm-1.html#cb50-193" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(zdisplay) 0</span></span>
<span id="cb50-194"><a href="glm-1.html#cb50-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-195"><a href="glm-1.html#cb50-195" aria-hidden="true" tabindex="-1"></a><span class="st"># Z min in colour rendering</span></span>
<span id="cb50-196"><a href="glm-1.html#cb50-196" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(zmin) 2</span></span>
<span id="cb50-197"><a href="glm-1.html#cb50-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-198"><a href="glm-1.html#cb50-198" aria-hidden="true" tabindex="-1"></a><span class="st"># Z max in colour rendering</span></span>
<span id="cb50-199"><a href="glm-1.html#cb50-199" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(zmax) 8</span></span>
<span id="cb50-200"><a href="glm-1.html#cb50-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-201"><a href="glm-1.html#cb50-201" aria-hidden="true" tabindex="-1"></a><span class="st"># Colour rendering type</span></span>
<span id="cb50-202"><a href="glm-1.html#cb50-202" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Solid blobs</span></span>
<span id="cb50-203"><a href="glm-1.html#cb50-203" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Transparent blobs</span></span>
<span id="cb50-204"><a href="glm-1.html#cb50-204" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(rendertype) 1</span></span>
<span id="cb50-205"><a href="glm-1.html#cb50-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-206"><a href="glm-1.html#cb50-206" aria-hidden="true" tabindex="-1"></a><span class="st"># Background image for higher-level stats overlays</span></span>
<span id="cb50-207"><a href="glm-1.html#cb50-207" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Mean highres</span></span>
<span id="cb50-208"><a href="glm-1.html#cb50-208" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : First highres</span></span>
<span id="cb50-209"><a href="glm-1.html#cb50-209" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Mean functional</span></span>
<span id="cb50-210"><a href="glm-1.html#cb50-210" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : First functional</span></span>
<span id="cb50-211"><a href="glm-1.html#cb50-211" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Standard space template</span></span>
<span id="cb50-212"><a href="glm-1.html#cb50-212" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(bgimage) 1</span></span>
<span id="cb50-213"><a href="glm-1.html#cb50-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-214"><a href="glm-1.html#cb50-214" aria-hidden="true" tabindex="-1"></a><span class="st"># Create time series plots</span></span>
<span id="cb50-215"><a href="glm-1.html#cb50-215" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tsplot_yn) 1</span></span>
<span id="cb50-216"><a href="glm-1.html#cb50-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-217"><a href="glm-1.html#cb50-217" aria-hidden="true" tabindex="-1"></a><span class="st"># Registration to initial structural</span></span>
<span id="cb50-218"><a href="glm-1.html#cb50-218" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reginitial_highres_yn) 0</span></span>
<span id="cb50-219"><a href="glm-1.html#cb50-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-220"><a href="glm-1.html#cb50-220" aria-hidden="true" tabindex="-1"></a><span class="st"># Search space for registration to initial structural</span></span>
<span id="cb50-221"><a href="glm-1.html#cb50-221" aria-hidden="true" tabindex="-1"></a><span class="st"># 0   : No search</span></span>
<span id="cb50-222"><a href="glm-1.html#cb50-222" aria-hidden="true" tabindex="-1"></a><span class="st"># 90  : Normal search</span></span>
<span id="cb50-223"><a href="glm-1.html#cb50-223" aria-hidden="true" tabindex="-1"></a><span class="st"># 180 : Full search</span></span>
<span id="cb50-224"><a href="glm-1.html#cb50-224" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reginitial_highres_search) 90</span></span>
<span id="cb50-225"><a href="glm-1.html#cb50-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-226"><a href="glm-1.html#cb50-226" aria-hidden="true" tabindex="-1"></a><span class="st"># Degrees of Freedom for registration to initial structural</span></span>
<span id="cb50-227"><a href="glm-1.html#cb50-227" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reginitial_highres_dof) 3</span></span>
<span id="cb50-228"><a href="glm-1.html#cb50-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-229"><a href="glm-1.html#cb50-229" aria-hidden="true" tabindex="-1"></a><span class="st"># Registration to main structural</span></span>
<span id="cb50-230"><a href="glm-1.html#cb50-230" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reghighres_yn) 0</span></span>
<span id="cb50-231"><a href="glm-1.html#cb50-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-232"><a href="glm-1.html#cb50-232" aria-hidden="true" tabindex="-1"></a><span class="st"># Search space for registration to main structural</span></span>
<span id="cb50-233"><a href="glm-1.html#cb50-233" aria-hidden="true" tabindex="-1"></a><span class="st"># 0   : No search</span></span>
<span id="cb50-234"><a href="glm-1.html#cb50-234" aria-hidden="true" tabindex="-1"></a><span class="st"># 90  : Normal search</span></span>
<span id="cb50-235"><a href="glm-1.html#cb50-235" aria-hidden="true" tabindex="-1"></a><span class="st"># 180 : Full search</span></span>
<span id="cb50-236"><a href="glm-1.html#cb50-236" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reghighres_search) 90</span></span>
<span id="cb50-237"><a href="glm-1.html#cb50-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-238"><a href="glm-1.html#cb50-238" aria-hidden="true" tabindex="-1"></a><span class="st"># Degrees of Freedom for registration to main structural</span></span>
<span id="cb50-239"><a href="glm-1.html#cb50-239" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reghighres_dof) BBR</span></span>
<span id="cb50-240"><a href="glm-1.html#cb50-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-241"><a href="glm-1.html#cb50-241" aria-hidden="true" tabindex="-1"></a><span class="st"># Registration to standard image?</span></span>
<span id="cb50-242"><a href="glm-1.html#cb50-242" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_yn) 1</span></span>
<span id="cb50-243"><a href="glm-1.html#cb50-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-244"><a href="glm-1.html#cb50-244" aria-hidden="true" tabindex="-1"></a><span class="st"># Use alternate reference images?</span></span>
<span id="cb50-245"><a href="glm-1.html#cb50-245" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(alternateReference_yn) 0</span></span>
<span id="cb50-246"><a href="glm-1.html#cb50-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-247"><a href="glm-1.html#cb50-247" aria-hidden="true" tabindex="-1"></a><span class="st"># Standard image</span></span>
<span id="cb50-248"><a href="glm-1.html#cb50-248" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard) &quot;/usr/local/fsl/data/standard/MNI152_T1_2mm_brain&quot;</span></span>
<span id="cb50-249"><a href="glm-1.html#cb50-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-250"><a href="glm-1.html#cb50-250" aria-hidden="true" tabindex="-1"></a><span class="st"># Search space for registration to standard space</span></span>
<span id="cb50-251"><a href="glm-1.html#cb50-251" aria-hidden="true" tabindex="-1"></a><span class="st"># 0   : No search</span></span>
<span id="cb50-252"><a href="glm-1.html#cb50-252" aria-hidden="true" tabindex="-1"></a><span class="st"># 90  : Normal search</span></span>
<span id="cb50-253"><a href="glm-1.html#cb50-253" aria-hidden="true" tabindex="-1"></a><span class="st"># 180 : Full search</span></span>
<span id="cb50-254"><a href="glm-1.html#cb50-254" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_search) 90</span></span>
<span id="cb50-255"><a href="glm-1.html#cb50-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-256"><a href="glm-1.html#cb50-256" aria-hidden="true" tabindex="-1"></a><span class="st"># Degrees of Freedom for registration to standard space</span></span>
<span id="cb50-257"><a href="glm-1.html#cb50-257" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_dof) 3</span></span>
<span id="cb50-258"><a href="glm-1.html#cb50-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-259"><a href="glm-1.html#cb50-259" aria-hidden="true" tabindex="-1"></a><span class="st"># Do nonlinear registration from structural to standard space?</span></span>
<span id="cb50-260"><a href="glm-1.html#cb50-260" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_nonlinear_yn) 0</span></span>
<span id="cb50-261"><a href="glm-1.html#cb50-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-262"><a href="glm-1.html#cb50-262" aria-hidden="true" tabindex="-1"></a><span class="st"># Control nonlinear warp field resolution</span></span>
<span id="cb50-263"><a href="glm-1.html#cb50-263" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_nonlinear_warpres) 10 </span></span>
<span id="cb50-264"><a href="glm-1.html#cb50-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-265"><a href="glm-1.html#cb50-265" aria-hidden="true" tabindex="-1"></a><span class="st"># High pass filter cutoff</span></span>
<span id="cb50-266"><a href="glm-1.html#cb50-266" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(paradigm_hp) 100</span></span>
<span id="cb50-267"><a href="glm-1.html#cb50-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-268"><a href="glm-1.html#cb50-268" aria-hidden="true" tabindex="-1"></a><span class="st"># Total voxels</span></span>
<span id="cb50-269"><a href="glm-1.html#cb50-269" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(totalVoxels) 179159040</span></span>
<span id="cb50-270"><a href="glm-1.html#cb50-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-271"><a href="glm-1.html#cb50-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-272"><a href="glm-1.html#cb50-272" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of lower-level copes feeding into higher-level analysis</span></span>
<span id="cb50-273"><a href="glm-1.html#cb50-273" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ncopeinputs) 0</span></span>
<span id="cb50-274"><a href="glm-1.html#cb50-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-275"><a href="glm-1.html#cb50-275" aria-hidden="true" tabindex="-1"></a><span class="st"># 4D AVW data or FEAT directory (1)</span></span>
<span id="cb50-276"><a href="glm-1.html#cb50-276" aria-hidden="true" tabindex="-1"></a><span class="st">set feat_files(1) &quot;@func_fn@&quot;</span></span>
<span id="cb50-277"><a href="glm-1.html#cb50-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-278"><a href="glm-1.html#cb50-278" aria-hidden="true" tabindex="-1"></a><span class="st"># Add confound EVs text file</span></span>
<span id="cb50-279"><a href="glm-1.html#cb50-279" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(confoundevs) 1</span></span>
<span id="cb50-280"><a href="glm-1.html#cb50-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-281"><a href="glm-1.html#cb50-281" aria-hidden="true" tabindex="-1"></a><span class="st"># Confound EVs text file for analysis 1</span></span>
<span id="cb50-282"><a href="glm-1.html#cb50-282" aria-hidden="true" tabindex="-1"></a><span class="st">set confoundev_files(1) &quot;@conf_ev_fn@&quot;</span></span>
<span id="cb50-283"><a href="glm-1.html#cb50-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-284"><a href="glm-1.html#cb50-284" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 1 title</span></span>
<span id="cb50-285"><a href="glm-1.html#cb50-285" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle1) &quot;navigation&quot;</span></span>
<span id="cb50-286"><a href="glm-1.html#cb50-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-287"><a href="glm-1.html#cb50-287" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 1)</span></span>
<span id="cb50-288"><a href="glm-1.html#cb50-288" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb50-289"><a href="glm-1.html#cb50-289" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb50-290"><a href="glm-1.html#cb50-290" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb50-291"><a href="glm-1.html#cb50-291" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb50-292"><a href="glm-1.html#cb50-292" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb50-293"><a href="glm-1.html#cb50-293" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb50-294"><a href="glm-1.html#cb50-294" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape1) 3</span></span>
<span id="cb50-295"><a href="glm-1.html#cb50-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-296"><a href="glm-1.html#cb50-296" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 1)</span></span>
<span id="cb50-297"><a href="glm-1.html#cb50-297" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb50-298"><a href="glm-1.html#cb50-298" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb50-299"><a href="glm-1.html#cb50-299" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb50-300"><a href="glm-1.html#cb50-300" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb50-301"><a href="glm-1.html#cb50-301" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb50-302"><a href="glm-1.html#cb50-302" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb50-303"><a href="glm-1.html#cb50-303" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb50-304"><a href="glm-1.html#cb50-304" aria-hidden="true" tabindex="-1"></a><span class="st"># 8 : Alternate Double-Gamma</span></span>
<span id="cb50-305"><a href="glm-1.html#cb50-305" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve1) 2</span></span>
<span id="cb50-306"><a href="glm-1.html#cb50-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-307"><a href="glm-1.html#cb50-307" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 1)</span></span>
<span id="cb50-308"><a href="glm-1.html#cb50-308" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase1) 0</span></span>
<span id="cb50-309"><a href="glm-1.html#cb50-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-310"><a href="glm-1.html#cb50-310" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 1)</span></span>
<span id="cb50-311"><a href="glm-1.html#cb50-311" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn1) 1</span></span>
<span id="cb50-312"><a href="glm-1.html#cb50-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-313"><a href="glm-1.html#cb50-313" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 1)</span></span>
<span id="cb50-314"><a href="glm-1.html#cb50-314" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn1) 1</span></span>
<span id="cb50-315"><a href="glm-1.html#cb50-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-316"><a href="glm-1.html#cb50-316" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 1)</span></span>
<span id="cb50-317"><a href="glm-1.html#cb50-317" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom1) &quot;@navi_ev_fn@&quot;</span></span>
<span id="cb50-318"><a href="glm-1.html#cb50-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-319"><a href="glm-1.html#cb50-319" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 1)</span></span>
<span id="cb50-320"><a href="glm-1.html#cb50-320" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma1) 3</span></span>
<span id="cb50-321"><a href="glm-1.html#cb50-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-322"><a href="glm-1.html#cb50-322" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 1)</span></span>
<span id="cb50-323"><a href="glm-1.html#cb50-323" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay1) 6</span></span>
<span id="cb50-324"><a href="glm-1.html#cb50-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-325"><a href="glm-1.html#cb50-325" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 0</span></span>
<span id="cb50-326"><a href="glm-1.html#cb50-326" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.0) 0</span></span>
<span id="cb50-327"><a href="glm-1.html#cb50-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-328"><a href="glm-1.html#cb50-328" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 1</span></span>
<span id="cb50-329"><a href="glm-1.html#cb50-329" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.1) 0</span></span>
<span id="cb50-330"><a href="glm-1.html#cb50-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-331"><a href="glm-1.html#cb50-331" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 2</span></span>
<span id="cb50-332"><a href="glm-1.html#cb50-332" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.2) 0</span></span>
<span id="cb50-333"><a href="glm-1.html#cb50-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-334"><a href="glm-1.html#cb50-334" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 3</span></span>
<span id="cb50-335"><a href="glm-1.html#cb50-335" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.3) 0</span></span>
<span id="cb50-336"><a href="glm-1.html#cb50-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-337"><a href="glm-1.html#cb50-337" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 4</span></span>
<span id="cb50-338"><a href="glm-1.html#cb50-338" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.4) 0</span></span>
<span id="cb50-339"><a href="glm-1.html#cb50-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-340"><a href="glm-1.html#cb50-340" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 2 title</span></span>
<span id="cb50-341"><a href="glm-1.html#cb50-341" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle2) &quot;sine&quot;</span></span>
<span id="cb50-342"><a href="glm-1.html#cb50-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-343"><a href="glm-1.html#cb50-343" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 2)</span></span>
<span id="cb50-344"><a href="glm-1.html#cb50-344" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb50-345"><a href="glm-1.html#cb50-345" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb50-346"><a href="glm-1.html#cb50-346" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb50-347"><a href="glm-1.html#cb50-347" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb50-348"><a href="glm-1.html#cb50-348" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb50-349"><a href="glm-1.html#cb50-349" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb50-350"><a href="glm-1.html#cb50-350" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape2) 3</span></span>
<span id="cb50-351"><a href="glm-1.html#cb50-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-352"><a href="glm-1.html#cb50-352" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 2)</span></span>
<span id="cb50-353"><a href="glm-1.html#cb50-353" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb50-354"><a href="glm-1.html#cb50-354" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb50-355"><a href="glm-1.html#cb50-355" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb50-356"><a href="glm-1.html#cb50-356" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb50-357"><a href="glm-1.html#cb50-357" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb50-358"><a href="glm-1.html#cb50-358" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb50-359"><a href="glm-1.html#cb50-359" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb50-360"><a href="glm-1.html#cb50-360" aria-hidden="true" tabindex="-1"></a><span class="st"># 8 : Alternate Double-Gamma</span></span>
<span id="cb50-361"><a href="glm-1.html#cb50-361" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve2) 2</span></span>
<span id="cb50-362"><a href="glm-1.html#cb50-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-363"><a href="glm-1.html#cb50-363" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 2)</span></span>
<span id="cb50-364"><a href="glm-1.html#cb50-364" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase2) 0</span></span>
<span id="cb50-365"><a href="glm-1.html#cb50-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-366"><a href="glm-1.html#cb50-366" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 2)</span></span>
<span id="cb50-367"><a href="glm-1.html#cb50-367" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn2) 1</span></span>
<span id="cb50-368"><a href="glm-1.html#cb50-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-369"><a href="glm-1.html#cb50-369" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 2)</span></span>
<span id="cb50-370"><a href="glm-1.html#cb50-370" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn2) 1</span></span>
<span id="cb50-371"><a href="glm-1.html#cb50-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-372"><a href="glm-1.html#cb50-372" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 2)</span></span>
<span id="cb50-373"><a href="glm-1.html#cb50-373" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom2) &quot;@sine_ev_fn@&quot;</span></span>
<span id="cb50-374"><a href="glm-1.html#cb50-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-375"><a href="glm-1.html#cb50-375" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 2)</span></span>
<span id="cb50-376"><a href="glm-1.html#cb50-376" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma2) 3</span></span>
<span id="cb50-377"><a href="glm-1.html#cb50-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-378"><a href="glm-1.html#cb50-378" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 2)</span></span>
<span id="cb50-379"><a href="glm-1.html#cb50-379" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay2) 6</span></span>
<span id="cb50-380"><a href="glm-1.html#cb50-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-381"><a href="glm-1.html#cb50-381" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 0</span></span>
<span id="cb50-382"><a href="glm-1.html#cb50-382" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.0) 0</span></span>
<span id="cb50-383"><a href="glm-1.html#cb50-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-384"><a href="glm-1.html#cb50-384" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 1</span></span>
<span id="cb50-385"><a href="glm-1.html#cb50-385" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.1) 0</span></span>
<span id="cb50-386"><a href="glm-1.html#cb50-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-387"><a href="glm-1.html#cb50-387" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 2</span></span>
<span id="cb50-388"><a href="glm-1.html#cb50-388" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.2) 0</span></span>
<span id="cb50-389"><a href="glm-1.html#cb50-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-390"><a href="glm-1.html#cb50-390" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 3</span></span>
<span id="cb50-391"><a href="glm-1.html#cb50-391" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.3) 0</span></span>
<span id="cb50-392"><a href="glm-1.html#cb50-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-393"><a href="glm-1.html#cb50-393" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 4</span></span>
<span id="cb50-394"><a href="glm-1.html#cb50-394" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.4) 0</span></span>
<span id="cb50-395"><a href="glm-1.html#cb50-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-396"><a href="glm-1.html#cb50-396" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 3 title</span></span>
<span id="cb50-397"><a href="glm-1.html#cb50-397" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle3) &quot;cosine&quot;</span></span>
<span id="cb50-398"><a href="glm-1.html#cb50-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-399"><a href="glm-1.html#cb50-399" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 3)</span></span>
<span id="cb50-400"><a href="glm-1.html#cb50-400" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb50-401"><a href="glm-1.html#cb50-401" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb50-402"><a href="glm-1.html#cb50-402" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb50-403"><a href="glm-1.html#cb50-403" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb50-404"><a href="glm-1.html#cb50-404" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb50-405"><a href="glm-1.html#cb50-405" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb50-406"><a href="glm-1.html#cb50-406" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape3) 3</span></span>
<span id="cb50-407"><a href="glm-1.html#cb50-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-408"><a href="glm-1.html#cb50-408" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 3)</span></span>
<span id="cb50-409"><a href="glm-1.html#cb50-409" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb50-410"><a href="glm-1.html#cb50-410" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb50-411"><a href="glm-1.html#cb50-411" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb50-412"><a href="glm-1.html#cb50-412" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb50-413"><a href="glm-1.html#cb50-413" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb50-414"><a href="glm-1.html#cb50-414" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb50-415"><a href="glm-1.html#cb50-415" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb50-416"><a href="glm-1.html#cb50-416" aria-hidden="true" tabindex="-1"></a><span class="st"># 8 : Alternate Double-Gamma</span></span>
<span id="cb50-417"><a href="glm-1.html#cb50-417" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve3) 2</span></span>
<span id="cb50-418"><a href="glm-1.html#cb50-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-419"><a href="glm-1.html#cb50-419" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 3)</span></span>
<span id="cb50-420"><a href="glm-1.html#cb50-420" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase3) 0</span></span>
<span id="cb50-421"><a href="glm-1.html#cb50-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-422"><a href="glm-1.html#cb50-422" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 3)</span></span>
<span id="cb50-423"><a href="glm-1.html#cb50-423" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn3) 1</span></span>
<span id="cb50-424"><a href="glm-1.html#cb50-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-425"><a href="glm-1.html#cb50-425" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 3)</span></span>
<span id="cb50-426"><a href="glm-1.html#cb50-426" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn3) 1</span></span>
<span id="cb50-427"><a href="glm-1.html#cb50-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-428"><a href="glm-1.html#cb50-428" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 3)</span></span>
<span id="cb50-429"><a href="glm-1.html#cb50-429" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom3) &quot;@cosine_ev_fn@&quot;</span></span>
<span id="cb50-430"><a href="glm-1.html#cb50-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-431"><a href="glm-1.html#cb50-431" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 3)</span></span>
<span id="cb50-432"><a href="glm-1.html#cb50-432" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma3) 3</span></span>
<span id="cb50-433"><a href="glm-1.html#cb50-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-434"><a href="glm-1.html#cb50-434" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 3)</span></span>
<span id="cb50-435"><a href="glm-1.html#cb50-435" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay3) 6</span></span>
<span id="cb50-436"><a href="glm-1.html#cb50-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-437"><a href="glm-1.html#cb50-437" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 0</span></span>
<span id="cb50-438"><a href="glm-1.html#cb50-438" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.0) 0</span></span>
<span id="cb50-439"><a href="glm-1.html#cb50-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-440"><a href="glm-1.html#cb50-440" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 1</span></span>
<span id="cb50-441"><a href="glm-1.html#cb50-441" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.1) 0</span></span>
<span id="cb50-442"><a href="glm-1.html#cb50-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-443"><a href="glm-1.html#cb50-443" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 2</span></span>
<span id="cb50-444"><a href="glm-1.html#cb50-444" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.2) 0</span></span>
<span id="cb50-445"><a href="glm-1.html#cb50-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-446"><a href="glm-1.html#cb50-446" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 3</span></span>
<span id="cb50-447"><a href="glm-1.html#cb50-447" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.3) 0</span></span>
<span id="cb50-448"><a href="glm-1.html#cb50-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-449"><a href="glm-1.html#cb50-449" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 4</span></span>
<span id="cb50-450"><a href="glm-1.html#cb50-450" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.4) 0</span></span>
<span id="cb50-451"><a href="glm-1.html#cb50-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-452"><a href="glm-1.html#cb50-452" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 4 title</span></span>
<span id="cb50-453"><a href="glm-1.html#cb50-453" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle4) &quot;feedback&quot;</span></span>
<span id="cb50-454"><a href="glm-1.html#cb50-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-455"><a href="glm-1.html#cb50-455" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 4)</span></span>
<span id="cb50-456"><a href="glm-1.html#cb50-456" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb50-457"><a href="glm-1.html#cb50-457" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb50-458"><a href="glm-1.html#cb50-458" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb50-459"><a href="glm-1.html#cb50-459" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb50-460"><a href="glm-1.html#cb50-460" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb50-461"><a href="glm-1.html#cb50-461" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb50-462"><a href="glm-1.html#cb50-462" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape4) 3</span></span>
<span id="cb50-463"><a href="glm-1.html#cb50-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-464"><a href="glm-1.html#cb50-464" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 4)</span></span>
<span id="cb50-465"><a href="glm-1.html#cb50-465" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb50-466"><a href="glm-1.html#cb50-466" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb50-467"><a href="glm-1.html#cb50-467" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb50-468"><a href="glm-1.html#cb50-468" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb50-469"><a href="glm-1.html#cb50-469" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb50-470"><a href="glm-1.html#cb50-470" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb50-471"><a href="glm-1.html#cb50-471" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb50-472"><a href="glm-1.html#cb50-472" aria-hidden="true" tabindex="-1"></a><span class="st"># 8 : Alternate Double-Gamma</span></span>
<span id="cb50-473"><a href="glm-1.html#cb50-473" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve4) 2</span></span>
<span id="cb50-474"><a href="glm-1.html#cb50-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-475"><a href="glm-1.html#cb50-475" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 4)</span></span>
<span id="cb50-476"><a href="glm-1.html#cb50-476" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase4) 0</span></span>
<span id="cb50-477"><a href="glm-1.html#cb50-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-478"><a href="glm-1.html#cb50-478" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 4)</span></span>
<span id="cb50-479"><a href="glm-1.html#cb50-479" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn4) 1</span></span>
<span id="cb50-480"><a href="glm-1.html#cb50-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-481"><a href="glm-1.html#cb50-481" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 4)</span></span>
<span id="cb50-482"><a href="glm-1.html#cb50-482" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn4) 1</span></span>
<span id="cb50-483"><a href="glm-1.html#cb50-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-484"><a href="glm-1.html#cb50-484" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 4)</span></span>
<span id="cb50-485"><a href="glm-1.html#cb50-485" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom4) &quot;@feedback_ev_fn@&quot;</span></span>
<span id="cb50-486"><a href="glm-1.html#cb50-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-487"><a href="glm-1.html#cb50-487" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 4)</span></span>
<span id="cb50-488"><a href="glm-1.html#cb50-488" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma4) 3</span></span>
<span id="cb50-489"><a href="glm-1.html#cb50-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-490"><a href="glm-1.html#cb50-490" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 4)</span></span>
<span id="cb50-491"><a href="glm-1.html#cb50-491" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay4) 6</span></span>
<span id="cb50-492"><a href="glm-1.html#cb50-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-493"><a href="glm-1.html#cb50-493" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 4 wrt EV 0</span></span>
<span id="cb50-494"><a href="glm-1.html#cb50-494" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho4.0) 0</span></span>
<span id="cb50-495"><a href="glm-1.html#cb50-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-496"><a href="glm-1.html#cb50-496" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 4 wrt EV 1</span></span>
<span id="cb50-497"><a href="glm-1.html#cb50-497" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho4.1) 0</span></span>
<span id="cb50-498"><a href="glm-1.html#cb50-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-499"><a href="glm-1.html#cb50-499" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 4 wrt EV 2</span></span>
<span id="cb50-500"><a href="glm-1.html#cb50-500" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho4.2) 0</span></span>
<span id="cb50-501"><a href="glm-1.html#cb50-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-502"><a href="glm-1.html#cb50-502" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 4 wrt EV 3</span></span>
<span id="cb50-503"><a href="glm-1.html#cb50-503" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho4.3) 0</span></span>
<span id="cb50-504"><a href="glm-1.html#cb50-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-505"><a href="glm-1.html#cb50-505" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 4 wrt EV 4</span></span>
<span id="cb50-506"><a href="glm-1.html#cb50-506" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho4.4) 0</span></span>
<span id="cb50-507"><a href="glm-1.html#cb50-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-508"><a href="glm-1.html#cb50-508" aria-hidden="true" tabindex="-1"></a><span class="st"># Contrast &amp; F-tests mode</span></span>
<span id="cb50-509"><a href="glm-1.html#cb50-509" aria-hidden="true" tabindex="-1"></a><span class="st"># real : control real EVs</span></span>
<span id="cb50-510"><a href="glm-1.html#cb50-510" aria-hidden="true" tabindex="-1"></a><span class="st"># orig : control original EVs</span></span>
<span id="cb50-511"><a href="glm-1.html#cb50-511" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_mode_old) orig</span></span>
<span id="cb50-512"><a href="glm-1.html#cb50-512" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_mode) orig</span></span>
<span id="cb50-513"><a href="glm-1.html#cb50-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-514"><a href="glm-1.html#cb50-514" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_real 1</span></span>
<span id="cb50-515"><a href="glm-1.html#cb50-515" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_real.1) 1</span></span>
<span id="cb50-516"><a href="glm-1.html#cb50-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-517"><a href="glm-1.html#cb50-517" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_real 1</span></span>
<span id="cb50-518"><a href="glm-1.html#cb50-518" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_real.1) &quot;navigation vs. baseline&quot;</span></span>
<span id="cb50-519"><a href="glm-1.html#cb50-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-520"><a href="glm-1.html#cb50-520" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 1</span></span>
<span id="cb50-521"><a href="glm-1.html#cb50-521" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.1) 1</span></span>
<span id="cb50-522"><a href="glm-1.html#cb50-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-523"><a href="glm-1.html#cb50-523" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 2</span></span>
<span id="cb50-524"><a href="glm-1.html#cb50-524" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.2) 0</span></span>
<span id="cb50-525"><a href="glm-1.html#cb50-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-526"><a href="glm-1.html#cb50-526" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 3</span></span>
<span id="cb50-527"><a href="glm-1.html#cb50-527" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.3) 0</span></span>
<span id="cb50-528"><a href="glm-1.html#cb50-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-529"><a href="glm-1.html#cb50-529" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 4</span></span>
<span id="cb50-530"><a href="glm-1.html#cb50-530" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.4) 0</span></span>
<span id="cb50-531"><a href="glm-1.html#cb50-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-532"><a href="glm-1.html#cb50-532" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 5</span></span>
<span id="cb50-533"><a href="glm-1.html#cb50-533" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.5) 0</span></span>
<span id="cb50-534"><a href="glm-1.html#cb50-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-535"><a href="glm-1.html#cb50-535" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 6</span></span>
<span id="cb50-536"><a href="glm-1.html#cb50-536" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.6) 0</span></span>
<span id="cb50-537"><a href="glm-1.html#cb50-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-538"><a href="glm-1.html#cb50-538" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 7</span></span>
<span id="cb50-539"><a href="glm-1.html#cb50-539" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.7) 0</span></span>
<span id="cb50-540"><a href="glm-1.html#cb50-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-541"><a href="glm-1.html#cb50-541" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 8</span></span>
<span id="cb50-542"><a href="glm-1.html#cb50-542" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.8) 0</span></span>
<span id="cb50-543"><a href="glm-1.html#cb50-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-544"><a href="glm-1.html#cb50-544" aria-hidden="true" tabindex="-1"></a><span class="st"># F-test 1 element 1</span></span>
<span id="cb50-545"><a href="glm-1.html#cb50-545" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ftest_real1.1) 0</span></span>
<span id="cb50-546"><a href="glm-1.html#cb50-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-547"><a href="glm-1.html#cb50-547" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_real 2</span></span>
<span id="cb50-548"><a href="glm-1.html#cb50-548" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_real.2) 1</span></span>
<span id="cb50-549"><a href="glm-1.html#cb50-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-550"><a href="glm-1.html#cb50-550" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_real 2</span></span>
<span id="cb50-551"><a href="glm-1.html#cb50-551" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_real.2) &quot;sine vs. 0&quot;</span></span>
<span id="cb50-552"><a href="glm-1.html#cb50-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-553"><a href="glm-1.html#cb50-553" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 2 element 1</span></span>
<span id="cb50-554"><a href="glm-1.html#cb50-554" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real2.1) 0</span></span>
<span id="cb50-555"><a href="glm-1.html#cb50-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-556"><a href="glm-1.html#cb50-556" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 2 element 2</span></span>
<span id="cb50-557"><a href="glm-1.html#cb50-557" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real2.2) 0</span></span>
<span id="cb50-558"><a href="glm-1.html#cb50-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-559"><a href="glm-1.html#cb50-559" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 2 element 3</span></span>
<span id="cb50-560"><a href="glm-1.html#cb50-560" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real2.3) 1.0</span></span>
<span id="cb50-561"><a href="glm-1.html#cb50-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-562"><a href="glm-1.html#cb50-562" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 2 element 4</span></span>
<span id="cb50-563"><a href="glm-1.html#cb50-563" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real2.4) 0</span></span>
<span id="cb50-564"><a href="glm-1.html#cb50-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-565"><a href="glm-1.html#cb50-565" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 2 element 5</span></span>
<span id="cb50-566"><a href="glm-1.html#cb50-566" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real2.5) 0</span></span>
<span id="cb50-567"><a href="glm-1.html#cb50-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-568"><a href="glm-1.html#cb50-568" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 2 element 6</span></span>
<span id="cb50-569"><a href="glm-1.html#cb50-569" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real2.6) 0</span></span>
<span id="cb50-570"><a href="glm-1.html#cb50-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-571"><a href="glm-1.html#cb50-571" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 2 element 7</span></span>
<span id="cb50-572"><a href="glm-1.html#cb50-572" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real2.7) 0</span></span>
<span id="cb50-573"><a href="glm-1.html#cb50-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-574"><a href="glm-1.html#cb50-574" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 2 element 8</span></span>
<span id="cb50-575"><a href="glm-1.html#cb50-575" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real2.8) 0</span></span>
<span id="cb50-576"><a href="glm-1.html#cb50-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-577"><a href="glm-1.html#cb50-577" aria-hidden="true" tabindex="-1"></a><span class="st"># F-test 1 element 2</span></span>
<span id="cb50-578"><a href="glm-1.html#cb50-578" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ftest_real1.2) 1</span></span>
<span id="cb50-579"><a href="glm-1.html#cb50-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-580"><a href="glm-1.html#cb50-580" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_real 3</span></span>
<span id="cb50-581"><a href="glm-1.html#cb50-581" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_real.3) 1</span></span>
<span id="cb50-582"><a href="glm-1.html#cb50-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-583"><a href="glm-1.html#cb50-583" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_real 3</span></span>
<span id="cb50-584"><a href="glm-1.html#cb50-584" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_real.3) &quot;cosine vs. 0&quot;</span></span>
<span id="cb50-585"><a href="glm-1.html#cb50-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-586"><a href="glm-1.html#cb50-586" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 3 element 1</span></span>
<span id="cb50-587"><a href="glm-1.html#cb50-587" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real3.1) 0</span></span>
<span id="cb50-588"><a href="glm-1.html#cb50-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-589"><a href="glm-1.html#cb50-589" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 3 element 2</span></span>
<span id="cb50-590"><a href="glm-1.html#cb50-590" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real3.2) 0</span></span>
<span id="cb50-591"><a href="glm-1.html#cb50-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-592"><a href="glm-1.html#cb50-592" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 3 element 3</span></span>
<span id="cb50-593"><a href="glm-1.html#cb50-593" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real3.3) 0</span></span>
<span id="cb50-594"><a href="glm-1.html#cb50-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-595"><a href="glm-1.html#cb50-595" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 3 element 4</span></span>
<span id="cb50-596"><a href="glm-1.html#cb50-596" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real3.4) 0</span></span>
<span id="cb50-597"><a href="glm-1.html#cb50-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-598"><a href="glm-1.html#cb50-598" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 3 element 5</span></span>
<span id="cb50-599"><a href="glm-1.html#cb50-599" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real3.5) 1.0</span></span>
<span id="cb50-600"><a href="glm-1.html#cb50-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-601"><a href="glm-1.html#cb50-601" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 3 element 6</span></span>
<span id="cb50-602"><a href="glm-1.html#cb50-602" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real3.6) 0</span></span>
<span id="cb50-603"><a href="glm-1.html#cb50-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-604"><a href="glm-1.html#cb50-604" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 3 element 7</span></span>
<span id="cb50-605"><a href="glm-1.html#cb50-605" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real3.7) 0</span></span>
<span id="cb50-606"><a href="glm-1.html#cb50-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-607"><a href="glm-1.html#cb50-607" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 3 element 8</span></span>
<span id="cb50-608"><a href="glm-1.html#cb50-608" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real3.8) 0</span></span>
<span id="cb50-609"><a href="glm-1.html#cb50-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-610"><a href="glm-1.html#cb50-610" aria-hidden="true" tabindex="-1"></a><span class="st"># F-test 1 element 3</span></span>
<span id="cb50-611"><a href="glm-1.html#cb50-611" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ftest_real1.3) 1</span></span>
<span id="cb50-612"><a href="glm-1.html#cb50-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-613"><a href="glm-1.html#cb50-613" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_orig 1</span></span>
<span id="cb50-614"><a href="glm-1.html#cb50-614" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_orig.1) 1</span></span>
<span id="cb50-615"><a href="glm-1.html#cb50-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-616"><a href="glm-1.html#cb50-616" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_orig 1</span></span>
<span id="cb50-617"><a href="glm-1.html#cb50-617" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_orig.1) &quot;navigation vs. baseline&quot;</span></span>
<span id="cb50-618"><a href="glm-1.html#cb50-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-619"><a href="glm-1.html#cb50-619" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 1</span></span>
<span id="cb50-620"><a href="glm-1.html#cb50-620" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.1) 1</span></span>
<span id="cb50-621"><a href="glm-1.html#cb50-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-622"><a href="glm-1.html#cb50-622" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 2</span></span>
<span id="cb50-623"><a href="glm-1.html#cb50-623" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.2) 0</span></span>
<span id="cb50-624"><a href="glm-1.html#cb50-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-625"><a href="glm-1.html#cb50-625" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 3</span></span>
<span id="cb50-626"><a href="glm-1.html#cb50-626" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.3) 0</span></span>
<span id="cb50-627"><a href="glm-1.html#cb50-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-628"><a href="glm-1.html#cb50-628" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 4</span></span>
<span id="cb50-629"><a href="glm-1.html#cb50-629" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.4) 0</span></span>
<span id="cb50-630"><a href="glm-1.html#cb50-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-631"><a href="glm-1.html#cb50-631" aria-hidden="true" tabindex="-1"></a><span class="st"># F-test 1 element 1</span></span>
<span id="cb50-632"><a href="glm-1.html#cb50-632" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ftest_orig1.1) 0</span></span>
<span id="cb50-633"><a href="glm-1.html#cb50-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-634"><a href="glm-1.html#cb50-634" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_orig 2</span></span>
<span id="cb50-635"><a href="glm-1.html#cb50-635" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_orig.2) 1</span></span>
<span id="cb50-636"><a href="glm-1.html#cb50-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-637"><a href="glm-1.html#cb50-637" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_orig 2</span></span>
<span id="cb50-638"><a href="glm-1.html#cb50-638" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_orig.2) &quot;sine vs. 0&quot;</span></span>
<span id="cb50-639"><a href="glm-1.html#cb50-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-640"><a href="glm-1.html#cb50-640" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 2 element 1</span></span>
<span id="cb50-641"><a href="glm-1.html#cb50-641" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig2.1) 0</span></span>
<span id="cb50-642"><a href="glm-1.html#cb50-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-643"><a href="glm-1.html#cb50-643" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 2 element 2</span></span>
<span id="cb50-644"><a href="glm-1.html#cb50-644" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig2.2) 1.0</span></span>
<span id="cb50-645"><a href="glm-1.html#cb50-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-646"><a href="glm-1.html#cb50-646" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 2 element 3</span></span>
<span id="cb50-647"><a href="glm-1.html#cb50-647" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig2.3) 0</span></span>
<span id="cb50-648"><a href="glm-1.html#cb50-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-649"><a href="glm-1.html#cb50-649" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 2 element 4</span></span>
<span id="cb50-650"><a href="glm-1.html#cb50-650" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig2.4) 0</span></span>
<span id="cb50-651"><a href="glm-1.html#cb50-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-652"><a href="glm-1.html#cb50-652" aria-hidden="true" tabindex="-1"></a><span class="st"># F-test 1 element 2</span></span>
<span id="cb50-653"><a href="glm-1.html#cb50-653" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ftest_orig1.2) 1</span></span>
<span id="cb50-654"><a href="glm-1.html#cb50-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-655"><a href="glm-1.html#cb50-655" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_orig 3</span></span>
<span id="cb50-656"><a href="glm-1.html#cb50-656" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_orig.3) 1</span></span>
<span id="cb50-657"><a href="glm-1.html#cb50-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-658"><a href="glm-1.html#cb50-658" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_orig 3</span></span>
<span id="cb50-659"><a href="glm-1.html#cb50-659" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_orig.3) &quot;cosine vs. 0&quot;</span></span>
<span id="cb50-660"><a href="glm-1.html#cb50-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-661"><a href="glm-1.html#cb50-661" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 3 element 1</span></span>
<span id="cb50-662"><a href="glm-1.html#cb50-662" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig3.1) 0</span></span>
<span id="cb50-663"><a href="glm-1.html#cb50-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-664"><a href="glm-1.html#cb50-664" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 3 element 2</span></span>
<span id="cb50-665"><a href="glm-1.html#cb50-665" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig3.2) 0</span></span>
<span id="cb50-666"><a href="glm-1.html#cb50-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-667"><a href="glm-1.html#cb50-667" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 3 element 3</span></span>
<span id="cb50-668"><a href="glm-1.html#cb50-668" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig3.3) 1.0</span></span>
<span id="cb50-669"><a href="glm-1.html#cb50-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-670"><a href="glm-1.html#cb50-670" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 3 element 4</span></span>
<span id="cb50-671"><a href="glm-1.html#cb50-671" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig3.4) 0</span></span>
<span id="cb50-672"><a href="glm-1.html#cb50-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-673"><a href="glm-1.html#cb50-673" aria-hidden="true" tabindex="-1"></a><span class="st"># F-test 1 element 3</span></span>
<span id="cb50-674"><a href="glm-1.html#cb50-674" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ftest_orig1.3) 1</span></span>
<span id="cb50-675"><a href="glm-1.html#cb50-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-676"><a href="glm-1.html#cb50-676" aria-hidden="true" tabindex="-1"></a><span class="st"># Contrast masking - use &gt;0 instead of thresholding?</span></span>
<span id="cb50-677"><a href="glm-1.html#cb50-677" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask_zerothresh_yn) 0</span></span>
<span id="cb50-678"><a href="glm-1.html#cb50-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-679"><a href="glm-1.html#cb50-679" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 1 with real contrast/F-test 2?</span></span>
<span id="cb50-680"><a href="glm-1.html#cb50-680" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask1_2) 0</span></span>
<span id="cb50-681"><a href="glm-1.html#cb50-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-682"><a href="glm-1.html#cb50-682" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 1 with real contrast/F-test 3?</span></span>
<span id="cb50-683"><a href="glm-1.html#cb50-683" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask1_3) 0</span></span>
<span id="cb50-684"><a href="glm-1.html#cb50-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-685"><a href="glm-1.html#cb50-685" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 1 with real contrast/F-test 4?</span></span>
<span id="cb50-686"><a href="glm-1.html#cb50-686" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask1_4) 0</span></span>
<span id="cb50-687"><a href="glm-1.html#cb50-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-688"><a href="glm-1.html#cb50-688" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 2 with real contrast/F-test 1?</span></span>
<span id="cb50-689"><a href="glm-1.html#cb50-689" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask2_1) 0</span></span>
<span id="cb50-690"><a href="glm-1.html#cb50-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-691"><a href="glm-1.html#cb50-691" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 2 with real contrast/F-test 3?</span></span>
<span id="cb50-692"><a href="glm-1.html#cb50-692" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask2_3) 0</span></span>
<span id="cb50-693"><a href="glm-1.html#cb50-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-694"><a href="glm-1.html#cb50-694" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 2 with real contrast/F-test 4?</span></span>
<span id="cb50-695"><a href="glm-1.html#cb50-695" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask2_4) 0</span></span>
<span id="cb50-696"><a href="glm-1.html#cb50-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-697"><a href="glm-1.html#cb50-697" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 3 with real contrast/F-test 1?</span></span>
<span id="cb50-698"><a href="glm-1.html#cb50-698" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask3_1) 0</span></span>
<span id="cb50-699"><a href="glm-1.html#cb50-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-700"><a href="glm-1.html#cb50-700" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 3 with real contrast/F-test 2?</span></span>
<span id="cb50-701"><a href="glm-1.html#cb50-701" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask3_2) 0</span></span>
<span id="cb50-702"><a href="glm-1.html#cb50-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-703"><a href="glm-1.html#cb50-703" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 3 with real contrast/F-test 4?</span></span>
<span id="cb50-704"><a href="glm-1.html#cb50-704" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask3_4) 0</span></span>
<span id="cb50-705"><a href="glm-1.html#cb50-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-706"><a href="glm-1.html#cb50-706" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 4 with real contrast/F-test 1?</span></span>
<span id="cb50-707"><a href="glm-1.html#cb50-707" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask4_1) 0</span></span>
<span id="cb50-708"><a href="glm-1.html#cb50-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-709"><a href="glm-1.html#cb50-709" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 4 with real contrast/F-test 2?</span></span>
<span id="cb50-710"><a href="glm-1.html#cb50-710" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask4_2) 0</span></span>
<span id="cb50-711"><a href="glm-1.html#cb50-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-712"><a href="glm-1.html#cb50-712" aria-hidden="true" tabindex="-1"></a><span class="st"># Mask real contrast/F-test 4 with real contrast/F-test 3?</span></span>
<span id="cb50-713"><a href="glm-1.html#cb50-713" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask4_3) 0</span></span>
<span id="cb50-714"><a href="glm-1.html#cb50-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-715"><a href="glm-1.html#cb50-715" aria-hidden="true" tabindex="-1"></a><span class="st"># Do contrast masking at all?</span></span>
<span id="cb50-716"><a href="glm-1.html#cb50-716" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask1_1) 0</span></span>
<span id="cb50-717"><a href="glm-1.html#cb50-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-718"><a href="glm-1.html#cb50-718" aria-hidden="true" tabindex="-1"></a><span class="st">##########################################################</span></span>
<span id="cb50-719"><a href="glm-1.html#cb50-719" aria-hidden="true" tabindex="-1"></a><span class="st"># Now options that do not appear in the GUI</span></span>
<span id="cb50-720"><a href="glm-1.html#cb50-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-721"><a href="glm-1.html#cb50-721" aria-hidden="true" tabindex="-1"></a><span class="st"># Alternative (to BETting) mask image</span></span>
<span id="cb50-722"><a href="glm-1.html#cb50-722" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(alternative_mask) &quot;&quot;</span></span>
<span id="cb50-723"><a href="glm-1.html#cb50-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-724"><a href="glm-1.html#cb50-724" aria-hidden="true" tabindex="-1"></a><span class="st"># Initial structural space registration initialisation transform</span></span>
<span id="cb50-725"><a href="glm-1.html#cb50-725" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(init_initial_highres) &quot;&quot;</span></span>
<span id="cb50-726"><a href="glm-1.html#cb50-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-727"><a href="glm-1.html#cb50-727" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural space registration initialisation transform</span></span>
<span id="cb50-728"><a href="glm-1.html#cb50-728" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(init_highres) &quot;&quot;</span></span>
<span id="cb50-729"><a href="glm-1.html#cb50-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-730"><a href="glm-1.html#cb50-730" aria-hidden="true" tabindex="-1"></a><span class="st"># Standard space registration initialisation transform</span></span>
<span id="cb50-731"><a href="glm-1.html#cb50-731" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(init_standard) &quot;&quot;</span></span>
<span id="cb50-732"><a href="glm-1.html#cb50-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-733"><a href="glm-1.html#cb50-733" aria-hidden="true" tabindex="-1"></a><span class="st"># For full FEAT analysis: overwrite existing .feat output dir?</span></span>
<span id="cb50-734"><a href="glm-1.html#cb50-734" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(overwrite_yn) 0</span></span>
<span id="cb50-735"><a href="glm-1.html#cb50-735" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Now, we define the function that creates the fsf-file by filling the placeholders and writing to file.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="glm-1.html#cb51-1" aria-hidden="true" tabindex="-1"></a>create_fsf <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">fsf =</span> dsgn, <span class="at">placeholder =</span> <span class="fu">c</span>(<span class="st">&quot;@n_vols@&quot;</span>), <span class="at">replace_with =</span> <span class="fu">c</span>(<span class="st">&quot;666&quot;</span>), <span class="at">out_fn =</span> <span class="cn">NA</span>){</span>
<span id="cb51-2"><a href="glm-1.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  assertthat<span class="sc">::</span><span class="fu">are_equal</span>(<span class="fu">length</span>(placeholder), <span class="fu">length</span>(replace_with))</span>
<span id="cb51-3"><a href="glm-1.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-4"><a href="glm-1.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># loop over the placeholders and fill them with info</span></span>
<span id="cb51-5"><a href="glm-1.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(placeholder)){</span>
<span id="cb51-6"><a href="glm-1.html#cb51-6" aria-hidden="true" tabindex="-1"></a>    fsf <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern=</span>placeholder[i], <span class="at">replacement =</span> replace_with[i], <span class="at">x=</span>fsf)    </span>
<span id="cb51-7"><a href="glm-1.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-8"><a href="glm-1.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-9"><a href="glm-1.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># write fsf file</span></span>
<span id="cb51-10"><a href="glm-1.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  con<span class="ot">&lt;-</span><span class="fu">file</span>(out_fn)</span>
<span id="cb51-11"><a href="glm-1.html#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeLines</span>(fsf, con)</span>
<span id="cb51-12"><a href="glm-1.html#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">close</span>(con)</span>
<span id="cb51-13"><a href="glm-1.html#cb51-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, for each run and periodicity, letâs replace the placeholders with the required variables.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="glm-1.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these are the placeholders in the fsf</span></span>
<span id="cb52-2"><a href="glm-1.html#cb52-2" aria-hidden="true" tabindex="-1"></a>to_replace <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;@out_dir@&quot;</span>, </span>
<span id="cb52-3"><a href="glm-1.html#cb52-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@func_fn@&quot;</span>, </span>
<span id="cb52-4"><a href="glm-1.html#cb52-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@tr@&quot;</span>,</span>
<span id="cb52-5"><a href="glm-1.html#cb52-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@n_vols@&quot;</span>, </span>
<span id="cb52-6"><a href="glm-1.html#cb52-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@navi_ev_fn@&quot;</span>, </span>
<span id="cb52-7"><a href="glm-1.html#cb52-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@sine_ev_fn@&quot;</span>, </span>
<span id="cb52-8"><a href="glm-1.html#cb52-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@cosine_ev_fn@&quot;</span>,</span>
<span id="cb52-9"><a href="glm-1.html#cb52-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@feedback_ev_fn@&quot;</span>,</span>
<span id="cb52-10"><a href="glm-1.html#cb52-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@conf_ev_fn@&quot;</span>)</span>
<span id="cb52-11"><a href="glm-1.html#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="glm-1.html#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb52-13"><a href="glm-1.html#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb52-14"><a href="glm-1.html#cb52-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-15"><a href="glm-1.html#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># current functional data and find number of volumes in case they differ</span></span>
<span id="cb52-16"><a href="glm-1.html#cb52-16" aria-hidden="true" tabindex="-1"></a>    func_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;FunctionalScans&quot;</span>, <span class="st">&quot;4D&quot;</span>, i_sub, i_run, <span class="fu">paste0</span>(i_run, <span class="st">&quot;_masked.nii.gz&quot;</span>))</span>
<span id="cb52-17"><a href="glm-1.html#cb52-17" aria-hidden="true" tabindex="-1"></a>    hdr <span class="ot">&lt;-</span> <span class="fu">fslhd</span>(func_fn, <span class="at">verbose =</span><span class="cn">FALSE</span>)</span>
<span id="cb52-18"><a href="glm-1.html#cb52-18" aria-hidden="true" tabindex="-1"></a>    hdr <span class="ot">&lt;-</span> hdr[<span class="fu">grep</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">bdim4</span><span class="sc">\\</span><span class="st">b&quot;</span>, hdr)]</span>
<span id="cb52-19"><a href="glm-1.html#cb52-19" aria-hidden="true" tabindex="-1"></a>    n_vols <span class="ot">&lt;-</span> <span class="fu">regmatches</span>(hdr, <span class="fu">gregexpr</span>(<span class="st">&quot;[[:digit:]]+&quot;</span>, hdr))[[<span class="dv">1</span>]][<span class="dv">2</span>]</span>
<span id="cb52-20"><a href="glm-1.html#cb52-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb52-21"><a href="glm-1.html#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb52-22"><a href="glm-1.html#cb52-22" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb52-23"><a href="glm-1.html#cb52-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># folder to write the fsf-files to</span></span>
<span id="cb52-24"><a href="glm-1.html#cb52-24" aria-hidden="true" tabindex="-1"></a>      fsf_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_design&quot;</span>, </span>
<span id="cb52-25"><a href="glm-1.html#cb52-25" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run)</span>
<span id="cb52-26"><a href="glm-1.html#cb52-26" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(fsf_dir)){<span class="fu">dir.create</span>(fsf_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb52-27"><a href="glm-1.html#cb52-27" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb52-28"><a href="glm-1.html#cb52-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># collect the info we need</span></span>
<span id="cb52-29"><a href="glm-1.html#cb52-29" aria-hidden="true" tabindex="-1"></a>      fsf_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(fsf_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%dfold.fsf&quot;</span>, i_sub, i_run, i_period))</span>
<span id="cb52-30"><a href="glm-1.html#cb52-30" aria-hidden="true" tabindex="-1"></a>      out_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run)</span>
<span id="cb52-31"><a href="glm-1.html#cb52-31" aria-hidden="true" tabindex="-1"></a>      tr <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb52-32"><a href="glm-1.html#cb52-32" aria-hidden="true" tabindex="-1"></a>      navi_ev_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_ev&quot;</span>, i_sub, i_run, <span class="st">&quot;translation.txt&quot;</span>)</span>
<span id="cb52-33"><a href="glm-1.html#cb52-33" aria-hidden="true" tabindex="-1"></a>      sine_ev_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_ev&quot;</span>, i_sub, i_run,</span>
<span id="cb52-34"><a href="glm-1.html#cb52-34" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&quot;translation_sine_&quot;</span>, i_period, <span class="st">&quot;fold_half1.txt&quot;</span>))</span>
<span id="cb52-35"><a href="glm-1.html#cb52-35" aria-hidden="true" tabindex="-1"></a>      cosine_ev_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_ev&quot;</span>, i_sub, i_run, </span>
<span id="cb52-36"><a href="glm-1.html#cb52-36" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">&quot;translation_cosine_&quot;</span>, i_period, <span class="st">&quot;fold_half1.txt&quot;</span>))</span>
<span id="cb52-37"><a href="glm-1.html#cb52-37" aria-hidden="true" tabindex="-1"></a>      feedback_ev_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_ev&quot;</span>, i_sub, i_run, <span class="st">&quot;feedback.txt&quot;</span>)</span>
<span id="cb52-38"><a href="glm-1.html#cb52-38" aria-hidden="true" tabindex="-1"></a>      conf_ev_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;AdditionalRegressors&quot;</span>, i_sub, </span>
<span id="cb52-39"><a href="glm-1.html#cb52-39" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&quot;realignmentParameters_&quot;</span>, i_run ,<span class="st">&quot;.txt&quot;</span>))</span>
<span id="cb52-40"><a href="glm-1.html#cb52-40" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb52-41"><a href="glm-1.html#cb52-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># collect the filler items. CAVE: Must be in same order as to_replace</span></span>
<span id="cb52-42"><a href="glm-1.html#cb52-42" aria-hidden="true" tabindex="-1"></a>      fillers <span class="ot">&lt;-</span> <span class="fu">c</span>(out_dir, </span>
<span id="cb52-43"><a href="glm-1.html#cb52-43" aria-hidden="true" tabindex="-1"></a>                   func_fn, </span>
<span id="cb52-44"><a href="glm-1.html#cb52-44" aria-hidden="true" tabindex="-1"></a>                   tr, </span>
<span id="cb52-45"><a href="glm-1.html#cb52-45" aria-hidden="true" tabindex="-1"></a>                   n_vols, </span>
<span id="cb52-46"><a href="glm-1.html#cb52-46" aria-hidden="true" tabindex="-1"></a>                   navi_ev_fn, </span>
<span id="cb52-47"><a href="glm-1.html#cb52-47" aria-hidden="true" tabindex="-1"></a>                   sine_ev_fn, </span>
<span id="cb52-48"><a href="glm-1.html#cb52-48" aria-hidden="true" tabindex="-1"></a>                   cosine_ev_fn, </span>
<span id="cb52-49"><a href="glm-1.html#cb52-49" aria-hidden="true" tabindex="-1"></a>                   feedback_ev_fn, </span>
<span id="cb52-50"><a href="glm-1.html#cb52-50" aria-hidden="true" tabindex="-1"></a>                   conf_ev_fn)</span>
<span id="cb52-51"><a href="glm-1.html#cb52-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-52"><a href="glm-1.html#cb52-52" aria-hidden="true" tabindex="-1"></a>      <span class="co"># create the fsf file</span></span>
<span id="cb52-53"><a href="glm-1.html#cb52-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">create_fsf</span>(<span class="at">fsf =</span> dsgn, <span class="at">placeholder =</span> to_replace, <span class="at">replace_with =</span> fillers, <span class="at">out_fn =</span> fsf_fn)</span>
<span id="cb52-54"><a href="glm-1.html#cb52-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb52-55"><a href="glm-1.html#cb52-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># create GLM design files to use with film_gls</span></span>
<span id="cb52-56"><a href="glm-1.html#cb52-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/bin/feat_model %s %s&quot;</span>, </span>
<span id="cb52-57"><a href="glm-1.html#cb52-57" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">fsldir</span>(), tools<span class="sc">::</span><span class="fu">file_path_sans_ext</span>(fsf_fn), conf_ev_fn))</span>
<span id="cb52-58"><a href="glm-1.html#cb52-58" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb52-59"><a href="glm-1.html#cb52-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-60"><a href="glm-1.html#cb52-60" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="run-glm1" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Run GLM1<a href="glm-1.html#run-glm1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are ready to run GLM1. We can do so using FEAT or the bare <code>film_gls</code> command.
NB: For this to work, make sure FSL is correctly configured. On MacOS that might mean starting RStudio from the terminal (<code>open -na Rstudio</code>).</p>
<div id="feat" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> FEAT<a href="glm-1.html#feat" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We start by running GLM1 using FEAT.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="glm-1.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb53-2"><a href="glm-1.html#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb53-3"><a href="glm-1.html#cb53-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb53-4"><a href="glm-1.html#cb53-4" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb53-5"><a href="glm-1.html#cb53-5" aria-hidden="true" tabindex="-1"></a>          <span class="co"># check if the zstat of the F-contrast exists, this should be one of the last files written</span></span>
<span id="cb53-6"><a href="glm-1.html#cb53-6" aria-hidden="true" tabindex="-1"></a>          fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb53-7"><a href="glm-1.html#cb53-7" aria-hidden="true" tabindex="-1"></a>                     i_sub, <span class="fu">paste0</span>(i_run, <span class="st">&quot;.feat&quot;</span>), <span class="st">&quot;stats&quot;</span>, <span class="st">&quot;zfstat1.nii.gz&quot;</span>)</span>
<span id="cb53-8"><a href="glm-1.html#cb53-8" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(fn)){</span>
<span id="cb53-9"><a href="glm-1.html#cb53-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb53-10"><a href="glm-1.html#cb53-10" aria-hidden="true" tabindex="-1"></a>            <span class="co"># build the command and run</span></span>
<span id="cb53-11"><a href="glm-1.html#cb53-11" aria-hidden="true" tabindex="-1"></a>            fsf_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_design&quot;</span>, </span>
<span id="cb53-12"><a href="glm-1.html#cb53-12" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run,</span>
<span id="cb53-13"><a href="glm-1.html#cb53-13" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%dfold.fsf&quot;</span>, i_sub, i_run, i_period))</span>
<span id="cb53-14"><a href="glm-1.html#cb53-14" aria-hidden="true" tabindex="-1"></a>            cmd <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/bin/feat %s&quot;</span>, <span class="fu">fsldir</span>(), fsf_fn)</span>
<span id="cb53-15"><a href="glm-1.html#cb53-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">system</span>(cmd, <span class="at">intern =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-16"><a href="glm-1.html#cb53-16" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb53-17"><a href="glm-1.html#cb53-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># remove the residuals file to clear some space</span></span>
<span id="cb53-18"><a href="glm-1.html#cb53-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&quot;rm %s&quot;</span>, </span>
<span id="cb53-19"><a href="glm-1.html#cb53-19" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb53-20"><a href="glm-1.html#cb53-20" aria-hidden="true" tabindex="-1"></a>                                i_sub, <span class="fu">paste0</span>(i_run, <span class="st">&quot;.feat&quot;</span>), <span class="st">&quot;stats&quot;</span>, <span class="st">&quot;res4d.nii.gz&quot;</span>)))</span>
<span id="cb53-21"><a href="glm-1.html#cb53-21" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb53-22"><a href="glm-1.html#cb53-22" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb53-23"><a href="glm-1.html#cb53-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-24"><a href="glm-1.html#cb53-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here is the design matrix as visualized by FEAT:</p>
<div class="figure">
<img src="data/glm1/glm1_firsthalf/6fold/sub01/run02.feat/design.png" alt="" />
<p class="caption">GLM1 design matrix</p>
</div>
<p>Covariance matrix &amp; design efficiency:
<img src="data/glm1/glm1_firsthalf/6fold/sub01/run02.feat/design_cov.png" alt="GLM1 covariance matrix" /></p>
</div>
<div id="film_gls" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> FILM_GLS<a href="glm-1.html#film_gls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The command here is based on the command used by FEAT. The results should thus be identical.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="glm-1.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb54-2"><a href="glm-1.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb54-3"><a href="glm-1.html#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb54-4"><a href="glm-1.html#cb54-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb54-5"><a href="glm-1.html#cb54-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># files and folders to be used as input for film_gls</span></span>
<span id="cb54-6"><a href="glm-1.html#cb54-6" aria-hidden="true" tabindex="-1"></a>      func_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;FunctionalScans&quot;</span>, <span class="st">&quot;4D&quot;</span>, i_sub, i_run, <span class="fu">paste0</span>(i_run, <span class="st">&quot;_masked.nii.gz&quot;</span>))</span>
<span id="cb54-7"><a href="glm-1.html#cb54-7" aria-hidden="true" tabindex="-1"></a>      out_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run)</span>
<span id="cb54-8"><a href="glm-1.html#cb54-8" aria-hidden="true" tabindex="-1"></a>      pd_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_design&quot;</span>, </span>
<span id="cb54-9"><a href="glm-1.html#cb54-9" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run,</span>
<span id="cb54-10"><a href="glm-1.html#cb54-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%dfold.mat&quot;</span>, i_sub, i_run, i_period))</span>
<span id="cb54-11"><a href="glm-1.html#cb54-11" aria-hidden="true" tabindex="-1"></a>      con_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_design&quot;</span>, </span>
<span id="cb54-12"><a href="glm-1.html#cb54-12" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run,</span>
<span id="cb54-13"><a href="glm-1.html#cb54-13" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%dfold.con&quot;</span>, i_sub, i_run, i_period))</span>
<span id="cb54-14"><a href="glm-1.html#cb54-14" aria-hidden="true" tabindex="-1"></a>      fcon_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;feat_design&quot;</span>, </span>
<span id="cb54-15"><a href="glm-1.html#cb54-15" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run,</span>
<span id="cb54-16"><a href="glm-1.html#cb54-16" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%dfold.fts&quot;</span>, i_sub, i_run, i_period))</span>
<span id="cb54-17"><a href="glm-1.html#cb54-17" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb54-18"><a href="glm-1.html#cb54-18" aria-hidden="true" tabindex="-1"></a>      <span class="co"># check if the zstat of the F-contrast exists, this should be one of the last files written</span></span>
<span id="cb54-19"><a href="glm-1.html#cb54-19" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(out_dir, <span class="st">&quot;zfstat1.nii.gz&quot;</span>)</span>
<span id="cb54-20"><a href="glm-1.html#cb54-20" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(fn)){</span>
<span id="cb54-21"><a href="glm-1.html#cb54-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-22"><a href="glm-1.html#cb54-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># build the command and run</span></span>
<span id="cb54-23"><a href="glm-1.html#cb54-23" aria-hidden="true" tabindex="-1"></a>        cmd <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/bin/film_gls --in=%s --rn=%s --pd=%s --thr=61 --sa --ms=5 --con=%s --fcon=%s&quot;</span>, <span class="co"># note that you may want to change these options!</span></span>
<span id="cb54-24"><a href="glm-1.html#cb54-24" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">fsldir</span>(), func_fn, out_dir, pd_fn, con_fn, fcon_fn)</span>
<span id="cb54-25"><a href="glm-1.html#cb54-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">system</span>(cmd)</span>
<span id="cb54-26"><a href="glm-1.html#cb54-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-27"><a href="glm-1.html#cb54-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># remove the residuals file to clear some space</span></span>
<span id="cb54-28"><a href="glm-1.html#cb54-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&quot;rm %s&quot;</span>, <span class="fu">file.path</span>(out_dir, <span class="st">&quot;res4d.nii.gz&quot;</span>)))</span>
<span id="cb54-29"><a href="glm-1.html#cb54-29" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb54-30"><a href="glm-1.html#cb54-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-31"><a href="glm-1.html#cb54-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-32"><a href="glm-1.html#cb54-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="results-glm-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Results GLM 1<a href="glm-1.html#results-glm-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="compare-results-from-feat-and-film" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Compare results from FEAT and FILM<a href="glm-1.html#compare-results-from-feat-and-film" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After running the analysis using FEAT and via film_gls directly, letâs check if the results are comparable. We simply load the images with the results of the F-Test of the periodic sine and cosine regressors and correlate the F-values across voxels.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="glm-1.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb55-2"><a href="glm-1.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb55-3"><a href="glm-1.html#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb55-4"><a href="glm-1.html#cb55-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-5"><a href="glm-1.html#cb55-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># load  the F-Stat images</span></span>
<span id="cb55-6"><a href="glm-1.html#cb55-6" aria-hidden="true" tabindex="-1"></a>      fn1 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb55-7"><a href="glm-1.html#cb55-7" aria-hidden="true" tabindex="-1"></a>                 i_sub, <span class="fu">paste0</span>(i_run, <span class="st">&quot;.feat&quot;</span>), <span class="st">&quot;stats&quot;</span>, <span class="st">&quot;fstat1.nii.gz&quot;</span>)</span>
<span id="cb55-8"><a href="glm-1.html#cb55-8" aria-hidden="true" tabindex="-1"></a>      fn2 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb55-9"><a href="glm-1.html#cb55-9" aria-hidden="true" tabindex="-1"></a>                 i_sub, i_run, <span class="st">&quot;fstat1.nii.gz&quot;</span>)</span>
<span id="cb55-10"><a href="glm-1.html#cb55-10" aria-hidden="true" tabindex="-1"></a>      feat_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn1)</span>
<span id="cb55-11"><a href="glm-1.html#cb55-11" aria-hidden="true" tabindex="-1"></a>      film_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn2)</span>
<span id="cb55-12"><a href="glm-1.html#cb55-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-13"><a href="glm-1.html#cb55-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># store in data frame</span></span>
<span id="cb55-14"><a href="glm-1.html#cb55-14" aria-hidden="true" tabindex="-1"></a>      stat_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">feat =</span> <span class="fu">c</span>(feat_nii), <span class="at">film =</span> <span class="fu">c</span>(film_nii))</span>
<span id="cb55-15"><a href="glm-1.html#cb55-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-16"><a href="glm-1.html#cb55-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># diagnostic plot</span></span>
<span id="cb55-17"><a href="glm-1.html#cb55-17" aria-hidden="true" tabindex="-1"></a>      p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stat_df, <span class="fu">aes</span>(<span class="at">x=</span>feat, <span class="at">y=</span>film)) <span class="sc">+</span></span>
<span id="cb55-18"><a href="glm-1.html#cb55-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-19"><a href="glm-1.html#cb55-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb55-20"><a href="glm-1.html#cb55-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb55-21"><a href="glm-1.html#cb55-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;F-Statistics from FEAT and FILM&quot;</span>,</span>
<span id="cb55-22"><a href="glm-1.html#cb55-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s, %s, %d-fold: r=%.3f&quot;</span>, </span>
<span id="cb55-23"><a href="glm-1.html#cb55-23" aria-hidden="true" tabindex="-1"></a>                                i_sub, i_run, i_period, <span class="fu">cor</span>(stat_df<span class="sc">$</span>feat, stat_df<span class="sc">$</span>film)))</span>
<span id="cb55-24"><a href="glm-1.html#cb55-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(p1)</span>
<span id="cb55-25"><a href="glm-1.html#cb55-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-26"><a href="glm-1.html#cb55-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-27"><a href="glm-1.html#cb55-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Hexadirectioal-analysis-pipeline_files/figure-html/glm1_compare_film_feat-1.png" width="672" /><img src="Hexadirectioal-analysis-pipeline_files/figure-html/glm1_compare_film_feat-2.png" width="672" /></p>
</div>
<div id="f-test-results" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> F-Test results<a href="glm-1.html#f-test-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, we can plot the F-Test results onto the brain. This F-test is not unbiased, but is often used prominently in papers (c.f. Constantinescu et al., Science, 2016; Bongioanni et al., Nature, 2021). It is not the cross-validated (i.e.Â tested on an independent data partition), but Bongioanni et al.Â (Nature, 2021) developed a permutation-based test to use it for significance testing. Using the F-Test on periodic sine and cosine regressors fitted to the entire dataset might be the most powerful approach to demonstrate a hexadirectional signal.</p>
<p>The plots below are arbitrarily thresholded at F &gt; 2.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="glm-1.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb56-2"><a href="glm-1.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb56-3"><a href="glm-1.html#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb56-4"><a href="glm-1.html#cb56-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb56-5"><a href="glm-1.html#cb56-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># load  the mean functional and F-Stat image</span></span>
<span id="cb56-6"><a href="glm-1.html#cb56-6" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb56-7"><a href="glm-1.html#cb56-7" aria-hidden="true" tabindex="-1"></a>                 i_sub, <span class="fu">paste0</span>(i_run, <span class="st">&quot;.feat&quot;</span>), <span class="st">&quot;mean_func.nii.gz&quot;</span>)</span>
<span id="cb56-8"><a href="glm-1.html#cb56-8" aria-hidden="true" tabindex="-1"></a>      mean_func_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn)</span>
<span id="cb56-9"><a href="glm-1.html#cb56-9" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb56-10"><a href="glm-1.html#cb56-10" aria-hidden="true" tabindex="-1"></a>                 i_sub, i_run, <span class="st">&quot;fstat1.nii.gz&quot;</span>)</span>
<span id="cb56-11"><a href="glm-1.html#cb56-11" aria-hidden="true" tabindex="-1"></a>      f_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn)</span>
<span id="cb56-12"><a href="glm-1.html#cb56-12" aria-hidden="true" tabindex="-1"></a>      f_nii[f_nii <span class="sc">&lt;</span> <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb56-13"><a href="glm-1.html#cb56-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb56-14"><a href="glm-1.html#cb56-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># overlay F-test on mean func</span></span>
<span id="cb56-15"><a href="glm-1.html#cb56-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ortho2</span>(mean_func_nii, f_nii, <span class="at">xyz =</span> <span class="fu">c</span>(<span class="dv">46</span>,<span class="dv">46</span>,<span class="dv">15</span>),</span>
<span id="cb56-16"><a href="glm-1.html#cb56-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">ycolorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-17"><a href="glm-1.html#cb56-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.y =</span> oro.nifti<span class="sc">::</span><span class="fu">hotmetal</span>(<span class="dv">10</span>), </span>
<span id="cb56-18"><a href="glm-1.html#cb56-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ybreaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="fl">0.5</span>))</span>
<span id="cb56-19"><a href="glm-1.html#cb56-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-20"><a href="glm-1.html#cb56-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-21"><a href="glm-1.html#cb56-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Hexadirectioal-analysis-pipeline_files/figure-html/glm1_brainplot_ftest-1.png" width="672" /><img src="Hexadirectioal-analysis-pipeline_files/figure-html/glm1_brainplot_ftest-2.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="example-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="estimate-orientation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
