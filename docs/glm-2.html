<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 GLM 2 | Detecting Hexadirectional Signals in the Human Brain using R and FSL</title>
  <meta name="description" content="5 GLM 2 | Detecting Hexadirectional Signals in the Human Brain using R and FSL" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="5 GLM 2 | Detecting Hexadirectional Signals in the Human Brain using R and FSL" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 GLM 2 | Detecting Hexadirectional Signals in the Human Brain using R and FSL" />
  
  
  

<meta name="author" content="Jacob Bellmund" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimate-orientation.html"/>
<link rel="next" href="credit.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#requirements"><i class="fa fa-check"></i><b>1.1</b> Requirements</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#workflow"><i class="fa fa-check"></i><b>1.2</b> Workflow</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#cbs-imac-or-macbook"><i class="fa fa-check"></i><b>1.2.1</b> CBS iMac or Macbook</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#remote-linux"><i class="fa fa-check"></i><b>1.2.2</b> Remote Linux</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#running-the-analysis"><i class="fa fa-check"></i><b>1.2.3</b> Running the analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#required-packages"><i class="fa fa-check"></i><b>1.3</b> Required packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-data.html"><a href="example-data.html"><i class="fa fa-check"></i><b>2</b> Example Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="example-data.html"><a href="example-data.html#download-example-data"><i class="fa fa-check"></i><b>2.1</b> Download Example Data</a></li>
<li class="chapter" data-level="2.2" data-path="example-data.html"><a href="example-data.html#rearrange-data"><i class="fa fa-check"></i><b>2.2</b> Rearrange data</a></li>
<li class="chapter" data-level="2.3" data-path="example-data.html"><a href="example-data.html#event-tables"><i class="fa fa-check"></i><b>2.3</b> Event Tables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="example-data.html"><a href="example-data.html#trajectory-duration"><i class="fa fa-check"></i><b>2.3.1</b> Trajectory duration</a></li>
<li class="chapter" data-level="2.3.2" data-path="example-data.html"><a href="example-data.html#angular-sampling"><i class="fa fa-check"></i><b>2.3.2</b> Angular Sampling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="example-data.html"><a href="example-data.html#fmri"><i class="fa fa-check"></i><b>2.4</b> fMRI</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="example-data.html"><a href="example-data.html#merge-images-of-each-run"><i class="fa fa-check"></i><b>2.4.1</b> Merge images of each run</a></li>
<li class="chapter" data-level="2.4.2" data-path="example-data.html"><a href="example-data.html#calculate-tsnr"><i class="fa fa-check"></i><b>2.4.2</b> Calculate tSNR</a></li>
<li class="chapter" data-level="2.4.3" data-path="example-data.html"><a href="example-data.html#create-quick-brain-mask"><i class="fa fa-check"></i><b>2.4.3</b> Create quick brain mask</a></li>
<li class="chapter" data-level="2.4.4" data-path="example-data.html"><a href="example-data.html#mask-4d-functionals"><i class="fa fa-check"></i><b>2.4.4</b> Mask 4D functionals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="glm-1.html"><a href="glm-1.html"><i class="fa fa-check"></i><b>3</b> GLM 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="glm-1.html"><a href="glm-1.html#first-half-of-each-run"><i class="fa fa-check"></i><b>3.1</b> First half of each run</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="glm-1.html"><a href="glm-1.html#ev-files-for-feat"><i class="fa fa-check"></i><b>3.1.1</b> EV files for FEAT</a></li>
<li class="chapter" data-level="3.1.2" data-path="glm-1.html"><a href="glm-1.html#set-up-the-glm-using-fsl-feat"><i class="fa fa-check"></i><b>3.1.2</b> Set up the GLM using FSL FEAT</a></li>
<li class="chapter" data-level="3.1.3" data-path="glm-1.html"><a href="glm-1.html#run-glm1"><i class="fa fa-check"></i><b>3.1.3</b> Run GLM1</a></li>
<li class="chapter" data-level="3.1.4" data-path="glm-1.html"><a href="glm-1.html#results-glm-1"><i class="fa fa-check"></i><b>3.1.4</b> Results GLM 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estimate-orientation.html"><a href="estimate-orientation.html"><i class="fa fa-check"></i><b>4</b> Estimate orientation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="estimate-orientation.html"><a href="estimate-orientation.html#load-pes-of-parametric-modulators"><i class="fa fa-check"></i><b>4.1</b> Load PEs of parametric modulators</a></li>
<li class="chapter" data-level="4.2" data-path="estimate-orientation.html"><a href="estimate-orientation.html#compute-voxelwise-orientation"><i class="fa fa-check"></i><b>4.2</b> Compute Voxelwise Orientation</a></li>
<li class="chapter" data-level="4.3" data-path="estimate-orientation.html"><a href="estimate-orientation.html#average-grid-orientations"><i class="fa fa-check"></i><b>4.3</b> Average grid orientations</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="estimate-orientation.html"><a href="estimate-orientation.html#wholebrain-average-orientation"><i class="fa fa-check"></i><b>4.3.1</b> Wholebrain average orientation</a></li>
<li class="chapter" data-level="4.3.2" data-path="estimate-orientation.html"><a href="estimate-orientation.html#entorhinal-cortex-average-orientation"><i class="fa fa-check"></i><b>4.3.2</b> Entorhinal Cortex average orientation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="estimate-orientation.html"><a href="estimate-orientation.html#brain-plot-of-estimated-orientations"><i class="fa fa-check"></i><b>4.4</b> Brain plot of estimated orientations</a></li>
<li class="chapter" data-level="4.5" data-path="estimate-orientation.html"><a href="estimate-orientation.html#store-estimated-grid-orientation"><i class="fa fa-check"></i><b>4.5</b> Store estimated grid orientation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="glm-2.html"><a href="glm-2.html"><i class="fa fa-check"></i><b>5</b> GLM 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="glm-2.html"><a href="glm-2.html#second-half-of-each-run"><i class="fa fa-check"></i><b>5.1</b> Second half of each run</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="glm-2.html"><a href="glm-2.html#parametric-modulation-with-cosine-regressor"><i class="fa fa-check"></i><b>5.1.1</b> Parametric modulation with cosine regressor</a></li>
<li class="chapter" data-level="5.1.2" data-path="glm-2.html"><a href="glm-2.html#set-up-the-glm-using-fsl-feat-1"><i class="fa fa-check"></i><b>5.1.2</b> Set up the GLM using FSL FEAT</a></li>
<li class="chapter" data-level="5.1.3" data-path="glm-2.html"><a href="glm-2.html#run-glm2"><i class="fa fa-check"></i><b>5.1.3</b> Run GLM2</a></li>
<li class="chapter" data-level="5.1.4" data-path="glm-2.html"><a href="glm-2.html#glm-2-results"><i class="fa fa-check"></i><b>5.1.4</b> GLM 2 results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="credit.html"><a href="credit.html"><i class="fa fa-check"></i><b>6</b> Credit</a>
<ul>
<li class="chapter" data-level="6.1" data-path="credit.html"><a href="credit.html#gridcat"><i class="fa fa-check"></i><b>6.1</b> GridCAT</a></li>
<li class="chapter" data-level="6.2" data-path="credit.html"><a href="credit.html#hosting-on-gitpages"><i class="fa fa-check"></i><b>6.2</b> Hosting on GitPages</a></li>
<li class="chapter" data-level="6.3" data-path="credit.html"><a href="credit.html#publishing-on-github-pages"><i class="fa fa-check"></i><b>6.3</b> Publishing on GitHub Pages</a></li>
<li class="chapter" data-level="6.4" data-path="credit.html"><a href="credit.html#list-of-r-packages"><i class="fa fa-check"></i><b>6.4</b> List of R packages</a></li>
<li class="chapter" data-level="6.5" data-path="credit.html"><a href="credit.html#session-info"><i class="fa fa-check"></i><b>6.5</b> Session Info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Detecting Hexadirectional Signals in the Human Brain using R and FSL</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="glm-2" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> GLM 2<a href="glm-2.html#glm-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>GLM 2 aims to quantify responses to navigation events as function of angular difference of the running direction to the orientation estimated based on GLM 1. This can be done using different ways.
For now, we will implement the parametric modulation and the aligned vs. misaligned approach.</p>
<p>Let’s start by loading the estimated orientation to use as reference</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="glm-2.html#cb43-1" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm1&quot;</span>, <span class="st">&quot;glm1_firsthalf&quot;</span>, <span class="st">&quot;avg_orient_ec.txt&quot;</span>)</span>
<span id="cb43-2"><a href="glm-2.html#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="glm-2.html#cb43-3" aria-hidden="true" tabindex="-1"></a>ref_orient <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, </span>
<span id="cb43-4"><a href="glm-2.html#cb43-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_names =</span> <span class="cn">TRUE</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;fffdddf&quot;</span>))</span>
<span id="cb43-5"><a href="glm-2.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ref_orient)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 7
##   subID run     periodicity     r avg_ori_deg avg_ori_rad weighted
##   &lt;fct&gt; &lt;fct&gt;   &lt;fct&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;   
## 1 sub01 average 6           0.220        29.3       0.512 weighted</code></pre>
<div id="second-half-of-each-run" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Second half of each run<a href="glm-2.html#second-half-of-each-run" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We need to run GLM 2 on a data partition that is independent from the one used to estimate GLM 1. In this example case, this is the second half of each run.</p>
<div id="parametric-modulation-with-cosine-regressor" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Parametric modulation with cosine regressor<a href="glm-2.html#parametric-modulation-with-cosine-regressor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="ev-files-for-feat-1" class="section level4 hasAnchor" number="5.1.1.1">
<h4><span class="header-section-number">5.1.1.1</span> EV files for FEAT<a href="glm-2.html#ev-files-for-feat-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For each regressor, FSL FEAT expects an EV file with 3-column format for each regressor. Let’s load the modified event file and write out the regressors we will want to use. For the parametric modulation approach these are:</p>
<ul>
<li>navigation EV for all timepoints of translational movement in the entire run</li>
<li>feedback EV modulating times participants received feedback (entire run)</li>
<li>Cosine of the angular difference between movement direction and estimated orientation to be used as a parametric modulator for the second half of onsets of the navigation EV. To look at an n-fold periodic signal, the angular difference between estimated orientation and the trajectory angle is multiplied by the desired periodicity (e.g. 6 for hexadirectional analysis) before calculating the cosine.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="glm-2.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we want to look for six-fold signals, other periodicities are controls</span></span>
<span id="cb45-2"><a href="glm-2.html#cb45-2" aria-hidden="true" tabindex="-1"></a>periodicities <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>)</span>
<span id="cb45-3"><a href="glm-2.html#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="glm-2.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb45-5"><a href="glm-2.html#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){</span>
<span id="cb45-6"><a href="glm-2.html#cb45-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-7"><a href="glm-2.html#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create directory for EV files</span></span>
<span id="cb45-8"><a href="glm-2.html#cb45-8" aria-hidden="true" tabindex="-1"></a>    ev_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="st">&quot;feat_ev&quot;</span>, i_sub, i_run)</span>
<span id="cb45-9"><a href="glm-2.html#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(ev_dir)){<span class="fu">dir.create</span>(ev_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb45-10"><a href="glm-2.html#cb45-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-11"><a href="glm-2.html#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># read the event table file</span></span>
<span id="cb45-12"><a href="glm-2.html#cb45-12" aria-hidden="true" tabindex="-1"></a>    fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;EventTables&quot;</span>, i_sub, <span class="fu">paste0</span>(<span class="st">&quot;eventTable_&quot;</span>, i_run, <span class="st">&quot;_jb.txt&quot;</span>))</span>
<span id="cb45-13"><a href="glm-2.html#cb45-13" aria-hidden="true" tabindex="-1"></a>    event_table <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;fddd&quot;</span>))</span>
<span id="cb45-14"><a href="glm-2.html#cb45-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-15"><a href="glm-2.html#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># write the navigation (translation) regressor to file in 3-column format for FSL</span></span>
<span id="cb45-16"><a href="glm-2.html#cb45-16" aria-hidden="true" tabindex="-1"></a>    fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ev_dir, <span class="st">&quot;translation.txt&quot;</span>)</span>
<span id="cb45-17"><a href="glm-2.html#cb45-17" aria-hidden="true" tabindex="-1"></a>    event_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">&quot;translation&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-18"><a href="glm-2.html#cb45-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">c</span>(onset, duration)) <span class="sc">%&gt;%</span></span>
<span id="cb45-19"><a href="glm-2.html#cb45-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">weight=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-20"><a href="glm-2.html#cb45-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">write_delim</span>(<span class="at">file =</span> fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-21"><a href="glm-2.html#cb45-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-22"><a href="glm-2.html#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># write the feedback regressor to file in 3-column format for FSL</span></span>
<span id="cb45-23"><a href="glm-2.html#cb45-23" aria-hidden="true" tabindex="-1"></a>    fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ev_dir, <span class="st">&quot;feedback.txt&quot;</span>)</span>
<span id="cb45-24"><a href="glm-2.html#cb45-24" aria-hidden="true" tabindex="-1"></a>    event_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">&quot;feedback&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-25"><a href="glm-2.html#cb45-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">c</span>(onset, duration)) <span class="sc">%&gt;%</span></span>
<span id="cb45-26"><a href="glm-2.html#cb45-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">weight=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-27"><a href="glm-2.html#cb45-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">write_delim</span>(<span class="at">file =</span> fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-28"><a href="glm-2.html#cb45-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-29"><a href="glm-2.html#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb45-30"><a href="glm-2.html#cb45-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-31"><a href="glm-2.html#cb45-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># get the relevant reference orientation</span></span>
<span id="cb45-32"><a href="glm-2.html#cb45-32" aria-hidden="true" tabindex="-1"></a>      curr_ref_orient <span class="ot">&lt;-</span> ref_orient <span class="sc">%&gt;%</span></span>
<span id="cb45-33"><a href="glm-2.html#cb45-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(subID<span class="sc">==</span>i_sub, periodicity<span class="sc">==</span>i_period) <span class="sc">%&gt;%</span></span>
<span id="cb45-34"><a href="glm-2.html#cb45-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pull</span>(avg_ori_deg)</span>
<span id="cb45-35"><a href="glm-2.html#cb45-35" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb45-36"><a href="glm-2.html#cb45-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add cosine of angular difference of running angle and reference orientation</span></span>
<span id="cb45-37"><a href="glm-2.html#cb45-37" aria-hidden="true" tabindex="-1"></a>      event_table <span class="ot">&lt;-</span> event_table <span class="sc">%&gt;%</span></span>
<span id="cb45-38"><a href="glm-2.html#cb45-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb45-39"><a href="glm-2.html#cb45-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">ref_orient =</span> curr_ref_orient,</span>
<span id="cb45-40"><a href="glm-2.html#cb45-40" aria-hidden="true" tabindex="-1"></a>          <span class="co"># angular difference of running direction and reference orientation (max 180 degrees)</span></span>
<span id="cb45-41"><a href="glm-2.html#cb45-41" aria-hidden="true" tabindex="-1"></a>          <span class="at">ang_diff2ref =</span> <span class="fu">if_else</span>(angle <span class="sc">-</span> curr_ref_orient <span class="sc">&lt;</span> <span class="dv">180</span>, <span class="co"># condition</span></span>
<span id="cb45-42"><a href="glm-2.html#cb45-42" aria-hidden="true" tabindex="-1"></a>                                 angle <span class="sc">-</span> curr_ref_orient, <span class="co"># if condition met</span></span>
<span id="cb45-43"><a href="glm-2.html#cb45-43" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">360</span> <span class="sc">-</span> (angle <span class="sc">-</span> curr_ref_orient)), <span class="co"># if condition not met</span></span>
<span id="cb45-44"><a href="glm-2.html#cb45-44" aria-hidden="true" tabindex="-1"></a>          <span class="co"># CAVE: transform angles to radians before calculating cosine!</span></span>
<span id="cb45-45"><a href="glm-2.html#cb45-45" aria-hidden="true" tabindex="-1"></a>          <span class="at">cosine =</span> <span class="fu">cos</span>(i_period <span class="sc">*</span> (ang_diff2ref<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>)))</span>
<span id="cb45-46"><a href="glm-2.html#cb45-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">head</span>(event_table, <span class="at">n=</span><span class="dv">10</span>)</span>
<span id="cb45-47"><a href="glm-2.html#cb45-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb45-48"><a href="glm-2.html#cb45-48" aria-hidden="true" tabindex="-1"></a>      <span class="co"># write the cosine of translation angle regressor to file in 3-column format for 2nd half of trials</span></span>
<span id="cb45-49"><a href="glm-2.html#cb45-49" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ev_dir, <span class="fu">paste0</span>(<span class="st">&quot;translation_cosine_&quot;</span>, i_period, <span class="st">&quot;fold_half2.txt&quot;</span>))</span>
<span id="cb45-50"><a href="glm-2.html#cb45-50" aria-hidden="true" tabindex="-1"></a>      event_table <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">&quot;translation&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-51"><a href="glm-2.html#cb45-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">slice_tail</span>(<span class="at">n=</span><span class="fu">round</span>(<span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="co"># second half (round up for uneven numbers)</span></span>
<span id="cb45-52"><a href="glm-2.html#cb45-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">c</span>(onset, duration, cosine)) <span class="sc">%&gt;%</span></span>
<span id="cb45-53"><a href="glm-2.html#cb45-53" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_delim</span>(<span class="at">file =</span> fn, <span class="at">delim =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-54"><a href="glm-2.html#cb45-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-55"><a href="glm-2.html#cb45-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-56"><a href="glm-2.html#cb45-56" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="set-up-the-glm-using-fsl-feat-1" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Set up the GLM using FSL FEAT<a href="glm-2.html#set-up-the-glm-using-fsl-feat-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The text below is based on clicking through the FEAT GUI for one run and copying the content of the resulting fsf-file to the chunk below. In this text, we replace lines/variables that need to be altered for each subject with a placeholder. These can then easily be filled in for each run of each subject. The chunk below could be shortened by removing the lines that are irrelevant for GLM 1, e.g. preprocessing, which is not carried out here.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="glm-2.html#cb46-1" aria-hidden="true" tabindex="-1"></a>dsgn <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb46-2"><a href="glm-2.html#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="glm-2.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="st"># FEAT version number</span></span>
<span id="cb46-4"><a href="glm-2.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(version) 6.00</span></span>
<span id="cb46-5"><a href="glm-2.html#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="glm-2.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="st"># Are we in MELODIC?</span></span>
<span id="cb46-7"><a href="glm-2.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(inmelodic) 0</span></span>
<span id="cb46-8"><a href="glm-2.html#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="glm-2.html#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="st"># Analysis level</span></span>
<span id="cb46-10"><a href="glm-2.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : First-level analysis</span></span>
<span id="cb46-11"><a href="glm-2.html#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Higher-level analysis</span></span>
<span id="cb46-12"><a href="glm-2.html#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(level) 1</span></span>
<span id="cb46-13"><a href="glm-2.html#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="glm-2.html#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="st"># Which stages to run</span></span>
<span id="cb46-15"><a href="glm-2.html#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : No first-level analysis (registration and/or group stats only)</span></span>
<span id="cb46-16"><a href="glm-2.html#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="st"># 7 : Full first-level analysis</span></span>
<span id="cb46-17"><a href="glm-2.html#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Pre-processing</span></span>
<span id="cb46-18"><a href="glm-2.html#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Statistics</span></span>
<span id="cb46-19"><a href="glm-2.html#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(analysis) 2</span></span>
<span id="cb46-20"><a href="glm-2.html#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="glm-2.html#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="st"># Use relative filenames</span></span>
<span id="cb46-22"><a href="glm-2.html#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(relative_yn) 0</span></span>
<span id="cb46-23"><a href="glm-2.html#cb46-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-24"><a href="glm-2.html#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="st"># Balloon help</span></span>
<span id="cb46-25"><a href="glm-2.html#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(help_yn) 1</span></span>
<span id="cb46-26"><a href="glm-2.html#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="glm-2.html#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="st"># Run Featwatcher</span></span>
<span id="cb46-28"><a href="glm-2.html#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(featwatcher_yn) 1</span></span>
<span id="cb46-29"><a href="glm-2.html#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="glm-2.html#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="st"># Cleanup first-level standard-space images</span></span>
<span id="cb46-31"><a href="glm-2.html#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(sscleanup_yn) 0</span></span>
<span id="cb46-32"><a href="glm-2.html#cb46-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-33"><a href="glm-2.html#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="st"># Output directory</span></span>
<span id="cb46-34"><a href="glm-2.html#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(outputdir) &quot;@out_dir@&quot;</span></span>
<span id="cb46-35"><a href="glm-2.html#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="glm-2.html#cb46-36" aria-hidden="true" tabindex="-1"></a><span class="st"># TR(s)</span></span>
<span id="cb46-37"><a href="glm-2.html#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tr) @tr@ </span></span>
<span id="cb46-38"><a href="glm-2.html#cb46-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-39"><a href="glm-2.html#cb46-39" aria-hidden="true" tabindex="-1"></a><span class="st"># Total volumes</span></span>
<span id="cb46-40"><a href="glm-2.html#cb46-40" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(npts) @n_vols@</span></span>
<span id="cb46-41"><a href="glm-2.html#cb46-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="glm-2.html#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="st"># Delete volumes</span></span>
<span id="cb46-43"><a href="glm-2.html#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ndelete) 0</span></span>
<span id="cb46-44"><a href="glm-2.html#cb46-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-45"><a href="glm-2.html#cb46-45" aria-hidden="true" tabindex="-1"></a><span class="st"># Perfusion tag/control order</span></span>
<span id="cb46-46"><a href="glm-2.html#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tagfirst) 1</span></span>
<span id="cb46-47"><a href="glm-2.html#cb46-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-48"><a href="glm-2.html#cb46-48" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of first-level analyses</span></span>
<span id="cb46-49"><a href="glm-2.html#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(multiple) 1</span></span>
<span id="cb46-50"><a href="glm-2.html#cb46-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-51"><a href="glm-2.html#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="st"># Higher-level input type</span></span>
<span id="cb46-52"><a href="glm-2.html#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Inputs are lower-level FEAT directories</span></span>
<span id="cb46-53"><a href="glm-2.html#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Inputs are cope images from FEAT directories</span></span>
<span id="cb46-54"><a href="glm-2.html#cb46-54" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(inputtype) 2</span></span>
<span id="cb46-55"><a href="glm-2.html#cb46-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-56"><a href="glm-2.html#cb46-56" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out pre-stats processing?</span></span>
<span id="cb46-57"><a href="glm-2.html#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(filtering_yn) 0</span></span>
<span id="cb46-58"><a href="glm-2.html#cb46-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-59"><a href="glm-2.html#cb46-59" aria-hidden="true" tabindex="-1"></a><span class="st"># Brain/background threshold, %</span></span>
<span id="cb46-60"><a href="glm-2.html#cb46-60" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(brain_thresh) 10</span></span>
<span id="cb46-61"><a href="glm-2.html#cb46-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-62"><a href="glm-2.html#cb46-62" aria-hidden="true" tabindex="-1"></a><span class="st"># Critical z for design efficiency calculation</span></span>
<span id="cb46-63"><a href="glm-2.html#cb46-63" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(critical_z) 5.3</span></span>
<span id="cb46-64"><a href="glm-2.html#cb46-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-65"><a href="glm-2.html#cb46-65" aria-hidden="true" tabindex="-1"></a><span class="st"># Noise level</span></span>
<span id="cb46-66"><a href="glm-2.html#cb46-66" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(noise) 0.66</span></span>
<span id="cb46-67"><a href="glm-2.html#cb46-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-68"><a href="glm-2.html#cb46-68" aria-hidden="true" tabindex="-1"></a><span class="st"># Noise AR(1)</span></span>
<span id="cb46-69"><a href="glm-2.html#cb46-69" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(noisear) 0.34</span></span>
<span id="cb46-70"><a href="glm-2.html#cb46-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-71"><a href="glm-2.html#cb46-71" aria-hidden="true" tabindex="-1"></a><span class="st"># Motion correction</span></span>
<span id="cb46-72"><a href="glm-2.html#cb46-72" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb46-73"><a href="glm-2.html#cb46-73" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : MCFLIRT</span></span>
<span id="cb46-74"><a href="glm-2.html#cb46-74" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(mc) 1</span></span>
<span id="cb46-75"><a href="glm-2.html#cb46-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-76"><a href="glm-2.html#cb46-76" aria-hidden="true" tabindex="-1"></a><span class="st"># Spin-history (currently obsolete)</span></span>
<span id="cb46-77"><a href="glm-2.html#cb46-77" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(sh_yn) 0</span></span>
<span id="cb46-78"><a href="glm-2.html#cb46-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-79"><a href="glm-2.html#cb46-79" aria-hidden="true" tabindex="-1"></a><span class="st"># B0 fieldmap unwarping?</span></span>
<span id="cb46-80"><a href="glm-2.html#cb46-80" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regunwarp_yn) 0</span></span>
<span id="cb46-81"><a href="glm-2.html#cb46-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-82"><a href="glm-2.html#cb46-82" aria-hidden="true" tabindex="-1"></a><span class="st"># GDC Test</span></span>
<span id="cb46-83"><a href="glm-2.html#cb46-83" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gdc) &quot;&quot;</span></span>
<span id="cb46-84"><a href="glm-2.html#cb46-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-85"><a href="glm-2.html#cb46-85" aria-hidden="true" tabindex="-1"></a><span class="st"># EPI dwell time (ms)</span></span>
<span id="cb46-86"><a href="glm-2.html#cb46-86" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(dwell) 0.7</span></span>
<span id="cb46-87"><a href="glm-2.html#cb46-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-88"><a href="glm-2.html#cb46-88" aria-hidden="true" tabindex="-1"></a><span class="st"># EPI TE (ms)</span></span>
<span id="cb46-89"><a href="glm-2.html#cb46-89" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(te) 35</span></span>
<span id="cb46-90"><a href="glm-2.html#cb46-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-91"><a href="glm-2.html#cb46-91" aria-hidden="true" tabindex="-1"></a><span class="st"># % Signal loss threshold</span></span>
<span id="cb46-92"><a href="glm-2.html#cb46-92" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(signallossthresh) 10</span></span>
<span id="cb46-93"><a href="glm-2.html#cb46-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-94"><a href="glm-2.html#cb46-94" aria-hidden="true" tabindex="-1"></a><span class="st"># Unwarp direction</span></span>
<span id="cb46-95"><a href="glm-2.html#cb46-95" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(unwarp_dir) y-</span></span>
<span id="cb46-96"><a href="glm-2.html#cb46-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-97"><a href="glm-2.html#cb46-97" aria-hidden="true" tabindex="-1"></a><span class="st"># Slice timing correction</span></span>
<span id="cb46-98"><a href="glm-2.html#cb46-98" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb46-99"><a href="glm-2.html#cb46-99" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Regular up (0, 1, 2, 3, ...)</span></span>
<span id="cb46-100"><a href="glm-2.html#cb46-100" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Regular down</span></span>
<span id="cb46-101"><a href="glm-2.html#cb46-101" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Use slice order file</span></span>
<span id="cb46-102"><a href="glm-2.html#cb46-102" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Use slice timings file</span></span>
<span id="cb46-103"><a href="glm-2.html#cb46-103" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Interleaved (0, 2, 4 ... 1, 3, 5 ... )</span></span>
<span id="cb46-104"><a href="glm-2.html#cb46-104" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(st) 0</span></span>
<span id="cb46-105"><a href="glm-2.html#cb46-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-106"><a href="glm-2.html#cb46-106" aria-hidden="true" tabindex="-1"></a><span class="st"># Slice timings file</span></span>
<span id="cb46-107"><a href="glm-2.html#cb46-107" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(st_file) &quot;&quot;</span></span>
<span id="cb46-108"><a href="glm-2.html#cb46-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-109"><a href="glm-2.html#cb46-109" aria-hidden="true" tabindex="-1"></a><span class="st"># BET brain extraction</span></span>
<span id="cb46-110"><a href="glm-2.html#cb46-110" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(bet_yn) 1</span></span>
<span id="cb46-111"><a href="glm-2.html#cb46-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-112"><a href="glm-2.html#cb46-112" aria-hidden="true" tabindex="-1"></a><span class="st"># Spatial smoothing FWHM (mm)</span></span>
<span id="cb46-113"><a href="glm-2.html#cb46-113" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(smooth) 5</span></span>
<span id="cb46-114"><a href="glm-2.html#cb46-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-115"><a href="glm-2.html#cb46-115" aria-hidden="true" tabindex="-1"></a><span class="st"># Intensity normalization</span></span>
<span id="cb46-116"><a href="glm-2.html#cb46-116" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(norm_yn) 0</span></span>
<span id="cb46-117"><a href="glm-2.html#cb46-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-118"><a href="glm-2.html#cb46-118" aria-hidden="true" tabindex="-1"></a><span class="st"># Perfusion subtraction</span></span>
<span id="cb46-119"><a href="glm-2.html#cb46-119" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(perfsub_yn) 0</span></span>
<span id="cb46-120"><a href="glm-2.html#cb46-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-121"><a href="glm-2.html#cb46-121" aria-hidden="true" tabindex="-1"></a><span class="st"># Highpass temporal filtering</span></span>
<span id="cb46-122"><a href="glm-2.html#cb46-122" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(temphp_yn) 1</span></span>
<span id="cb46-123"><a href="glm-2.html#cb46-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-124"><a href="glm-2.html#cb46-124" aria-hidden="true" tabindex="-1"></a><span class="st"># Lowpass temporal filtering</span></span>
<span id="cb46-125"><a href="glm-2.html#cb46-125" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(templp_yn) 0</span></span>
<span id="cb46-126"><a href="glm-2.html#cb46-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-127"><a href="glm-2.html#cb46-127" aria-hidden="true" tabindex="-1"></a><span class="st"># MELODIC ICA data exploration</span></span>
<span id="cb46-128"><a href="glm-2.html#cb46-128" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(melodic_yn) 0</span></span>
<span id="cb46-129"><a href="glm-2.html#cb46-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-130"><a href="glm-2.html#cb46-130" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out main stats?</span></span>
<span id="cb46-131"><a href="glm-2.html#cb46-131" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(stats_yn) 1</span></span>
<span id="cb46-132"><a href="glm-2.html#cb46-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-133"><a href="glm-2.html#cb46-133" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out prewhitening?</span></span>
<span id="cb46-134"><a href="glm-2.html#cb46-134" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(prewhiten_yn) 1</span></span>
<span id="cb46-135"><a href="glm-2.html#cb46-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-136"><a href="glm-2.html#cb46-136" aria-hidden="true" tabindex="-1"></a><span class="st"># Add motion parameters to model</span></span>
<span id="cb46-137"><a href="glm-2.html#cb46-137" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : No</span></span>
<span id="cb46-138"><a href="glm-2.html#cb46-138" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Yes</span></span>
<span id="cb46-139"><a href="glm-2.html#cb46-139" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(motionevs) 0</span></span>
<span id="cb46-140"><a href="glm-2.html#cb46-140" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(motionevsbeta) &quot;&quot;</span></span>
<span id="cb46-141"><a href="glm-2.html#cb46-141" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(scriptevsbeta) &quot;&quot;</span></span>
<span id="cb46-142"><a href="glm-2.html#cb46-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-143"><a href="glm-2.html#cb46-143" aria-hidden="true" tabindex="-1"></a><span class="st"># Robust outlier detection in FLAME?</span></span>
<span id="cb46-144"><a href="glm-2.html#cb46-144" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(robust_yn) 0</span></span>
<span id="cb46-145"><a href="glm-2.html#cb46-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-146"><a href="glm-2.html#cb46-146" aria-hidden="true" tabindex="-1"></a><span class="st"># Higher-level modelling</span></span>
<span id="cb46-147"><a href="glm-2.html#cb46-147" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Fixed effects</span></span>
<span id="cb46-148"><a href="glm-2.html#cb46-148" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Mixed Effects: Simple OLS</span></span>
<span id="cb46-149"><a href="glm-2.html#cb46-149" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Mixed Effects: FLAME 1</span></span>
<span id="cb46-150"><a href="glm-2.html#cb46-150" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Mixed Effects: FLAME 1+2</span></span>
<span id="cb46-151"><a href="glm-2.html#cb46-151" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(mixed_yn) 2</span></span>
<span id="cb46-152"><a href="glm-2.html#cb46-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-153"><a href="glm-2.html#cb46-153" aria-hidden="true" tabindex="-1"></a><span class="st"># Higher-level permutations</span></span>
<span id="cb46-154"><a href="glm-2.html#cb46-154" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(randomisePermutations) 5000</span></span>
<span id="cb46-155"><a href="glm-2.html#cb46-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-156"><a href="glm-2.html#cb46-156" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of EVs</span></span>
<span id="cb46-157"><a href="glm-2.html#cb46-157" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evs_orig) 3</span></span>
<span id="cb46-158"><a href="glm-2.html#cb46-158" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evs_real) 6</span></span>
<span id="cb46-159"><a href="glm-2.html#cb46-159" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evs_vox) 0</span></span>
<span id="cb46-160"><a href="glm-2.html#cb46-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-161"><a href="glm-2.html#cb46-161" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of contrasts</span></span>
<span id="cb46-162"><a href="glm-2.html#cb46-162" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ncon_orig) 1</span></span>
<span id="cb46-163"><a href="glm-2.html#cb46-163" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ncon_real) 1</span></span>
<span id="cb46-164"><a href="glm-2.html#cb46-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-165"><a href="glm-2.html#cb46-165" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of F-tests</span></span>
<span id="cb46-166"><a href="glm-2.html#cb46-166" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(nftests_orig) 0</span></span>
<span id="cb46-167"><a href="glm-2.html#cb46-167" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(nftests_real) 0</span></span>
<span id="cb46-168"><a href="glm-2.html#cb46-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-169"><a href="glm-2.html#cb46-169" aria-hidden="true" tabindex="-1"></a><span class="st"># Add constant column to design matrix? (obsolete)</span></span>
<span id="cb46-170"><a href="glm-2.html#cb46-170" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(constcol) 0</span></span>
<span id="cb46-171"><a href="glm-2.html#cb46-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-172"><a href="glm-2.html#cb46-172" aria-hidden="true" tabindex="-1"></a><span class="st"># Carry out post-stats steps?</span></span>
<span id="cb46-173"><a href="glm-2.html#cb46-173" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(poststats_yn) 0</span></span>
<span id="cb46-174"><a href="glm-2.html#cb46-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-175"><a href="glm-2.html#cb46-175" aria-hidden="true" tabindex="-1"></a><span class="st"># Pre-threshold masking?</span></span>
<span id="cb46-176"><a href="glm-2.html#cb46-176" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(threshmask) &quot;&quot;</span></span>
<span id="cb46-177"><a href="glm-2.html#cb46-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-178"><a href="glm-2.html#cb46-178" aria-hidden="true" tabindex="-1"></a><span class="st"># Thresholding</span></span>
<span id="cb46-179"><a href="glm-2.html#cb46-179" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb46-180"><a href="glm-2.html#cb46-180" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Uncorrected</span></span>
<span id="cb46-181"><a href="glm-2.html#cb46-181" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Voxel</span></span>
<span id="cb46-182"><a href="glm-2.html#cb46-182" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Cluster</span></span>
<span id="cb46-183"><a href="glm-2.html#cb46-183" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(thresh) 3</span></span>
<span id="cb46-184"><a href="glm-2.html#cb46-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-185"><a href="glm-2.html#cb46-185" aria-hidden="true" tabindex="-1"></a><span class="st"># P threshold</span></span>
<span id="cb46-186"><a href="glm-2.html#cb46-186" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(prob_thresh) 0.05</span></span>
<span id="cb46-187"><a href="glm-2.html#cb46-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-188"><a href="glm-2.html#cb46-188" aria-hidden="true" tabindex="-1"></a><span class="st"># Z threshold</span></span>
<span id="cb46-189"><a href="glm-2.html#cb46-189" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(z_thresh) 3.1</span></span>
<span id="cb46-190"><a href="glm-2.html#cb46-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-191"><a href="glm-2.html#cb46-191" aria-hidden="true" tabindex="-1"></a><span class="st"># Z min/max for colour rendering</span></span>
<span id="cb46-192"><a href="glm-2.html#cb46-192" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Use actual Z min/max</span></span>
<span id="cb46-193"><a href="glm-2.html#cb46-193" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Use preset Z min/max</span></span>
<span id="cb46-194"><a href="glm-2.html#cb46-194" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(zdisplay) 0</span></span>
<span id="cb46-195"><a href="glm-2.html#cb46-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-196"><a href="glm-2.html#cb46-196" aria-hidden="true" tabindex="-1"></a><span class="st"># Z min in colour rendering</span></span>
<span id="cb46-197"><a href="glm-2.html#cb46-197" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(zmin) 2</span></span>
<span id="cb46-198"><a href="glm-2.html#cb46-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-199"><a href="glm-2.html#cb46-199" aria-hidden="true" tabindex="-1"></a><span class="st"># Z max in colour rendering</span></span>
<span id="cb46-200"><a href="glm-2.html#cb46-200" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(zmax) 8</span></span>
<span id="cb46-201"><a href="glm-2.html#cb46-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-202"><a href="glm-2.html#cb46-202" aria-hidden="true" tabindex="-1"></a><span class="st"># Colour rendering type</span></span>
<span id="cb46-203"><a href="glm-2.html#cb46-203" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Solid blobs</span></span>
<span id="cb46-204"><a href="glm-2.html#cb46-204" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Transparent blobs</span></span>
<span id="cb46-205"><a href="glm-2.html#cb46-205" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(rendertype) 1</span></span>
<span id="cb46-206"><a href="glm-2.html#cb46-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-207"><a href="glm-2.html#cb46-207" aria-hidden="true" tabindex="-1"></a><span class="st"># Background image for higher-level stats overlays</span></span>
<span id="cb46-208"><a href="glm-2.html#cb46-208" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Mean highres</span></span>
<span id="cb46-209"><a href="glm-2.html#cb46-209" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : First highres</span></span>
<span id="cb46-210"><a href="glm-2.html#cb46-210" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Mean functional</span></span>
<span id="cb46-211"><a href="glm-2.html#cb46-211" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : First functional</span></span>
<span id="cb46-212"><a href="glm-2.html#cb46-212" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Standard space template</span></span>
<span id="cb46-213"><a href="glm-2.html#cb46-213" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(bgimage) 1</span></span>
<span id="cb46-214"><a href="glm-2.html#cb46-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-215"><a href="glm-2.html#cb46-215" aria-hidden="true" tabindex="-1"></a><span class="st"># Create time series plots</span></span>
<span id="cb46-216"><a href="glm-2.html#cb46-216" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tsplot_yn) 1</span></span>
<span id="cb46-217"><a href="glm-2.html#cb46-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-218"><a href="glm-2.html#cb46-218" aria-hidden="true" tabindex="-1"></a><span class="st"># Registration to initial structural</span></span>
<span id="cb46-219"><a href="glm-2.html#cb46-219" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reginitial_highres_yn) 0</span></span>
<span id="cb46-220"><a href="glm-2.html#cb46-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-221"><a href="glm-2.html#cb46-221" aria-hidden="true" tabindex="-1"></a><span class="st"># Search space for registration to initial structural</span></span>
<span id="cb46-222"><a href="glm-2.html#cb46-222" aria-hidden="true" tabindex="-1"></a><span class="st"># 0   : No search</span></span>
<span id="cb46-223"><a href="glm-2.html#cb46-223" aria-hidden="true" tabindex="-1"></a><span class="st"># 90  : Normal search</span></span>
<span id="cb46-224"><a href="glm-2.html#cb46-224" aria-hidden="true" tabindex="-1"></a><span class="st"># 180 : Full search</span></span>
<span id="cb46-225"><a href="glm-2.html#cb46-225" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reginitial_highres_search) 90</span></span>
<span id="cb46-226"><a href="glm-2.html#cb46-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-227"><a href="glm-2.html#cb46-227" aria-hidden="true" tabindex="-1"></a><span class="st"># Degrees of Freedom for registration to initial structural</span></span>
<span id="cb46-228"><a href="glm-2.html#cb46-228" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reginitial_highres_dof) 3</span></span>
<span id="cb46-229"><a href="glm-2.html#cb46-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-230"><a href="glm-2.html#cb46-230" aria-hidden="true" tabindex="-1"></a><span class="st"># Registration to main structural</span></span>
<span id="cb46-231"><a href="glm-2.html#cb46-231" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reghighres_yn) 0</span></span>
<span id="cb46-232"><a href="glm-2.html#cb46-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-233"><a href="glm-2.html#cb46-233" aria-hidden="true" tabindex="-1"></a><span class="st"># Search space for registration to main structural</span></span>
<span id="cb46-234"><a href="glm-2.html#cb46-234" aria-hidden="true" tabindex="-1"></a><span class="st"># 0   : No search</span></span>
<span id="cb46-235"><a href="glm-2.html#cb46-235" aria-hidden="true" tabindex="-1"></a><span class="st"># 90  : Normal search</span></span>
<span id="cb46-236"><a href="glm-2.html#cb46-236" aria-hidden="true" tabindex="-1"></a><span class="st"># 180 : Full search</span></span>
<span id="cb46-237"><a href="glm-2.html#cb46-237" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reghighres_search) 90</span></span>
<span id="cb46-238"><a href="glm-2.html#cb46-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-239"><a href="glm-2.html#cb46-239" aria-hidden="true" tabindex="-1"></a><span class="st"># Degrees of Freedom for registration to main structural</span></span>
<span id="cb46-240"><a href="glm-2.html#cb46-240" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(reghighres_dof) BBR</span></span>
<span id="cb46-241"><a href="glm-2.html#cb46-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-242"><a href="glm-2.html#cb46-242" aria-hidden="true" tabindex="-1"></a><span class="st"># Registration to standard image?</span></span>
<span id="cb46-243"><a href="glm-2.html#cb46-243" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_yn) 1</span></span>
<span id="cb46-244"><a href="glm-2.html#cb46-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-245"><a href="glm-2.html#cb46-245" aria-hidden="true" tabindex="-1"></a><span class="st"># Use alternate reference images?</span></span>
<span id="cb46-246"><a href="glm-2.html#cb46-246" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(alternateReference_yn) 0</span></span>
<span id="cb46-247"><a href="glm-2.html#cb46-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-248"><a href="glm-2.html#cb46-248" aria-hidden="true" tabindex="-1"></a><span class="st"># Standard image</span></span>
<span id="cb46-249"><a href="glm-2.html#cb46-249" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard) &quot;/usr/local/fsl/data/standard/MNI152_T1_2mm_brain&quot;</span></span>
<span id="cb46-250"><a href="glm-2.html#cb46-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-251"><a href="glm-2.html#cb46-251" aria-hidden="true" tabindex="-1"></a><span class="st"># Search space for registration to standard space</span></span>
<span id="cb46-252"><a href="glm-2.html#cb46-252" aria-hidden="true" tabindex="-1"></a><span class="st"># 0   : No search</span></span>
<span id="cb46-253"><a href="glm-2.html#cb46-253" aria-hidden="true" tabindex="-1"></a><span class="st"># 90  : Normal search</span></span>
<span id="cb46-254"><a href="glm-2.html#cb46-254" aria-hidden="true" tabindex="-1"></a><span class="st"># 180 : Full search</span></span>
<span id="cb46-255"><a href="glm-2.html#cb46-255" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_search) 90</span></span>
<span id="cb46-256"><a href="glm-2.html#cb46-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-257"><a href="glm-2.html#cb46-257" aria-hidden="true" tabindex="-1"></a><span class="st"># Degrees of Freedom for registration to standard space</span></span>
<span id="cb46-258"><a href="glm-2.html#cb46-258" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_dof) 3</span></span>
<span id="cb46-259"><a href="glm-2.html#cb46-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-260"><a href="glm-2.html#cb46-260" aria-hidden="true" tabindex="-1"></a><span class="st"># Do nonlinear registration from structural to standard space?</span></span>
<span id="cb46-261"><a href="glm-2.html#cb46-261" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_nonlinear_yn) 0</span></span>
<span id="cb46-262"><a href="glm-2.html#cb46-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-263"><a href="glm-2.html#cb46-263" aria-hidden="true" tabindex="-1"></a><span class="st"># Control nonlinear warp field resolution</span></span>
<span id="cb46-264"><a href="glm-2.html#cb46-264" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(regstandard_nonlinear_warpres) 10 </span></span>
<span id="cb46-265"><a href="glm-2.html#cb46-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-266"><a href="glm-2.html#cb46-266" aria-hidden="true" tabindex="-1"></a><span class="st"># High pass filter cutoff</span></span>
<span id="cb46-267"><a href="glm-2.html#cb46-267" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(paradigm_hp) 100</span></span>
<span id="cb46-268"><a href="glm-2.html#cb46-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-269"><a href="glm-2.html#cb46-269" aria-hidden="true" tabindex="-1"></a><span class="st"># Total voxels</span></span>
<span id="cb46-270"><a href="glm-2.html#cb46-270" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(totalVoxels) 179159040</span></span>
<span id="cb46-271"><a href="glm-2.html#cb46-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-272"><a href="glm-2.html#cb46-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-273"><a href="glm-2.html#cb46-273" aria-hidden="true" tabindex="-1"></a><span class="st"># Number of lower-level copes feeding into higher-level analysis</span></span>
<span id="cb46-274"><a href="glm-2.html#cb46-274" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ncopeinputs) 0</span></span>
<span id="cb46-275"><a href="glm-2.html#cb46-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-276"><a href="glm-2.html#cb46-276" aria-hidden="true" tabindex="-1"></a><span class="st"># 4D AVW data or FEAT directory (1)</span></span>
<span id="cb46-277"><a href="glm-2.html#cb46-277" aria-hidden="true" tabindex="-1"></a><span class="st">set feat_files(1) &quot;@func_fn@&quot;</span></span>
<span id="cb46-278"><a href="glm-2.html#cb46-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-279"><a href="glm-2.html#cb46-279" aria-hidden="true" tabindex="-1"></a><span class="st"># Add confound EVs text file</span></span>
<span id="cb46-280"><a href="glm-2.html#cb46-280" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(confoundevs) 1</span></span>
<span id="cb46-281"><a href="glm-2.html#cb46-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-282"><a href="glm-2.html#cb46-282" aria-hidden="true" tabindex="-1"></a><span class="st"># Confound EVs text file for analysis 1</span></span>
<span id="cb46-283"><a href="glm-2.html#cb46-283" aria-hidden="true" tabindex="-1"></a><span class="st">set confoundev_files(1) &quot;@conf_ev_fn@&quot;</span></span>
<span id="cb46-284"><a href="glm-2.html#cb46-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-285"><a href="glm-2.html#cb46-285" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 1 title</span></span>
<span id="cb46-286"><a href="glm-2.html#cb46-286" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle1) &quot;navigation&quot;</span></span>
<span id="cb46-287"><a href="glm-2.html#cb46-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-288"><a href="glm-2.html#cb46-288" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 1)</span></span>
<span id="cb46-289"><a href="glm-2.html#cb46-289" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb46-290"><a href="glm-2.html#cb46-290" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb46-291"><a href="glm-2.html#cb46-291" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb46-292"><a href="glm-2.html#cb46-292" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb46-293"><a href="glm-2.html#cb46-293" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb46-294"><a href="glm-2.html#cb46-294" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb46-295"><a href="glm-2.html#cb46-295" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape1) 3</span></span>
<span id="cb46-296"><a href="glm-2.html#cb46-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-297"><a href="glm-2.html#cb46-297" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 1)</span></span>
<span id="cb46-298"><a href="glm-2.html#cb46-298" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb46-299"><a href="glm-2.html#cb46-299" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb46-300"><a href="glm-2.html#cb46-300" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb46-301"><a href="glm-2.html#cb46-301" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb46-302"><a href="glm-2.html#cb46-302" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb46-303"><a href="glm-2.html#cb46-303" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb46-304"><a href="glm-2.html#cb46-304" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb46-305"><a href="glm-2.html#cb46-305" aria-hidden="true" tabindex="-1"></a><span class="st"># 8 : Alternate Double-Gamma</span></span>
<span id="cb46-306"><a href="glm-2.html#cb46-306" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve1) 2</span></span>
<span id="cb46-307"><a href="glm-2.html#cb46-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-308"><a href="glm-2.html#cb46-308" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 1)</span></span>
<span id="cb46-309"><a href="glm-2.html#cb46-309" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase1) 0</span></span>
<span id="cb46-310"><a href="glm-2.html#cb46-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-311"><a href="glm-2.html#cb46-311" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 1)</span></span>
<span id="cb46-312"><a href="glm-2.html#cb46-312" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn1) 1</span></span>
<span id="cb46-313"><a href="glm-2.html#cb46-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-314"><a href="glm-2.html#cb46-314" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 1)</span></span>
<span id="cb46-315"><a href="glm-2.html#cb46-315" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn1) 1</span></span>
<span id="cb46-316"><a href="glm-2.html#cb46-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-317"><a href="glm-2.html#cb46-317" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 1)</span></span>
<span id="cb46-318"><a href="glm-2.html#cb46-318" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom1) &quot;@navi_ev_fn@&quot;</span></span>
<span id="cb46-319"><a href="glm-2.html#cb46-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-320"><a href="glm-2.html#cb46-320" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 1)</span></span>
<span id="cb46-321"><a href="glm-2.html#cb46-321" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma1) 3</span></span>
<span id="cb46-322"><a href="glm-2.html#cb46-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-323"><a href="glm-2.html#cb46-323" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 1)</span></span>
<span id="cb46-324"><a href="glm-2.html#cb46-324" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay1) 6</span></span>
<span id="cb46-325"><a href="glm-2.html#cb46-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-326"><a href="glm-2.html#cb46-326" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 0</span></span>
<span id="cb46-327"><a href="glm-2.html#cb46-327" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.0) 0</span></span>
<span id="cb46-328"><a href="glm-2.html#cb46-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-329"><a href="glm-2.html#cb46-329" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 1</span></span>
<span id="cb46-330"><a href="glm-2.html#cb46-330" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.1) 0</span></span>
<span id="cb46-331"><a href="glm-2.html#cb46-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-332"><a href="glm-2.html#cb46-332" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 2</span></span>
<span id="cb46-333"><a href="glm-2.html#cb46-333" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.2) 0</span></span>
<span id="cb46-334"><a href="glm-2.html#cb46-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-335"><a href="glm-2.html#cb46-335" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 1 wrt EV 3</span></span>
<span id="cb46-336"><a href="glm-2.html#cb46-336" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho1.3) 0</span></span>
<span id="cb46-337"><a href="glm-2.html#cb46-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-338"><a href="glm-2.html#cb46-338" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 2 title</span></span>
<span id="cb46-339"><a href="glm-2.html#cb46-339" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle2) &quot;cosine_pmod&quot;</span></span>
<span id="cb46-340"><a href="glm-2.html#cb46-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-341"><a href="glm-2.html#cb46-341" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 2)</span></span>
<span id="cb46-342"><a href="glm-2.html#cb46-342" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb46-343"><a href="glm-2.html#cb46-343" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb46-344"><a href="glm-2.html#cb46-344" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb46-345"><a href="glm-2.html#cb46-345" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb46-346"><a href="glm-2.html#cb46-346" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb46-347"><a href="glm-2.html#cb46-347" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb46-348"><a href="glm-2.html#cb46-348" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape2) 3</span></span>
<span id="cb46-349"><a href="glm-2.html#cb46-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-350"><a href="glm-2.html#cb46-350" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 2)</span></span>
<span id="cb46-351"><a href="glm-2.html#cb46-351" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb46-352"><a href="glm-2.html#cb46-352" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb46-353"><a href="glm-2.html#cb46-353" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb46-354"><a href="glm-2.html#cb46-354" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb46-355"><a href="glm-2.html#cb46-355" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb46-356"><a href="glm-2.html#cb46-356" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb46-357"><a href="glm-2.html#cb46-357" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb46-358"><a href="glm-2.html#cb46-358" aria-hidden="true" tabindex="-1"></a><span class="st"># 8 : Alternate Double-Gamma</span></span>
<span id="cb46-359"><a href="glm-2.html#cb46-359" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve2) 2</span></span>
<span id="cb46-360"><a href="glm-2.html#cb46-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-361"><a href="glm-2.html#cb46-361" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 2)</span></span>
<span id="cb46-362"><a href="glm-2.html#cb46-362" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase2) 0</span></span>
<span id="cb46-363"><a href="glm-2.html#cb46-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-364"><a href="glm-2.html#cb46-364" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 2)</span></span>
<span id="cb46-365"><a href="glm-2.html#cb46-365" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn2) 1</span></span>
<span id="cb46-366"><a href="glm-2.html#cb46-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-367"><a href="glm-2.html#cb46-367" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 2)</span></span>
<span id="cb46-368"><a href="glm-2.html#cb46-368" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn2) 1</span></span>
<span id="cb46-369"><a href="glm-2.html#cb46-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-370"><a href="glm-2.html#cb46-370" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 2)</span></span>
<span id="cb46-371"><a href="glm-2.html#cb46-371" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom2) &quot;@cosine_ev_fn@&quot;</span></span>
<span id="cb46-372"><a href="glm-2.html#cb46-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-373"><a href="glm-2.html#cb46-373" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 2)</span></span>
<span id="cb46-374"><a href="glm-2.html#cb46-374" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma2) 3</span></span>
<span id="cb46-375"><a href="glm-2.html#cb46-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-376"><a href="glm-2.html#cb46-376" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 2)</span></span>
<span id="cb46-377"><a href="glm-2.html#cb46-377" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay2) 6</span></span>
<span id="cb46-378"><a href="glm-2.html#cb46-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-379"><a href="glm-2.html#cb46-379" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 0</span></span>
<span id="cb46-380"><a href="glm-2.html#cb46-380" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.0) 0</span></span>
<span id="cb46-381"><a href="glm-2.html#cb46-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-382"><a href="glm-2.html#cb46-382" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 1</span></span>
<span id="cb46-383"><a href="glm-2.html#cb46-383" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.1) 0</span></span>
<span id="cb46-384"><a href="glm-2.html#cb46-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-385"><a href="glm-2.html#cb46-385" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 2</span></span>
<span id="cb46-386"><a href="glm-2.html#cb46-386" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.2) 0</span></span>
<span id="cb46-387"><a href="glm-2.html#cb46-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-388"><a href="glm-2.html#cb46-388" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 2 wrt EV 3</span></span>
<span id="cb46-389"><a href="glm-2.html#cb46-389" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho2.3) 0</span></span>
<span id="cb46-390"><a href="glm-2.html#cb46-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-391"><a href="glm-2.html#cb46-391" aria-hidden="true" tabindex="-1"></a><span class="st"># EV 3 title</span></span>
<span id="cb46-392"><a href="glm-2.html#cb46-392" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(evtitle3) &quot;feedback&quot;</span></span>
<span id="cb46-393"><a href="glm-2.html#cb46-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-394"><a href="glm-2.html#cb46-394" aria-hidden="true" tabindex="-1"></a><span class="st"># Basic waveform shape (EV 3)</span></span>
<span id="cb46-395"><a href="glm-2.html#cb46-395" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : Square</span></span>
<span id="cb46-396"><a href="glm-2.html#cb46-396" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Sinusoid</span></span>
<span id="cb46-397"><a href="glm-2.html#cb46-397" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Custom (1 entry per volume)</span></span>
<span id="cb46-398"><a href="glm-2.html#cb46-398" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Custom (3 column format)</span></span>
<span id="cb46-399"><a href="glm-2.html#cb46-399" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Interaction</span></span>
<span id="cb46-400"><a href="glm-2.html#cb46-400" aria-hidden="true" tabindex="-1"></a><span class="st"># 10 : Empty (all zeros)</span></span>
<span id="cb46-401"><a href="glm-2.html#cb46-401" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(shape3) 3</span></span>
<span id="cb46-402"><a href="glm-2.html#cb46-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-403"><a href="glm-2.html#cb46-403" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolution (EV 3)</span></span>
<span id="cb46-404"><a href="glm-2.html#cb46-404" aria-hidden="true" tabindex="-1"></a><span class="st"># 0 : None</span></span>
<span id="cb46-405"><a href="glm-2.html#cb46-405" aria-hidden="true" tabindex="-1"></a><span class="st"># 1 : Gaussian</span></span>
<span id="cb46-406"><a href="glm-2.html#cb46-406" aria-hidden="true" tabindex="-1"></a><span class="st"># 2 : Gamma</span></span>
<span id="cb46-407"><a href="glm-2.html#cb46-407" aria-hidden="true" tabindex="-1"></a><span class="st"># 3 : Double-Gamma HRF</span></span>
<span id="cb46-408"><a href="glm-2.html#cb46-408" aria-hidden="true" tabindex="-1"></a><span class="st"># 4 : Gamma basis functions</span></span>
<span id="cb46-409"><a href="glm-2.html#cb46-409" aria-hidden="true" tabindex="-1"></a><span class="st"># 5 : Sine basis functions</span></span>
<span id="cb46-410"><a href="glm-2.html#cb46-410" aria-hidden="true" tabindex="-1"></a><span class="st"># 6 : FIR basis functions</span></span>
<span id="cb46-411"><a href="glm-2.html#cb46-411" aria-hidden="true" tabindex="-1"></a><span class="st"># 8 : Alternate Double-Gamma</span></span>
<span id="cb46-412"><a href="glm-2.html#cb46-412" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve3) 2</span></span>
<span id="cb46-413"><a href="glm-2.html#cb46-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-414"><a href="glm-2.html#cb46-414" aria-hidden="true" tabindex="-1"></a><span class="st"># Convolve phase (EV 3)</span></span>
<span id="cb46-415"><a href="glm-2.html#cb46-415" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(convolve_phase3) 0</span></span>
<span id="cb46-416"><a href="glm-2.html#cb46-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-417"><a href="glm-2.html#cb46-417" aria-hidden="true" tabindex="-1"></a><span class="st"># Apply temporal filtering (EV 3)</span></span>
<span id="cb46-418"><a href="glm-2.html#cb46-418" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(tempfilt_yn3) 1</span></span>
<span id="cb46-419"><a href="glm-2.html#cb46-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-420"><a href="glm-2.html#cb46-420" aria-hidden="true" tabindex="-1"></a><span class="st"># Add temporal derivative (EV 3)</span></span>
<span id="cb46-421"><a href="glm-2.html#cb46-421" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(deriv_yn3) 1</span></span>
<span id="cb46-422"><a href="glm-2.html#cb46-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-423"><a href="glm-2.html#cb46-423" aria-hidden="true" tabindex="-1"></a><span class="st"># Custom EV file (EV 3)</span></span>
<span id="cb46-424"><a href="glm-2.html#cb46-424" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(custom3) &quot;@feedback_ev_fn@&quot;</span></span>
<span id="cb46-425"><a href="glm-2.html#cb46-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-426"><a href="glm-2.html#cb46-426" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma sigma (EV 3)</span></span>
<span id="cb46-427"><a href="glm-2.html#cb46-427" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammasigma3) 3</span></span>
<span id="cb46-428"><a href="glm-2.html#cb46-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-429"><a href="glm-2.html#cb46-429" aria-hidden="true" tabindex="-1"></a><span class="st"># Gamma delay (EV 3)</span></span>
<span id="cb46-430"><a href="glm-2.html#cb46-430" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(gammadelay3) 6</span></span>
<span id="cb46-431"><a href="glm-2.html#cb46-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-432"><a href="glm-2.html#cb46-432" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 0</span></span>
<span id="cb46-433"><a href="glm-2.html#cb46-433" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.0) 0</span></span>
<span id="cb46-434"><a href="glm-2.html#cb46-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-435"><a href="glm-2.html#cb46-435" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 1</span></span>
<span id="cb46-436"><a href="glm-2.html#cb46-436" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.1) 0</span></span>
<span id="cb46-437"><a href="glm-2.html#cb46-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-438"><a href="glm-2.html#cb46-438" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 2</span></span>
<span id="cb46-439"><a href="glm-2.html#cb46-439" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.2) 0</span></span>
<span id="cb46-440"><a href="glm-2.html#cb46-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-441"><a href="glm-2.html#cb46-441" aria-hidden="true" tabindex="-1"></a><span class="st"># Orthogonalise EV 3 wrt EV 3</span></span>
<span id="cb46-442"><a href="glm-2.html#cb46-442" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(ortho3.3) 0</span></span>
<span id="cb46-443"><a href="glm-2.html#cb46-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-444"><a href="glm-2.html#cb46-444" aria-hidden="true" tabindex="-1"></a><span class="st"># Contrast &amp; F-tests mode</span></span>
<span id="cb46-445"><a href="glm-2.html#cb46-445" aria-hidden="true" tabindex="-1"></a><span class="st"># real : control real EVs</span></span>
<span id="cb46-446"><a href="glm-2.html#cb46-446" aria-hidden="true" tabindex="-1"></a><span class="st"># orig : control original EVs</span></span>
<span id="cb46-447"><a href="glm-2.html#cb46-447" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_mode_old) orig</span></span>
<span id="cb46-448"><a href="glm-2.html#cb46-448" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_mode) orig</span></span>
<span id="cb46-449"><a href="glm-2.html#cb46-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-450"><a href="glm-2.html#cb46-450" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_real 1</span></span>
<span id="cb46-451"><a href="glm-2.html#cb46-451" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_real.1) 1</span></span>
<span id="cb46-452"><a href="glm-2.html#cb46-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-453"><a href="glm-2.html#cb46-453" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_real 1</span></span>
<span id="cb46-454"><a href="glm-2.html#cb46-454" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_real.1) &quot;&quot;</span></span>
<span id="cb46-455"><a href="glm-2.html#cb46-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-456"><a href="glm-2.html#cb46-456" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 1</span></span>
<span id="cb46-457"><a href="glm-2.html#cb46-457" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.1) 0.0</span></span>
<span id="cb46-458"><a href="glm-2.html#cb46-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-459"><a href="glm-2.html#cb46-459" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 2</span></span>
<span id="cb46-460"><a href="glm-2.html#cb46-460" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.2) 0</span></span>
<span id="cb46-461"><a href="glm-2.html#cb46-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-462"><a href="glm-2.html#cb46-462" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 3</span></span>
<span id="cb46-463"><a href="glm-2.html#cb46-463" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.3) 1.0</span></span>
<span id="cb46-464"><a href="glm-2.html#cb46-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-465"><a href="glm-2.html#cb46-465" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 4</span></span>
<span id="cb46-466"><a href="glm-2.html#cb46-466" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.4) 0</span></span>
<span id="cb46-467"><a href="glm-2.html#cb46-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-468"><a href="glm-2.html#cb46-468" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 5</span></span>
<span id="cb46-469"><a href="glm-2.html#cb46-469" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.5) 0</span></span>
<span id="cb46-470"><a href="glm-2.html#cb46-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-471"><a href="glm-2.html#cb46-471" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_real vector 1 element 6</span></span>
<span id="cb46-472"><a href="glm-2.html#cb46-472" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_real1.6) 0</span></span>
<span id="cb46-473"><a href="glm-2.html#cb46-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-474"><a href="glm-2.html#cb46-474" aria-hidden="true" tabindex="-1"></a><span class="st"># Display images for contrast_orig 1</span></span>
<span id="cb46-475"><a href="glm-2.html#cb46-475" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conpic_orig.1) 1</span></span>
<span id="cb46-476"><a href="glm-2.html#cb46-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-477"><a href="glm-2.html#cb46-477" aria-hidden="true" tabindex="-1"></a><span class="st"># Title for contrast_orig 1</span></span>
<span id="cb46-478"><a href="glm-2.html#cb46-478" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conname_orig.1) &quot;&quot;</span></span>
<span id="cb46-479"><a href="glm-2.html#cb46-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-480"><a href="glm-2.html#cb46-480" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 1</span></span>
<span id="cb46-481"><a href="glm-2.html#cb46-481" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.1) 0.0</span></span>
<span id="cb46-482"><a href="glm-2.html#cb46-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-483"><a href="glm-2.html#cb46-483" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 2</span></span>
<span id="cb46-484"><a href="glm-2.html#cb46-484" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.2) 1.0</span></span>
<span id="cb46-485"><a href="glm-2.html#cb46-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-486"><a href="glm-2.html#cb46-486" aria-hidden="true" tabindex="-1"></a><span class="st"># Real contrast_orig vector 1 element 3</span></span>
<span id="cb46-487"><a href="glm-2.html#cb46-487" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(con_orig1.3) 0</span></span>
<span id="cb46-488"><a href="glm-2.html#cb46-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-489"><a href="glm-2.html#cb46-489" aria-hidden="true" tabindex="-1"></a><span class="st"># Contrast masking - use &gt;0 instead of thresholding?</span></span>
<span id="cb46-490"><a href="glm-2.html#cb46-490" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask_zerothresh_yn) 0</span></span>
<span id="cb46-491"><a href="glm-2.html#cb46-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-492"><a href="glm-2.html#cb46-492" aria-hidden="true" tabindex="-1"></a><span class="st"># Do contrast masking at all?</span></span>
<span id="cb46-493"><a href="glm-2.html#cb46-493" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(conmask1_1) 0</span></span>
<span id="cb46-494"><a href="glm-2.html#cb46-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-495"><a href="glm-2.html#cb46-495" aria-hidden="true" tabindex="-1"></a><span class="st">##########################################################</span></span>
<span id="cb46-496"><a href="glm-2.html#cb46-496" aria-hidden="true" tabindex="-1"></a><span class="st"># Now options that do not appear in the GUI</span></span>
<span id="cb46-497"><a href="glm-2.html#cb46-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-498"><a href="glm-2.html#cb46-498" aria-hidden="true" tabindex="-1"></a><span class="st"># Alternative (to BETting) mask image</span></span>
<span id="cb46-499"><a href="glm-2.html#cb46-499" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(alternative_mask) &quot;&quot;</span></span>
<span id="cb46-500"><a href="glm-2.html#cb46-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-501"><a href="glm-2.html#cb46-501" aria-hidden="true" tabindex="-1"></a><span class="st"># Initial structural space registration initialisation transform</span></span>
<span id="cb46-502"><a href="glm-2.html#cb46-502" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(init_initial_highres) &quot;&quot;</span></span>
<span id="cb46-503"><a href="glm-2.html#cb46-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-504"><a href="glm-2.html#cb46-504" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural space registration initialisation transform</span></span>
<span id="cb46-505"><a href="glm-2.html#cb46-505" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(init_highres) &quot;&quot;</span></span>
<span id="cb46-506"><a href="glm-2.html#cb46-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-507"><a href="glm-2.html#cb46-507" aria-hidden="true" tabindex="-1"></a><span class="st"># Standard space registration initialisation transform</span></span>
<span id="cb46-508"><a href="glm-2.html#cb46-508" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(init_standard) &quot;&quot;</span></span>
<span id="cb46-509"><a href="glm-2.html#cb46-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-510"><a href="glm-2.html#cb46-510" aria-hidden="true" tabindex="-1"></a><span class="st"># For full FEAT analysis: overwrite existing .feat output dir?</span></span>
<span id="cb46-511"><a href="glm-2.html#cb46-511" aria-hidden="true" tabindex="-1"></a><span class="st">set fmri(overwrite_yn) 0</span></span>
<span id="cb46-512"><a href="glm-2.html#cb46-512" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Now, we define the function that creates the fsf-file by filling the placeholders and writing to file.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="glm-2.html#cb47-1" aria-hidden="true" tabindex="-1"></a>create_fsf <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">fsf =</span> dsgn, <span class="at">placeholder =</span> <span class="fu">c</span>(<span class="st">&quot;@n_vols@&quot;</span>), <span class="at">replace_with =</span> <span class="fu">c</span>(<span class="st">&quot;666&quot;</span>), <span class="at">out_fn =</span> <span class="cn">NA</span>){</span>
<span id="cb47-2"><a href="glm-2.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  assertthat<span class="sc">::</span><span class="fu">are_equal</span>(<span class="fu">length</span>(placeholder), <span class="fu">length</span>(replace_with))</span>
<span id="cb47-3"><a href="glm-2.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-4"><a href="glm-2.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># loop over the placeholders and fill them with info</span></span>
<span id="cb47-5"><a href="glm-2.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(placeholder)){</span>
<span id="cb47-6"><a href="glm-2.html#cb47-6" aria-hidden="true" tabindex="-1"></a>    fsf <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern=</span>placeholder[i], <span class="at">replacement =</span> replace_with[i], <span class="at">x=</span>fsf)    </span>
<span id="cb47-7"><a href="glm-2.html#cb47-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-8"><a href="glm-2.html#cb47-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-9"><a href="glm-2.html#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># write fsf file</span></span>
<span id="cb47-10"><a href="glm-2.html#cb47-10" aria-hidden="true" tabindex="-1"></a>  con<span class="ot">&lt;-</span><span class="fu">file</span>(out_fn)</span>
<span id="cb47-11"><a href="glm-2.html#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeLines</span>(fsf, con)</span>
<span id="cb47-12"><a href="glm-2.html#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">close</span>(con)</span>
<span id="cb47-13"><a href="glm-2.html#cb47-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, for each run and periodicity, let’s replace the placeholders with the required variables.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="glm-2.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these are the placeholders in the fsf</span></span>
<span id="cb48-2"><a href="glm-2.html#cb48-2" aria-hidden="true" tabindex="-1"></a>to_replace <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;@out_dir@&quot;</span>, </span>
<span id="cb48-3"><a href="glm-2.html#cb48-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@func_fn@&quot;</span>, </span>
<span id="cb48-4"><a href="glm-2.html#cb48-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@tr@&quot;</span>,</span>
<span id="cb48-5"><a href="glm-2.html#cb48-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@n_vols@&quot;</span>, </span>
<span id="cb48-6"><a href="glm-2.html#cb48-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@navi_ev_fn@&quot;</span>, </span>
<span id="cb48-7"><a href="glm-2.html#cb48-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@cosine_ev_fn@&quot;</span>,</span>
<span id="cb48-8"><a href="glm-2.html#cb48-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@feedback_ev_fn@&quot;</span>,</span>
<span id="cb48-9"><a href="glm-2.html#cb48-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;@conf_ev_fn@&quot;</span>)</span>
<span id="cb48-10"><a href="glm-2.html#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="glm-2.html#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb48-12"><a href="glm-2.html#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb48-13"><a href="glm-2.html#cb48-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb48-14"><a href="glm-2.html#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># current functional data and find number of volumes in case they differ</span></span>
<span id="cb48-15"><a href="glm-2.html#cb48-15" aria-hidden="true" tabindex="-1"></a>    func_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;FunctionalScans&quot;</span>, <span class="st">&quot;4D&quot;</span>, i_sub, i_run, <span class="fu">paste0</span>(i_run, <span class="st">&quot;_masked.nii.gz&quot;</span>))</span>
<span id="cb48-16"><a href="glm-2.html#cb48-16" aria-hidden="true" tabindex="-1"></a>    hdr <span class="ot">&lt;-</span> <span class="fu">fslhd</span>(func_fn, <span class="at">verbose =</span><span class="cn">FALSE</span>)</span>
<span id="cb48-17"><a href="glm-2.html#cb48-17" aria-hidden="true" tabindex="-1"></a>    hdr <span class="ot">&lt;-</span> hdr[<span class="fu">grep</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">bdim4</span><span class="sc">\\</span><span class="st">b&quot;</span>, hdr)]</span>
<span id="cb48-18"><a href="glm-2.html#cb48-18" aria-hidden="true" tabindex="-1"></a>    n_vols <span class="ot">&lt;-</span> <span class="fu">regmatches</span>(hdr, <span class="fu">gregexpr</span>(<span class="st">&quot;[[:digit:]]+&quot;</span>, hdr))[[<span class="dv">1</span>]][<span class="dv">2</span>]</span>
<span id="cb48-19"><a href="glm-2.html#cb48-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb48-20"><a href="glm-2.html#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb48-21"><a href="glm-2.html#cb48-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb48-22"><a href="glm-2.html#cb48-22" aria-hidden="true" tabindex="-1"></a>      <span class="co"># folder to write the fsf-files to</span></span>
<span id="cb48-23"><a href="glm-2.html#cb48-23" aria-hidden="true" tabindex="-1"></a>      fsf_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="st">&quot;feat_design&quot;</span>, </span>
<span id="cb48-24"><a href="glm-2.html#cb48-24" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run)</span>
<span id="cb48-25"><a href="glm-2.html#cb48-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(fsf_dir)){<span class="fu">dir.create</span>(fsf_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb48-26"><a href="glm-2.html#cb48-26" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb48-27"><a href="glm-2.html#cb48-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># collect the info we need</span></span>
<span id="cb48-28"><a href="glm-2.html#cb48-28" aria-hidden="true" tabindex="-1"></a>      fsf_fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(fsf_dir, <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%dfold.fsf&quot;</span>, i_sub, i_run, i_period))</span>
<span id="cb48-29"><a href="glm-2.html#cb48-29" aria-hidden="true" tabindex="-1"></a>      out_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, </span>
<span id="cb48-30"><a href="glm-2.html#cb48-30" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run)</span>
<span id="cb48-31"><a href="glm-2.html#cb48-31" aria-hidden="true" tabindex="-1"></a>      tr <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb48-32"><a href="glm-2.html#cb48-32" aria-hidden="true" tabindex="-1"></a>      navi_ev_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>,</span>
<span id="cb48-33"><a href="glm-2.html#cb48-33" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;feat_ev&quot;</span>, i_sub, i_run, <span class="st">&quot;translation.txt&quot;</span>)</span>
<span id="cb48-34"><a href="glm-2.html#cb48-34" aria-hidden="true" tabindex="-1"></a>      cosine_ev_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>,</span>
<span id="cb48-35"><a href="glm-2.html#cb48-35" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;feat_ev&quot;</span>, i_sub, i_run, </span>
<span id="cb48-36"><a href="glm-2.html#cb48-36" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">&quot;translation_cosine_&quot;</span>, i_period, <span class="st">&quot;fold_half2.txt&quot;</span>))</span>
<span id="cb48-37"><a href="glm-2.html#cb48-37" aria-hidden="true" tabindex="-1"></a>      feedback_ev_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, </span>
<span id="cb48-38"><a href="glm-2.html#cb48-38" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;feat_ev&quot;</span>, i_sub, i_run, <span class="st">&quot;feedback.txt&quot;</span>)</span>
<span id="cb48-39"><a href="glm-2.html#cb48-39" aria-hidden="true" tabindex="-1"></a>      conf_ev_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;AdditionalRegressors&quot;</span>, i_sub, </span>
<span id="cb48-40"><a href="glm-2.html#cb48-40" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&quot;realignmentParameters_&quot;</span>, i_run ,<span class="st">&quot;.txt&quot;</span>))</span>
<span id="cb48-41"><a href="glm-2.html#cb48-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb48-42"><a href="glm-2.html#cb48-42" aria-hidden="true" tabindex="-1"></a>      <span class="co"># collect the filler items. CAVE: Must be in same order as to_replace</span></span>
<span id="cb48-43"><a href="glm-2.html#cb48-43" aria-hidden="true" tabindex="-1"></a>      fillers <span class="ot">&lt;-</span> <span class="fu">c</span>(out_dir, </span>
<span id="cb48-44"><a href="glm-2.html#cb48-44" aria-hidden="true" tabindex="-1"></a>                   func_fn, </span>
<span id="cb48-45"><a href="glm-2.html#cb48-45" aria-hidden="true" tabindex="-1"></a>                   tr, </span>
<span id="cb48-46"><a href="glm-2.html#cb48-46" aria-hidden="true" tabindex="-1"></a>                   n_vols, </span>
<span id="cb48-47"><a href="glm-2.html#cb48-47" aria-hidden="true" tabindex="-1"></a>                   navi_ev_fn, </span>
<span id="cb48-48"><a href="glm-2.html#cb48-48" aria-hidden="true" tabindex="-1"></a>                   cosine_ev_fn, </span>
<span id="cb48-49"><a href="glm-2.html#cb48-49" aria-hidden="true" tabindex="-1"></a>                   feedback_ev_fn, </span>
<span id="cb48-50"><a href="glm-2.html#cb48-50" aria-hidden="true" tabindex="-1"></a>                   conf_ev_fn)</span>
<span id="cb48-51"><a href="glm-2.html#cb48-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-52"><a href="glm-2.html#cb48-52" aria-hidden="true" tabindex="-1"></a>      <span class="co"># create the fsf file</span></span>
<span id="cb48-53"><a href="glm-2.html#cb48-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">create_fsf</span>(<span class="at">fsf =</span> dsgn, <span class="at">placeholder =</span> to_replace, <span class="at">replace_with =</span> fillers, <span class="at">out_fn =</span> fsf_fn)</span>
<span id="cb48-54"><a href="glm-2.html#cb48-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb48-55"><a href="glm-2.html#cb48-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># create GLM design files to use with film_gls</span></span>
<span id="cb48-56"><a href="glm-2.html#cb48-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/bin/feat_model %s %s&quot;</span>, </span>
<span id="cb48-57"><a href="glm-2.html#cb48-57" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">fsldir</span>(), tools<span class="sc">::</span><span class="fu">file_path_sans_ext</span>(fsf_fn), conf_ev_fn))</span>
<span id="cb48-58"><a href="glm-2.html#cb48-58" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-59"><a href="glm-2.html#cb48-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-60"><a href="glm-2.html#cb48-60" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="run-glm2" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Run GLM2<a href="glm-2.html#run-glm2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are ready to run GLM2. We will do so using FSL FEAT and the bare <code>film_gls</code> command.</p>
<div id="feat-1" class="section level4 hasAnchor" number="5.1.3.1">
<h4><span class="header-section-number">5.1.3.1</span> FEAT<a href="glm-2.html#feat-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s start by running the GLM using FEAT.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="glm-2.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb49-2"><a href="glm-2.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb49-3"><a href="glm-2.html#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb49-4"><a href="glm-2.html#cb49-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-5"><a href="glm-2.html#cb49-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># check if the t-stats image exists, this should be one of the last files written</span></span>
<span id="cb49-6"><a href="glm-2.html#cb49-6" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,  <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb49-7"><a href="glm-2.html#cb49-7" aria-hidden="true" tabindex="-1"></a>                 i_sub, <span class="fu">paste0</span>(i_run, <span class="st">&quot;.feat&quot;</span>), <span class="st">&quot;stats&quot;</span>, <span class="st">&quot;tstat1.nii.gz&quot;</span>)</span>
<span id="cb49-8"><a href="glm-2.html#cb49-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(fn)){</span>
<span id="cb49-9"><a href="glm-2.html#cb49-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-10"><a href="glm-2.html#cb49-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># build the command and run</span></span>
<span id="cb49-11"><a href="glm-2.html#cb49-11" aria-hidden="true" tabindex="-1"></a>        fsf_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,  <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="st">&quot;feat_design&quot;</span>, </span>
<span id="cb49-12"><a href="glm-2.html#cb49-12" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run,</span>
<span id="cb49-13"><a href="glm-2.html#cb49-13" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%dfold.fsf&quot;</span>, i_sub, i_run, i_period))</span>
<span id="cb49-14"><a href="glm-2.html#cb49-14" aria-hidden="true" tabindex="-1"></a>        cmd <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/bin/feat %s&quot;</span>, <span class="fu">fsldir</span>(), fsf_fn)</span>
<span id="cb49-15"><a href="glm-2.html#cb49-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">system</span>(cmd)</span>
<span id="cb49-16"><a href="glm-2.html#cb49-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-17"><a href="glm-2.html#cb49-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># remove the residuals file to clear some space</span></span>
<span id="cb49-18"><a href="glm-2.html#cb49-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&quot;rm %s&quot;</span>, </span>
<span id="cb49-19"><a href="glm-2.html#cb49-19" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>,</span>
<span id="cb49-20"><a href="glm-2.html#cb49-20" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, <span class="fu">paste0</span>(i_run, <span class="st">&quot;.feat&quot;</span>), </span>
<span id="cb49-21"><a href="glm-2.html#cb49-21" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;stats&quot;</span>, <span class="st">&quot;res4d.nii.gz&quot;</span>)))</span>
<span id="cb49-22"><a href="glm-2.html#cb49-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb49-23"><a href="glm-2.html#cb49-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-24"><a href="glm-2.html#cb49-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-25"><a href="glm-2.html#cb49-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here is the design matrix as visualized by FEAT:</p>
<div class="figure">
<img src="data/glm2/glm2_secondhalf/cosine_pmod/6fold/sub01/run02.feat/design.png" alt="" />
<p class="caption">GLM2 design matrix</p>
</div>
<p>Covariance matrix &amp; design efficiency:
<img src="data/glm2/glm2_secondhalf/cosine_pmod/6fold/sub01/run02.feat/design_cov.png" alt="GLM2 covariance matrix" /></p>
</div>
<div id="film_gls-1" class="section level4 hasAnchor" number="5.1.3.2">
<h4><span class="header-section-number">5.1.3.2</span> FILM_GLS<a href="glm-2.html#film_gls-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The command here is based on the command used by FEAT. The results should thus be identical.</p>
<p>NB: For this to work, make sure FSL is correctly configured. On MacOS that might mean starting RStudio from the terminal (<code>open -na Rstudio</code>).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="glm-2.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb50-2"><a href="glm-2.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>,<span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub)))</span>
<span id="cb50-3"><a href="glm-2.html#cb50-3" aria-hidden="true" tabindex="-1"></a>      {<span class="fu">dir.create</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>,<span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub))}</span>
<span id="cb50-4"><a href="glm-2.html#cb50-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-5"><a href="glm-2.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb50-6"><a href="glm-2.html#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb50-7"><a href="glm-2.html#cb50-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-8"><a href="glm-2.html#cb50-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># files and folders to be used as input for film_gls</span></span>
<span id="cb50-9"><a href="glm-2.html#cb50-9" aria-hidden="true" tabindex="-1"></a>      func_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;FunctionalScans&quot;</span>, <span class="st">&quot;4D&quot;</span>, i_sub, i_run, <span class="fu">paste0</span>(i_run, <span class="st">&quot;_masked.nii.gz&quot;</span>))</span>
<span id="cb50-10"><a href="glm-2.html#cb50-10" aria-hidden="true" tabindex="-1"></a>      out_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>,</span>
<span id="cb50-11"><a href="glm-2.html#cb50-11" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run)</span>
<span id="cb50-12"><a href="glm-2.html#cb50-12" aria-hidden="true" tabindex="-1"></a>      pd_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="st">&quot;feat_design&quot;</span>, </span>
<span id="cb50-13"><a href="glm-2.html#cb50-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run,</span>
<span id="cb50-14"><a href="glm-2.html#cb50-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%dfold.mat&quot;</span>, i_sub, i_run, i_period))</span>
<span id="cb50-15"><a href="glm-2.html#cb50-15" aria-hidden="true" tabindex="-1"></a>      con_fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="st">&quot;feat_design&quot;</span>, </span>
<span id="cb50-16"><a href="glm-2.html#cb50-16" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), i_sub, i_run,</span>
<span id="cb50-17"><a href="glm-2.html#cb50-17" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">sprintf</span>(<span class="st">&quot;%s_%s_%dfold.con&quot;</span>, i_sub, i_run, i_period))</span>
<span id="cb50-18"><a href="glm-2.html#cb50-18" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-19"><a href="glm-2.html#cb50-19" aria-hidden="true" tabindex="-1"></a>      <span class="co"># check if the zstat of the t-contrast exists, this should be one of the last files written</span></span>
<span id="cb50-20"><a href="glm-2.html#cb50-20" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">file.path</span>(out_dir, <span class="st">&quot;tstat1.nii.gz&quot;</span>)</span>
<span id="cb50-21"><a href="glm-2.html#cb50-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(fn)){</span>
<span id="cb50-22"><a href="glm-2.html#cb50-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb50-23"><a href="glm-2.html#cb50-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># build the command and run</span></span>
<span id="cb50-24"><a href="glm-2.html#cb50-24" aria-hidden="true" tabindex="-1"></a>        t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb50-25"><a href="glm-2.html#cb50-25" aria-hidden="true" tabindex="-1"></a>        cmd <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/bin/film_gls --in=%s --rn=%s --pd=%s --thr=1 --sa --ms=5 --con=%s&quot;</span>, </span>
<span id="cb50-26"><a href="glm-2.html#cb50-26" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">fsldir</span>(), func_fn, out_dir, pd_fn, con_fn)</span>
<span id="cb50-27"><a href="glm-2.html#cb50-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">system</span>(cmd, <span class="at">intern =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-28"><a href="glm-2.html#cb50-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Sys.time</span>() <span class="sc">-</span> t1</span>
<span id="cb50-29"><a href="glm-2.html#cb50-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb50-30"><a href="glm-2.html#cb50-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># remove the residuals file to clear some space</span></span>
<span id="cb50-31"><a href="glm-2.html#cb50-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">system</span>(<span class="fu">sprintf</span>(<span class="st">&quot;rm %s&quot;</span>, <span class="fu">file.path</span>(out_dir, <span class="st">&quot;res4d.nii.gz&quot;</span>)))</span>
<span id="cb50-32"><a href="glm-2.html#cb50-32" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb50-33"><a href="glm-2.html#cb50-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-34"><a href="glm-2.html#cb50-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-35"><a href="glm-2.html#cb50-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="glm-2-results" class="section level3 hasAnchor" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> GLM 2 results<a href="glm-2.html#glm-2-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="check-if-results-are-the-same" class="section level4 hasAnchor" number="5.1.4.1">
<h4><span class="header-section-number">5.1.4.1</span> Check if results are the same<a href="glm-2.html#check-if-results-are-the-same" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After running the analysis using FEAT and via film_gls directly, let’s check if the results are comparable.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="glm-2.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb51-2"><a href="glm-2.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb51-3"><a href="glm-2.html#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb51-4"><a href="glm-2.html#cb51-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb51-5"><a href="glm-2.html#cb51-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># load  the t-Stat images</span></span>
<span id="cb51-6"><a href="glm-2.html#cb51-6" aria-hidden="true" tabindex="-1"></a>      fn1 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb51-7"><a href="glm-2.html#cb51-7" aria-hidden="true" tabindex="-1"></a>                 i_sub, <span class="fu">paste0</span>(i_run, <span class="st">&quot;.feat&quot;</span>), <span class="st">&quot;stats&quot;</span>, <span class="st">&quot;tstat1.nii.gz&quot;</span>)</span>
<span id="cb51-8"><a href="glm-2.html#cb51-8" aria-hidden="true" tabindex="-1"></a>      fn2 <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb51-9"><a href="glm-2.html#cb51-9" aria-hidden="true" tabindex="-1"></a>                 i_sub, i_run, <span class="st">&quot;tstat1.nii.gz&quot;</span>)</span>
<span id="cb51-10"><a href="glm-2.html#cb51-10" aria-hidden="true" tabindex="-1"></a>      feat_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn1)</span>
<span id="cb51-11"><a href="glm-2.html#cb51-11" aria-hidden="true" tabindex="-1"></a>      film_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn2)</span>
<span id="cb51-12"><a href="glm-2.html#cb51-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb51-13"><a href="glm-2.html#cb51-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># store in data frame</span></span>
<span id="cb51-14"><a href="glm-2.html#cb51-14" aria-hidden="true" tabindex="-1"></a>      stat_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">feat =</span> <span class="fu">c</span>(feat_nii), <span class="at">film =</span> <span class="fu">c</span>(film_nii))</span>
<span id="cb51-15"><a href="glm-2.html#cb51-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb51-16"><a href="glm-2.html#cb51-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># diagnostic plot</span></span>
<span id="cb51-17"><a href="glm-2.html#cb51-17" aria-hidden="true" tabindex="-1"></a>      p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(stat_df, <span class="fu">aes</span>(<span class="at">x=</span>feat, <span class="at">y=</span>film)) <span class="sc">+</span></span>
<span id="cb51-18"><a href="glm-2.html#cb51-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-19"><a href="glm-2.html#cb51-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb51-20"><a href="glm-2.html#cb51-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-21"><a href="glm-2.html#cb51-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;T-Statistics from FEAT and FILM&quot;</span>,</span>
<span id="cb51-22"><a href="glm-2.html#cb51-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">&quot;r=%.3f&quot;</span>, <span class="fu">cor</span>(stat_df<span class="sc">$</span>feat, stat_df<span class="sc">$</span>film)))</span>
<span id="cb51-23"><a href="glm-2.html#cb51-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(p1)</span>
<span id="cb51-24"><a href="glm-2.html#cb51-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-25"><a href="glm-2.html#cb51-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-26"><a href="glm-2.html#cb51-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Hexadirectioal-analysis-pipeline_files/figure-html/glm2_compare_film_feat-1.png" width="672" /><img src="Hexadirectioal-analysis-pipeline_files/figure-html/glm2_compare_film_feat-2.png" width="672" /></p>
</div>
<div id="brain-plot" class="section level4 hasAnchor" number="5.1.4.2">
<h4><span class="header-section-number">5.1.4.2</span> Brain plot<a href="glm-2.html#brain-plot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>On the whole-brain level, we can plot the t-values of the parametric modulator across voxels.
The plots below are arbitrarily thresholded at t &gt; 1.5.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="glm-2.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb52-2"><a href="glm-2.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb52-3"><a href="glm-2.html#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb52-4"><a href="glm-2.html#cb52-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb52-5"><a href="glm-2.html#cb52-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># load mean functional and t-values</span></span>
<span id="cb52-6"><a href="glm-2.html#cb52-6" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb52-7"><a href="glm-2.html#cb52-7" aria-hidden="true" tabindex="-1"></a>                 i_sub, <span class="fu">paste0</span>(i_run, <span class="st">&quot;.feat&quot;</span>), <span class="st">&quot;mean_func.nii.gz&quot;</span>)</span>
<span id="cb52-8"><a href="glm-2.html#cb52-8" aria-hidden="true" tabindex="-1"></a>      mean_func_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn)</span>
<span id="cb52-9"><a href="glm-2.html#cb52-9" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb52-10"><a href="glm-2.html#cb52-10" aria-hidden="true" tabindex="-1"></a>                 i_sub, i_run, <span class="st">&quot;tstat1.nii.gz&quot;</span>)</span>
<span id="cb52-11"><a href="glm-2.html#cb52-11" aria-hidden="true" tabindex="-1"></a>      t_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn)</span>
<span id="cb52-12"><a href="glm-2.html#cb52-12" aria-hidden="true" tabindex="-1"></a>      f_nii[f_nii <span class="sc">&lt;</span> <span class="fl">1.5</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-13"><a href="glm-2.html#cb52-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb52-14"><a href="glm-2.html#cb52-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># overlay t-values on mean func</span></span>
<span id="cb52-15"><a href="glm-2.html#cb52-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ortho2</span>(mean_func_nii, f_nii, <span class="at">xyz =</span> <span class="fu">c</span>(<span class="dv">46</span>,<span class="dv">46</span>,<span class="dv">15</span>),</span>
<span id="cb52-16"><a href="glm-2.html#cb52-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">ycolorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-17"><a href="glm-2.html#cb52-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.y =</span> oro.nifti<span class="sc">::</span><span class="fu">hotmetal</span>(<span class="dv">10</span>), </span>
<span id="cb52-18"><a href="glm-2.html#cb52-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ybreaks =</span> <span class="fu">seq</span>(<span class="fl">1.5</span>,<span class="fl">6.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb52-19"><a href="glm-2.html#cb52-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb52-20"><a href="glm-2.html#cb52-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-21"><a href="glm-2.html#cb52-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Hexadirectioal-analysis-pipeline_files/figure-html/cosine_pmod_brain-1.png" width="672" /><img src="Hexadirectioal-analysis-pipeline_files/figure-html/cosine_pmod_brain-2.png" width="672" /></p>
</div>
<div id="ec-results" class="section level4 hasAnchor" number="5.1.4.3">
<h4><span class="header-section-number">5.1.4.3</span> EC results<a href="glm-2.html#ec-results" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s load the EC results into a dataframe.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="glm-2.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble to store output</span></span>
<span id="cb53-2"><a href="glm-2.html#cb53-2" aria-hidden="true" tabindex="-1"></a>stat_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb53-3"><a href="glm-2.html#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="glm-2.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_sub <span class="cf">in</span> subjects){</span>
<span id="cb53-5"><a href="glm-2.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-6"><a href="glm-2.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># load the right EC mask and linearize it</span></span>
<span id="cb53-7"><a href="glm-2.html#cb53-7" aria-hidden="true" tabindex="-1"></a>  ec_mask_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;masks&quot;</span>, <span class="st">&quot;ROI_masks&quot;</span>,</span>
<span id="cb53-8"><a href="glm-2.html#cb53-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;ROImask_entorhinalCortex_RH.nii&quot;</span>))</span>
<span id="cb53-9"><a href="glm-2.html#cb53-9" aria-hidden="true" tabindex="-1"></a>  ec_mask_lin <span class="ot">&lt;-</span> <span class="fu">c</span>(ec_mask_nii)</span>
<span id="cb53-10"><a href="glm-2.html#cb53-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-11"><a href="glm-2.html#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># load the combined brain mask and linearize it</span></span>
<span id="cb53-12"><a href="glm-2.html#cb53-12" aria-hidden="true" tabindex="-1"></a>  brain_mask_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;masks&quot;</span>, <span class="st">&quot;brain_mask&quot;</span>, i_sub,</span>
<span id="cb53-13"><a href="glm-2.html#cb53-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;comb_brain_mask_tMean100.nii.gz&quot;</span>))</span>
<span id="cb53-14"><a href="glm-2.html#cb53-14" aria-hidden="true" tabindex="-1"></a>  brain_mask_lin <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(<span class="fu">c</span>(brain_mask_nii))</span>
<span id="cb53-15"><a href="glm-2.html#cb53-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-16"><a href="glm-2.html#cb53-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-17"><a href="glm-2.html#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_run <span class="cf">in</span> runs){ </span>
<span id="cb53-18"><a href="glm-2.html#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_period <span class="cf">in</span> periodicities){</span>
<span id="cb53-19"><a href="glm-2.html#cb53-19" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb53-20"><a href="glm-2.html#cb53-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># load  the t-stat image</span></span>
<span id="cb53-21"><a href="glm-2.html#cb53-21" aria-hidden="true" tabindex="-1"></a>      <span class="co">#fn &lt;- here(&quot;data&quot;, &quot;glm2&quot;, &quot;glm2_secondhalf&quot;, &quot;cosine_pmod&quot;, paste0(i_period, &quot;fold&quot;), </span></span>
<span id="cb53-22"><a href="glm-2.html#cb53-22" aria-hidden="true" tabindex="-1"></a>      <span class="co">#           i_sub, paste0(i_run, &quot;.feat&quot;), &quot;stats&quot;, &quot;tstat1.nii.gz&quot;)</span></span>
<span id="cb53-23"><a href="glm-2.html#cb53-23" aria-hidden="true" tabindex="-1"></a>      fn <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;glm2&quot;</span>, <span class="st">&quot;glm2_secondhalf&quot;</span>, <span class="st">&quot;cosine_pmod&quot;</span>, <span class="fu">paste0</span>(i_period, <span class="st">&quot;fold&quot;</span>), </span>
<span id="cb53-24"><a href="glm-2.html#cb53-24" aria-hidden="true" tabindex="-1"></a>                 i_sub, i_run, <span class="st">&quot;tstat1.nii.gz&quot;</span>)</span>
<span id="cb53-25"><a href="glm-2.html#cb53-25" aria-hidden="true" tabindex="-1"></a>      stat_nii <span class="ot">&lt;-</span> <span class="fu">readNIfTI2</span>(fn)</span>
<span id="cb53-26"><a href="glm-2.html#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="glm-2.html#cb53-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># store in data frame</span></span>
<span id="cb53-28"><a href="glm-2.html#cb53-28" aria-hidden="true" tabindex="-1"></a>      temp_stat_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">subID =</span> i_sub, <span class="at">periodicity =</span> i_period, <span class="at">run =</span> i_run,</span>
<span id="cb53-29"><a href="glm-2.html#cb53-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">pmod_t =</span> <span class="fu">c</span>(stat_nii)[brain_mask_lin<span class="sc">==</span><span class="dv">1</span>],</span>
<span id="cb53-30"><a href="glm-2.html#cb53-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ec =</span>  <span class="fu">as.logical</span>(ec_mask_lin[brain_mask_lin<span class="sc">==</span><span class="dv">1</span>]),</span>
<span id="cb53-31"><a href="glm-2.html#cb53-31" aria-hidden="true" tabindex="-1"></a>                             <span class="at">vox =</span> <span class="fu">which</span>(brain_mask_lin<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb53-32"><a href="glm-2.html#cb53-32" aria-hidden="true" tabindex="-1"></a>      stat_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(stat_df, temp_stat_df)</span>
<span id="cb53-33"><a href="glm-2.html#cb53-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-34"><a href="glm-2.html#cb53-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-35"><a href="glm-2.html#cb53-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot the results for the entorhinal cortex ROI. The boxplot shows the distribution of t-values across entorhinal voxels.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="glm-2.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot of t-values of cosine regressor</span></span>
<span id="cb54-2"><a href="glm-2.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stat_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ec <span class="sc">==</span> <span class="cn">TRUE</span>), <span class="fu">aes</span>(<span class="at">x=</span>run, <span class="at">y=</span>pmod_t)) <span class="sc">+</span></span>
<span id="cb54-3"><a href="glm-2.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.3</span>, <span class="at">fill=</span><span class="st">&quot;darkgrey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb54-4"><a href="glm-2.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">+</span><span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb54-5"><a href="glm-2.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>()</span></code></pre></div>
<p><img src="Hexadirectioal-analysis-pipeline_files/figure-html/glm2_cosine_pmod_ec-1.png" width="672" /></p>
<p>The scatter plot shows the relationship of t-values from the same voxels across the two runs.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="glm-2.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot with one dot per voxel</span></span>
<span id="cb55-2"><a href="glm-2.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stat_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ec <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="glm-2.html#cb55-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> run, <span class="at">values_from =</span> pmod_t), </span>
<span id="cb55-4"><a href="glm-2.html#cb55-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>run01, <span class="at">y=</span>run02)) <span class="sc">+</span></span>
<span id="cb55-5"><a href="glm-2.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-6"><a href="glm-2.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">color=</span><span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-7"><a href="glm-2.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb55-8"><a href="glm-2.html#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="Hexadirectioal-analysis-pipeline_files/figure-html/scatter_across_blocks-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimate-orientation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="credit.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
